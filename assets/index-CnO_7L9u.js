var sR=Object.defineProperty;var Ny=n=>{throw TypeError(n)};var oR=(n,e,t)=>e in n?sR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var $u=(n,e,t)=>oR(n,typeof e!="symbol"?e+"":e,t),Fy=(n,e,t)=>e.has(n)||Ny("Cannot "+t);var by=(n,e,t)=>(Fy(n,e,"read from private field"),t?t.call(n):e.get(n)),Vy=(n,e,t)=>e.has(n)?Ny("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),zy=(n,e,t,i)=>(Fy(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);function aR(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function lR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fE={exports:{}},$h={},gE={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ou=Symbol.for("react.element"),uR=Symbol.for("react.portal"),cR=Symbol.for("react.fragment"),hR=Symbol.for("react.strict_mode"),dR=Symbol.for("react.profiler"),fR=Symbol.for("react.provider"),gR=Symbol.for("react.context"),pR=Symbol.for("react.forward_ref"),mR=Symbol.for("react.suspense"),_R=Symbol.for("react.memo"),yR=Symbol.for("react.lazy"),Uy=Symbol.iterator;function vR(n){return n===null||typeof n!="object"?null:(n=Uy&&n[Uy]||n["@@iterator"],typeof n=="function"?n:null)}var pE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mE=Object.assign,_E={};function oa(n,e,t){this.props=n,this.context=e,this.refs=_E,this.updater=t||pE}oa.prototype.isReactComponent={};oa.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};oa.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function yE(){}yE.prototype=oa.prototype;function Lp(n,e,t){this.props=n,this.context=e,this.refs=_E,this.updater=t||pE}var Mp=Lp.prototype=new yE;Mp.constructor=Lp;mE(Mp,oa.prototype);Mp.isPureReactComponent=!0;var By=Array.isArray,vE=Object.prototype.hasOwnProperty,Op={current:null},EE={key:!0,ref:!0,__self:!0,__source:!0};function wE(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)vE.call(e,i)&&!EE.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:ou,type:n,key:s,ref:o,props:r,_owner:Op.current}}function ER(n,e){return{$$typeof:ou,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Np(n){return typeof n=="object"&&n!==null&&n.$$typeof===ou}function wR(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var jy=/\/+/g;function ef(n,e){return typeof n=="object"&&n!==null&&n.key!=null?wR(""+n.key):e.toString(36)}function Sc(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case ou:case uR:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+ef(o,0):i,By(r)?(t="",n!=null&&(t=n.replace(jy,"$&/")+"/"),Sc(r,e,t,"",function(c){return c})):r!=null&&(Np(r)&&(r=ER(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(jy,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",By(n))for(var a=0;a<n.length;a++){s=n[a];var l=i+ef(s,a);o+=Sc(s,e,t,l,r)}else if(l=vR(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=i+ef(s,a++),o+=Sc(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ku(n,e,t){if(n==null)return n;var i=[],r=0;return Sc(n,i,"","",function(s){return e.call(t,s,r++)}),i}function TR(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Kt={current:null},Ac={transition:null},IR={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:Ac,ReactCurrentOwner:Op};function TE(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:Ku,forEach:function(n,e,t){Ku(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Ku(n,function(){e++}),e},toArray:function(n){return Ku(n,function(e){return e})||[]},only:function(n){if(!Np(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};fe.Component=oa;fe.Fragment=cR;fe.Profiler=dR;fe.PureComponent=Lp;fe.StrictMode=hR;fe.Suspense=mR;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IR;fe.act=TE;fe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=mE({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Op.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)vE.call(e,l)&&!EE.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:ou,type:n.type,key:r,ref:s,props:i,_owner:o}};fe.createContext=function(n){return n={$$typeof:gR,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:fR,_context:n},n.Consumer=n};fe.createElement=wE;fe.createFactory=function(n){var e=wE.bind(null,n);return e.type=n,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(n){return{$$typeof:pR,render:n}};fe.isValidElement=Np;fe.lazy=function(n){return{$$typeof:yR,_payload:{_status:-1,_result:n},_init:TR}};fe.memo=function(n,e){return{$$typeof:_R,type:n,compare:e===void 0?null:e}};fe.startTransition=function(n){var e=Ac.transition;Ac.transition={};try{n()}finally{Ac.transition=e}};fe.unstable_act=TE;fe.useCallback=function(n,e){return Kt.current.useCallback(n,e)};fe.useContext=function(n){return Kt.current.useContext(n)};fe.useDebugValue=function(){};fe.useDeferredValue=function(n){return Kt.current.useDeferredValue(n)};fe.useEffect=function(n,e){return Kt.current.useEffect(n,e)};fe.useId=function(){return Kt.current.useId()};fe.useImperativeHandle=function(n,e,t){return Kt.current.useImperativeHandle(n,e,t)};fe.useInsertionEffect=function(n,e){return Kt.current.useInsertionEffect(n,e)};fe.useLayoutEffect=function(n,e){return Kt.current.useLayoutEffect(n,e)};fe.useMemo=function(n,e){return Kt.current.useMemo(n,e)};fe.useReducer=function(n,e,t){return Kt.current.useReducer(n,e,t)};fe.useRef=function(n){return Kt.current.useRef(n)};fe.useState=function(n){return Kt.current.useState(n)};fe.useSyncExternalStore=function(n,e,t){return Kt.current.useSyncExternalStore(n,e,t)};fe.useTransition=function(){return Kt.current.useTransition()};fe.version="18.3.1";gE.exports=fe;var Y=gE.exports;const CR=lR(Y),RR=aR({__proto__:null,default:CR},[Y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xR=Y,SR=Symbol.for("react.element"),AR=Symbol.for("react.fragment"),PR=Object.prototype.hasOwnProperty,DR=xR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kR={key:!0,ref:!0,__self:!0,__source:!0};function IE(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)PR.call(e,i)&&!kR.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:SR,type:n,key:s,ref:o,props:r,_owner:DR.current}}$h.Fragment=AR;$h.jsx=IE;$h.jsxs=IE;fE.exports=$h;var b=fE.exports,CE={exports:{}},_n={},RE={exports:{}},xE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(U,X){var G=U.length;U.push(X);e:for(;0<G;){var J=G-1>>>1,ee=U[J];if(0<r(ee,X))U[J]=X,U[G]=ee,G=J;else break e}}function t(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var X=U[0],G=U.pop();if(G!==X){U[0]=G;e:for(var J=0,ee=U.length,he=ee>>>1;J<he;){var B=2*(J+1)-1,Be=U[B],Me=B+1,De=U[Me];if(0>r(Be,G))Me<ee&&0>r(De,Be)?(U[J]=De,U[Me]=G,J=Me):(U[J]=Be,U[B]=G,J=B);else if(Me<ee&&0>r(De,G))U[J]=De,U[Me]=G,J=Me;else break e}}return X}function r(U,X){var G=U.sortIndex-X.sortIndex;return G!==0?G:U.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,d=null,f=3,p=!1,_=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(U){for(var X=t(c);X!==null;){if(X.callback===null)i(c);else if(X.startTime<=U)i(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function S(U){if(w=!1,I(U),!_)if(t(l)!==null)_=!0,$(k);else{var X=t(c);X!==null&&re(S,X.startTime-U)}}function k(U,X){_=!1,w&&(w=!1,v(E),E=-1),p=!0;var G=f;try{for(I(X),d=t(l);d!==null&&(!(d.expirationTime>X)||U&&!D());){var J=d.callback;if(typeof J=="function"){d.callback=null,f=d.priorityLevel;var ee=J(d.expirationTime<=X);X=n.unstable_now(),typeof ee=="function"?d.callback=ee:d===t(l)&&i(l),I(X)}else i(l);d=t(l)}if(d!==null)var he=!0;else{var B=t(c);B!==null&&re(S,B.startTime-X),he=!1}return he}finally{d=null,f=G,p=!1}}var O=!1,C=null,E=-1,R=5,P=-1;function D(){return!(n.unstable_now()-P<R)}function L(){if(C!==null){var U=n.unstable_now();P=U;var X=!0;try{X=C(!0,U)}finally{X?A():(O=!1,C=null)}}else O=!1}var A;if(typeof y=="function")A=function(){y(L)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,te=W.port2;W.port1.onmessage=L,A=function(){te.postMessage(null)}}else A=function(){T(L,0)};function $(U){C=U,O||(O=!0,A())}function re(U,X){E=T(function(){U(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){_||p||(_=!0,$(k))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(U){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var G=f;f=X;try{return U()}finally{f=G}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var G=f;f=U;try{return X()}finally{f=G}},n.unstable_scheduleCallback=function(U,X,G){var J=n.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?J+G:J):G=J,U){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=G+ee,U={id:h++,callback:X,priorityLevel:U,startTime:G,expirationTime:ee,sortIndex:-1},G>J?(U.sortIndex=G,e(c,U),t(l)===null&&U===t(c)&&(w?(v(E),E=-1):w=!0,re(S,G-J))):(U.sortIndex=ee,e(l,U),_||p||(_=!0,$(k))),U},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(U){var X=f;return function(){var G=f;f=X;try{return U.apply(this,arguments)}finally{f=G}}}})(xE);RE.exports=xE;var LR=RE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MR=Y,mn=LR;function j(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var SE=new Set,ml={};function Ms(n,e){Vo(n,e),Vo(n+"Capture",e)}function Vo(n,e){for(ml[n]=e,n=0;n<e.length;n++)SE.add(e[n])}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ng=Object.prototype.hasOwnProperty,OR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gy={},Wy={};function NR(n){return ng.call(Wy,n)?!0:ng.call(Gy,n)?!1:OR.test(n)?Wy[n]=!0:(Gy[n]=!0,!1)}function FR(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function bR(n,e,t,i){if(e===null||typeof e>"u"||FR(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xt(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){At[n]=new Xt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];At[e]=new Xt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){At[n]=new Xt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){At[n]=new Xt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){At[n]=new Xt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){At[n]=new Xt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){At[n]=new Xt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){At[n]=new Xt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){At[n]=new Xt(n,5,!1,n.toLowerCase(),null,!1,!1)});var Fp=/[\-:]([a-z])/g;function bp(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Fp,bp);At[e]=new Xt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Fp,bp);At[e]=new Xt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Fp,bp);At[e]=new Xt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){At[n]=new Xt(n,1,!1,n.toLowerCase(),null,!1,!1)});At.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){At[n]=new Xt(n,1,!1,n.toLowerCase(),null,!0,!0)});function Vp(n,e,t,i){var r=At.hasOwnProperty(e)?At[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bR(e,t,r,i)&&(t=null),i||r===null?NR(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Zi=MR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xu=Symbol.for("react.element"),co=Symbol.for("react.portal"),ho=Symbol.for("react.fragment"),zp=Symbol.for("react.strict_mode"),ig=Symbol.for("react.profiler"),AE=Symbol.for("react.provider"),PE=Symbol.for("react.context"),Up=Symbol.for("react.forward_ref"),rg=Symbol.for("react.suspense"),sg=Symbol.for("react.suspense_list"),Bp=Symbol.for("react.memo"),pr=Symbol.for("react.lazy"),DE=Symbol.for("react.offscreen"),$y=Symbol.iterator;function Da(n){return n===null||typeof n!="object"?null:(n=$y&&n[$y]||n["@@iterator"],typeof n=="function"?n:null)}var $e=Object.assign,tf;function ja(n){if(tf===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);tf=e&&e[1]||""}return`
`+tf+n}var nf=!1;function rf(n,e){if(!n||nf)return"";nf=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){i=c}n.call(e.prototype)}else{try{throw Error()}catch(c){i=c}n()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{nf=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?ja(n):""}function VR(n){switch(n.tag){case 5:return ja(n.type);case 16:return ja("Lazy");case 13:return ja("Suspense");case 19:return ja("SuspenseList");case 0:case 2:case 15:return n=rf(n.type,!1),n;case 11:return n=rf(n.type.render,!1),n;case 1:return n=rf(n.type,!0),n;default:return""}}function og(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ho:return"Fragment";case co:return"Portal";case ig:return"Profiler";case zp:return"StrictMode";case rg:return"Suspense";case sg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case PE:return(n.displayName||"Context")+".Consumer";case AE:return(n._context.displayName||"Context")+".Provider";case Up:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Bp:return e=n.displayName||null,e!==null?e:og(n.type)||"Memo";case pr:e=n._payload,n=n._init;try{return og(n(e))}catch{}}return null}function zR(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return og(e);case 8:return e===zp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ur(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function kE(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function UR(n){var e=kE(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Hu(n){n._valueTracker||(n._valueTracker=UR(n))}function LE(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=kE(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function Kc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function ag(n,e){var t=e.checked;return $e({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Ky(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Ur(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ME(n,e){e=e.checked,e!=null&&Vp(n,"checked",e,!1)}function lg(n,e){ME(n,e);var t=Ur(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?ug(n,e.type,t):e.hasOwnProperty("defaultValue")&&ug(n,e.type,Ur(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Xy(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function ug(n,e,t){(e!=="number"||Kc(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Ga=Array.isArray;function xo(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Ur(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function cg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return $e({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Hy(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(j(92));if(Ga(t)){if(1<t.length)throw Error(j(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ur(t)}}function OE(n,e){var t=Ur(e.value),i=Ur(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function qy(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function NE(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?NE(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var qu,FE=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(qu=qu||document.createElement("div"),qu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qu.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function _l(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var nl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BR=["Webkit","ms","Moz","O"];Object.keys(nl).forEach(function(n){BR.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),nl[e]=nl[n]})});function bE(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||nl.hasOwnProperty(n)&&nl[n]?(""+e).trim():e+"px"}function VE(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=bE(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var jR=$e({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dg(n,e){if(e){if(jR[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function fg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gg=null;function jp(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var pg=null,So=null,Ao=null;function Yy(n){if(n=uu(n)){if(typeof pg!="function")throw Error(j(280));var e=n.stateNode;e&&(e=Yh(e),pg(n.stateNode,n.type,e))}}function zE(n){So?Ao?Ao.push(n):Ao=[n]:So=n}function UE(){if(So){var n=So,e=Ao;if(Ao=So=null,Yy(n),e)for(n=0;n<e.length;n++)Yy(e[n])}}function BE(n,e){return n(e)}function jE(){}var sf=!1;function GE(n,e,t){if(sf)return n(e,t);sf=!0;try{return BE(n,e,t)}finally{sf=!1,(So!==null||Ao!==null)&&(jE(),UE())}}function yl(n,e){var t=n.stateNode;if(t===null)return null;var i=Yh(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(j(231,e,typeof t));return t}var mg=!1;if(Gi)try{var ka={};Object.defineProperty(ka,"passive",{get:function(){mg=!0}}),window.addEventListener("test",ka,ka),window.removeEventListener("test",ka,ka)}catch{mg=!1}function GR(n,e,t,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(h){this.onError(h)}}var il=!1,Xc=null,Hc=!1,_g=null,WR={onError:function(n){il=!0,Xc=n}};function $R(n,e,t,i,r,s,o,a,l){il=!1,Xc=null,GR.apply(WR,arguments)}function KR(n,e,t,i,r,s,o,a,l){if($R.apply(this,arguments),il){if(il){var c=Xc;il=!1,Xc=null}else throw Error(j(198));Hc||(Hc=!0,_g=c)}}function Os(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function WE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Zy(n){if(Os(n)!==n)throw Error(j(188))}function XR(n){var e=n.alternate;if(!e){if(e=Os(n),e===null)throw Error(j(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return Zy(r),n;if(s===i)return Zy(r),e;s=s.sibling}throw Error(j(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(j(189))}}if(t.alternate!==i)throw Error(j(190))}if(t.tag!==3)throw Error(j(188));return t.stateNode.current===t?n:e}function $E(n){return n=XR(n),n!==null?KE(n):null}function KE(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=KE(n);if(e!==null)return e;n=n.sibling}return null}var XE=mn.unstable_scheduleCallback,Qy=mn.unstable_cancelCallback,HR=mn.unstable_shouldYield,qR=mn.unstable_requestPaint,Je=mn.unstable_now,YR=mn.unstable_getCurrentPriorityLevel,Gp=mn.unstable_ImmediatePriority,HE=mn.unstable_UserBlockingPriority,qc=mn.unstable_NormalPriority,ZR=mn.unstable_LowPriority,qE=mn.unstable_IdlePriority,Kh=null,di=null;function QR(n){if(di&&typeof di.onCommitFiberRoot=="function")try{di.onCommitFiberRoot(Kh,n,void 0,(n.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:tx,JR=Math.log,ex=Math.LN2;function tx(n){return n>>>=0,n===0?32:31-(JR(n)/ex|0)|0}var Yu=64,Zu=4194304;function Wa(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Yc(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=Wa(a):(s&=o,s!==0&&(i=Wa(s)))}else o=t&~r,o!==0?i=Wa(o):s!==0&&(i=Wa(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Kn(e),r=1<<t,i|=n[t],e&=~r;return i}function nx(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ix(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Kn(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&i)&&(r[o]=nx(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function yg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function YE(){var n=Yu;return Yu<<=1,!(Yu&4194240)&&(Yu=64),n}function of(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function au(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Kn(e),n[e]=t}function rx(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Kn(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function Wp(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Kn(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var Pe=0;function ZE(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var QE,$p,JE,ew,tw,vg=!1,Qu=[],xr=null,Sr=null,Ar=null,vl=new Map,El=new Map,yr=[],sx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jy(n,e){switch(n){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":Ar=null;break;case"pointerover":case"pointerout":vl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":El.delete(e.pointerId)}}function La(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=uu(e),e!==null&&$p(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function ox(n,e,t,i,r){switch(e){case"focusin":return xr=La(xr,n,e,t,i,r),!0;case"dragenter":return Sr=La(Sr,n,e,t,i,r),!0;case"mouseover":return Ar=La(Ar,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return vl.set(s,La(vl.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,El.set(s,La(El.get(s)||null,n,e,t,i,r)),!0}return!1}function nw(n){var e=ds(n.target);if(e!==null){var t=Os(e);if(t!==null){if(e=t.tag,e===13){if(e=WE(t),e!==null){n.blockedOn=e,tw(n.priority,function(){JE(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Pc(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Eg(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);gg=i,t.target.dispatchEvent(i),gg=null}else return e=uu(t),e!==null&&$p(e),n.blockedOn=t,!1;e.shift()}return!0}function e0(n,e,t){Pc(n)&&t.delete(e)}function ax(){vg=!1,xr!==null&&Pc(xr)&&(xr=null),Sr!==null&&Pc(Sr)&&(Sr=null),Ar!==null&&Pc(Ar)&&(Ar=null),vl.forEach(e0),El.forEach(e0)}function Ma(n,e){n.blockedOn===e&&(n.blockedOn=null,vg||(vg=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,ax)))}function wl(n){function e(r){return Ma(r,n)}if(0<Qu.length){Ma(Qu[0],n);for(var t=1;t<Qu.length;t++){var i=Qu[t];i.blockedOn===n&&(i.blockedOn=null)}}for(xr!==null&&Ma(xr,n),Sr!==null&&Ma(Sr,n),Ar!==null&&Ma(Ar,n),vl.forEach(e),El.forEach(e),t=0;t<yr.length;t++)i=yr[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<yr.length&&(t=yr[0],t.blockedOn===null);)nw(t),t.blockedOn===null&&yr.shift()}var Po=Zi.ReactCurrentBatchConfig,Zc=!0;function lx(n,e,t,i){var r=Pe,s=Po.transition;Po.transition=null;try{Pe=1,Kp(n,e,t,i)}finally{Pe=r,Po.transition=s}}function ux(n,e,t,i){var r=Pe,s=Po.transition;Po.transition=null;try{Pe=4,Kp(n,e,t,i)}finally{Pe=r,Po.transition=s}}function Kp(n,e,t,i){if(Zc){var r=Eg(n,e,t,i);if(r===null)mf(n,e,i,Qc,t),Jy(n,i);else if(ox(r,n,e,t,i))i.stopPropagation();else if(Jy(n,i),e&4&&-1<sx.indexOf(n)){for(;r!==null;){var s=uu(r);if(s!==null&&QE(s),s=Eg(n,e,t,i),s===null&&mf(n,e,i,Qc,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else mf(n,e,i,null,t)}}var Qc=null;function Eg(n,e,t,i){if(Qc=null,n=jp(i),n=ds(n),n!==null)if(e=Os(n),e===null)n=null;else if(t=e.tag,t===13){if(n=WE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Qc=n,null}function iw(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(YR()){case Gp:return 1;case HE:return 4;case qc:case ZR:return 16;case qE:return 536870912;default:return 16}default:return 16}}var Er=null,Xp=null,Dc=null;function rw(){if(Dc)return Dc;var n,e=Xp,t=e.length,i,r="value"in Er?Er.value:Er.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return Dc=r.slice(n,1<i?1-i:void 0)}function kc(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ju(){return!0}function t0(){return!1}function yn(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ju:t0,this.isPropagationStopped=t0,this}return $e(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ju)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ju)},persist:function(){},isPersistent:Ju}),e}var aa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hp=yn(aa),lu=$e({},aa,{view:0,detail:0}),cx=yn(lu),af,lf,Oa,Xh=$e({},lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qp,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Oa&&(Oa&&n.type==="mousemove"?(af=n.screenX-Oa.screenX,lf=n.screenY-Oa.screenY):lf=af=0,Oa=n),af)},movementY:function(n){return"movementY"in n?n.movementY:lf}}),n0=yn(Xh),hx=$e({},Xh,{dataTransfer:0}),dx=yn(hx),fx=$e({},lu,{relatedTarget:0}),uf=yn(fx),gx=$e({},aa,{animationName:0,elapsedTime:0,pseudoElement:0}),px=yn(gx),mx=$e({},aa,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),_x=yn(mx),yx=$e({},aa,{data:0}),i0=yn(yx),vx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ex={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tx(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=wx[n])?!!e[n]:!1}function qp(){return Tx}var Ix=$e({},lu,{key:function(n){if(n.key){var e=vx[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=kc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ex[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qp,charCode:function(n){return n.type==="keypress"?kc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?kc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Cx=yn(Ix),Rx=$e({},Xh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),r0=yn(Rx),xx=$e({},lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qp}),Sx=yn(xx),Ax=$e({},aa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Px=yn(Ax),Dx=$e({},Xh,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),kx=yn(Dx),Lx=[9,13,27,32],Yp=Gi&&"CompositionEvent"in window,rl=null;Gi&&"documentMode"in document&&(rl=document.documentMode);var Mx=Gi&&"TextEvent"in window&&!rl,sw=Gi&&(!Yp||rl&&8<rl&&11>=rl),s0=" ",o0=!1;function ow(n,e){switch(n){case"keyup":return Lx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aw(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var fo=!1;function Ox(n,e){switch(n){case"compositionend":return aw(e);case"keypress":return e.which!==32?null:(o0=!0,s0);case"textInput":return n=e.data,n===s0&&o0?null:n;default:return null}}function Nx(n,e){if(fo)return n==="compositionend"||!Yp&&ow(n,e)?(n=rw(),Dc=Xp=Er=null,fo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return sw&&e.locale!=="ko"?null:e.data;default:return null}}var Fx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Fx[n.type]:e==="textarea"}function lw(n,e,t,i){zE(i),e=Jc(e,"onChange"),0<e.length&&(t=new Hp("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var sl=null,Tl=null;function bx(n){vw(n,0)}function Hh(n){var e=mo(n);if(LE(e))return n}function Vx(n,e){if(n==="change")return e}var uw=!1;if(Gi){var cf;if(Gi){var hf="oninput"in document;if(!hf){var l0=document.createElement("div");l0.setAttribute("oninput","return;"),hf=typeof l0.oninput=="function"}cf=hf}else cf=!1;uw=cf&&(!document.documentMode||9<document.documentMode)}function u0(){sl&&(sl.detachEvent("onpropertychange",cw),Tl=sl=null)}function cw(n){if(n.propertyName==="value"&&Hh(Tl)){var e=[];lw(e,Tl,n,jp(n)),GE(bx,e)}}function zx(n,e,t){n==="focusin"?(u0(),sl=e,Tl=t,sl.attachEvent("onpropertychange",cw)):n==="focusout"&&u0()}function Ux(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Hh(Tl)}function Bx(n,e){if(n==="click")return Hh(e)}function jx(n,e){if(n==="input"||n==="change")return Hh(e)}function Gx(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var qn=typeof Object.is=="function"?Object.is:Gx;function Il(n,e){if(qn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!ng.call(e,r)||!qn(n[r],e[r]))return!1}return!0}function c0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function h0(n,e){var t=c0(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=c0(t)}}function hw(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?hw(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function dw(){for(var n=window,e=Kc();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Kc(n.document)}return e}function Zp(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Wx(n){var e=dw(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&hw(t.ownerDocument.documentElement,t)){if(i!==null&&Zp(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=h0(t,s);var o=h0(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var $x=Gi&&"documentMode"in document&&11>=document.documentMode,go=null,wg=null,ol=null,Tg=!1;function d0(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Tg||go==null||go!==Kc(i)||(i=go,"selectionStart"in i&&Zp(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),ol&&Il(ol,i)||(ol=i,i=Jc(wg,"onSelect"),0<i.length&&(e=new Hp("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=go)))}function ec(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var po={animationend:ec("Animation","AnimationEnd"),animationiteration:ec("Animation","AnimationIteration"),animationstart:ec("Animation","AnimationStart"),transitionend:ec("Transition","TransitionEnd")},df={},fw={};Gi&&(fw=document.createElement("div").style,"AnimationEvent"in window||(delete po.animationend.animation,delete po.animationiteration.animation,delete po.animationstart.animation),"TransitionEvent"in window||delete po.transitionend.transition);function qh(n){if(df[n])return df[n];if(!po[n])return n;var e=po[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in fw)return df[n]=e[t];return n}var gw=qh("animationend"),pw=qh("animationiteration"),mw=qh("animationstart"),_w=qh("transitionend"),yw=new Map,f0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qr(n,e){yw.set(n,e),Ms(e,[n])}for(var ff=0;ff<f0.length;ff++){var gf=f0[ff],Kx=gf.toLowerCase(),Xx=gf[0].toUpperCase()+gf.slice(1);qr(Kx,"on"+Xx)}qr(gw,"onAnimationEnd");qr(pw,"onAnimationIteration");qr(mw,"onAnimationStart");qr("dblclick","onDoubleClick");qr("focusin","onFocus");qr("focusout","onBlur");qr(_w,"onTransitionEnd");Vo("onMouseEnter",["mouseout","mouseover"]);Vo("onMouseLeave",["mouseout","mouseover"]);Vo("onPointerEnter",["pointerout","pointerover"]);Vo("onPointerLeave",["pointerout","pointerover"]);Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $a="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hx=new Set("cancel close invalid load scroll toggle".split(" ").concat($a));function g0(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,KR(i,e,void 0,n),n.currentTarget=null}function vw(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;g0(r,a,c),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;g0(r,a,c),s=l}}}if(Hc)throw n=_g,Hc=!1,_g=null,n}function Ve(n,e){var t=e[Sg];t===void 0&&(t=e[Sg]=new Set);var i=n+"__bubble";t.has(i)||(Ew(e,n,2,!1),t.add(i))}function pf(n,e,t){var i=0;e&&(i|=4),Ew(t,n,i,e)}var tc="_reactListening"+Math.random().toString(36).slice(2);function Cl(n){if(!n[tc]){n[tc]=!0,SE.forEach(function(t){t!=="selectionchange"&&(Hx.has(t)||pf(t,!1,n),pf(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[tc]||(e[tc]=!0,pf("selectionchange",!1,e))}}function Ew(n,e,t,i){switch(iw(e)){case 1:var r=lx;break;case 4:r=ux;break;default:r=Kp}t=r.bind(null,e,t,n),r=void 0,!mg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function mf(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=ds(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}GE(function(){var c=s,h=jp(t),d=[];e:{var f=yw.get(n);if(f!==void 0){var p=Hp,_=n;switch(n){case"keypress":if(kc(t)===0)break e;case"keydown":case"keyup":p=Cx;break;case"focusin":_="focus",p=uf;break;case"focusout":_="blur",p=uf;break;case"beforeblur":case"afterblur":p=uf;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=n0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=dx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Sx;break;case gw:case pw:case mw:p=px;break;case _w:p=Px;break;case"scroll":p=cx;break;case"wheel":p=kx;break;case"copy":case"cut":case"paste":p=_x;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=r0}var w=(e&4)!==0,T=!w&&n==="scroll",v=w?f!==null?f+"Capture":null:f;w=[];for(var y=c,I;y!==null;){I=y;var S=I.stateNode;if(I.tag===5&&S!==null&&(I=S,v!==null&&(S=yl(y,v),S!=null&&w.push(Rl(y,S,I)))),T)break;y=y.return}0<w.length&&(f=new p(f,_,null,t,h),d.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==gg&&(_=t.relatedTarget||t.fromElement)&&(ds(_)||_[Wi]))break e;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(_=t.relatedTarget||t.toElement,p=c,_=_?ds(_):null,_!==null&&(T=Os(_),_!==T||_.tag!==5&&_.tag!==6)&&(_=null)):(p=null,_=c),p!==_)){if(w=n0,S="onMouseLeave",v="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(w=r0,S="onPointerLeave",v="onPointerEnter",y="pointer"),T=p==null?f:mo(p),I=_==null?f:mo(_),f=new w(S,y+"leave",p,t,h),f.target=T,f.relatedTarget=I,S=null,ds(h)===c&&(w=new w(v,y+"enter",_,t,h),w.target=I,w.relatedTarget=T,S=w),T=S,p&&_)t:{for(w=p,v=_,y=0,I=w;I;I=Ks(I))y++;for(I=0,S=v;S;S=Ks(S))I++;for(;0<y-I;)w=Ks(w),y--;for(;0<I-y;)v=Ks(v),I--;for(;y--;){if(w===v||v!==null&&w===v.alternate)break t;w=Ks(w),v=Ks(v)}w=null}else w=null;p!==null&&p0(d,f,p,w,!1),_!==null&&T!==null&&p0(d,T,_,w,!0)}}e:{if(f=c?mo(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var k=Vx;else if(a0(f))if(uw)k=jx;else{k=Ux;var O=zx}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=Bx);if(k&&(k=k(n,c))){lw(d,k,t,h);break e}O&&O(n,f,c),n==="focusout"&&(O=f._wrapperState)&&O.controlled&&f.type==="number"&&ug(f,"number",f.value)}switch(O=c?mo(c):window,n){case"focusin":(a0(O)||O.contentEditable==="true")&&(go=O,wg=c,ol=null);break;case"focusout":ol=wg=go=null;break;case"mousedown":Tg=!0;break;case"contextmenu":case"mouseup":case"dragend":Tg=!1,d0(d,t,h);break;case"selectionchange":if($x)break;case"keydown":case"keyup":d0(d,t,h)}var C;if(Yp)e:{switch(n){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else fo?ow(n,t)&&(E="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(E="onCompositionStart");E&&(sw&&t.locale!=="ko"&&(fo||E!=="onCompositionStart"?E==="onCompositionEnd"&&fo&&(C=rw()):(Er=h,Xp="value"in Er?Er.value:Er.textContent,fo=!0)),O=Jc(c,E),0<O.length&&(E=new i0(E,n,null,t,h),d.push({event:E,listeners:O}),C?E.data=C:(C=aw(t),C!==null&&(E.data=C)))),(C=Mx?Ox(n,t):Nx(n,t))&&(c=Jc(c,"onBeforeInput"),0<c.length&&(h=new i0("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:c}),h.data=C))}vw(d,e)})}function Rl(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Jc(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=yl(n,t),s!=null&&i.unshift(Rl(n,s,r)),s=yl(n,e),s!=null&&i.push(Rl(n,s,r))),n=n.return}return i}function Ks(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function p0(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,r?(l=yl(t,s),l!=null&&o.unshift(Rl(t,l,a))):r||(l=yl(t,s),l!=null&&o.push(Rl(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var qx=/\r\n?/g,Yx=/\u0000|\uFFFD/g;function m0(n){return(typeof n=="string"?n:""+n).replace(qx,`
`).replace(Yx,"")}function nc(n,e,t){if(e=m0(e),m0(n)!==e&&t)throw Error(j(425))}function eh(){}var Ig=null,Cg=null;function Rg(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var xg=typeof setTimeout=="function"?setTimeout:void 0,Zx=typeof clearTimeout=="function"?clearTimeout:void 0,_0=typeof Promise=="function"?Promise:void 0,Qx=typeof queueMicrotask=="function"?queueMicrotask:typeof _0<"u"?function(n){return _0.resolve(null).then(n).catch(Jx)}:xg;function Jx(n){setTimeout(function(){throw n})}function _f(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),wl(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);wl(e)}function Pr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function y0(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var la=Math.random().toString(36).slice(2),oi="__reactFiber$"+la,xl="__reactProps$"+la,Wi="__reactContainer$"+la,Sg="__reactEvents$"+la,eS="__reactListeners$"+la,tS="__reactHandles$"+la;function ds(n){var e=n[oi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Wi]||t[oi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=y0(n);n!==null;){if(t=n[oi])return t;n=y0(n)}return e}n=t,t=n.parentNode}return null}function uu(n){return n=n[oi]||n[Wi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function mo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(j(33))}function Yh(n){return n[xl]||null}var Ag=[],_o=-1;function Yr(n){return{current:n}}function Ue(n){0>_o||(n.current=Ag[_o],Ag[_o]=null,_o--)}function Ne(n,e){_o++,Ag[_o]=n.current,n.current=e}var Br={},Bt=Yr(Br),sn=Yr(!1),Cs=Br;function zo(n,e){var t=n.type.contextTypes;if(!t)return Br;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function on(n){return n=n.childContextTypes,n!=null}function th(){Ue(sn),Ue(Bt)}function v0(n,e,t){if(Bt.current!==Br)throw Error(j(168));Ne(Bt,e),Ne(sn,t)}function ww(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(j(108,zR(n)||"Unknown",r));return $e({},t,i)}function nh(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Br,Cs=Bt.current,Ne(Bt,n),Ne(sn,sn.current),!0}function E0(n,e,t){var i=n.stateNode;if(!i)throw Error(j(169));t?(n=ww(n,e,Cs),i.__reactInternalMemoizedMergedChildContext=n,Ue(sn),Ue(Bt),Ne(Bt,n)):Ue(sn),Ne(sn,t)}var Mi=null,Zh=!1,yf=!1;function Tw(n){Mi===null?Mi=[n]:Mi.push(n)}function nS(n){Zh=!0,Tw(n)}function Zr(){if(!yf&&Mi!==null){yf=!0;var n=0,e=Pe;try{var t=Mi;for(Pe=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Mi=null,Zh=!1}catch(r){throw Mi!==null&&(Mi=Mi.slice(n+1)),XE(Gp,Zr),r}finally{Pe=e,yf=!1}}return null}var yo=[],vo=0,ih=null,rh=0,In=[],Cn=0,Rs=null,Ni=1,Fi="";function ls(n,e){yo[vo++]=rh,yo[vo++]=ih,ih=n,rh=e}function Iw(n,e,t){In[Cn++]=Ni,In[Cn++]=Fi,In[Cn++]=Rs,Rs=n;var i=Ni;n=Fi;var r=32-Kn(i)-1;i&=~(1<<r),t+=1;var s=32-Kn(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Ni=1<<32-Kn(e)+r|t<<r|i,Fi=s+n}else Ni=1<<s|t<<r|i,Fi=n}function Qp(n){n.return!==null&&(ls(n,1),Iw(n,1,0))}function Jp(n){for(;n===ih;)ih=yo[--vo],yo[vo]=null,rh=yo[--vo],yo[vo]=null;for(;n===Rs;)Rs=In[--Cn],In[Cn]=null,Fi=In[--Cn],In[Cn]=null,Ni=In[--Cn],In[Cn]=null}var gn=null,fn=null,je=!1,Bn=null;function Cw(n,e){var t=xn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function w0(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,gn=n,fn=Pr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,gn=n,fn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Rs!==null?{id:Ni,overflow:Fi}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=xn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,gn=n,fn=null,!0):!1;default:return!1}}function Pg(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Dg(n){if(je){var e=fn;if(e){var t=e;if(!w0(n,e)){if(Pg(n))throw Error(j(418));e=Pr(t.nextSibling);var i=gn;e&&w0(n,e)?Cw(i,t):(n.flags=n.flags&-4097|2,je=!1,gn=n)}}else{if(Pg(n))throw Error(j(418));n.flags=n.flags&-4097|2,je=!1,gn=n}}}function T0(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;gn=n}function ic(n){if(n!==gn)return!1;if(!je)return T0(n),je=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Rg(n.type,n.memoizedProps)),e&&(e=fn)){if(Pg(n))throw Rw(),Error(j(418));for(;e;)Cw(n,e),e=Pr(e.nextSibling)}if(T0(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(j(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){fn=Pr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}fn=null}}else fn=gn?Pr(n.stateNode.nextSibling):null;return!0}function Rw(){for(var n=fn;n;)n=Pr(n.nextSibling)}function Uo(){fn=gn=null,je=!1}function em(n){Bn===null?Bn=[n]:Bn.push(n)}var iS=Zi.ReactCurrentBatchConfig;function Na(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(j(309));var i=t.stateNode}if(!i)throw Error(j(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(j(284));if(!t._owner)throw Error(j(290,n))}return n}function rc(n,e){throw n=Object.prototype.toString.call(e),Error(j(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function I0(n){var e=n._init;return e(n._payload)}function xw(n){function e(v,y){if(n){var I=v.deletions;I===null?(v.deletions=[y],v.flags|=16):I.push(y)}}function t(v,y){if(!n)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function r(v,y){return v=Mr(v,y),v.index=0,v.sibling=null,v}function s(v,y,I){return v.index=I,n?(I=v.alternate,I!==null?(I=I.index,I<y?(v.flags|=2,y):I):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,y,I,S){return y===null||y.tag!==6?(y=Rf(I,v.mode,S),y.return=v,y):(y=r(y,I),y.return=v,y)}function l(v,y,I,S){var k=I.type;return k===ho?h(v,y,I.props.children,S,I.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===pr&&I0(k)===y.type)?(S=r(y,I.props),S.ref=Na(v,y,I),S.return=v,S):(S=Vc(I.type,I.key,I.props,null,v.mode,S),S.ref=Na(v,y,I),S.return=v,S)}function c(v,y,I,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==I.containerInfo||y.stateNode.implementation!==I.implementation?(y=xf(I,v.mode,S),y.return=v,y):(y=r(y,I.children||[]),y.return=v,y)}function h(v,y,I,S,k){return y===null||y.tag!==7?(y=ws(I,v.mode,S,k),y.return=v,y):(y=r(y,I),y.return=v,y)}function d(v,y,I){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Rf(""+y,v.mode,I),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Xu:return I=Vc(y.type,y.key,y.props,null,v.mode,I),I.ref=Na(v,null,y),I.return=v,I;case co:return y=xf(y,v.mode,I),y.return=v,y;case pr:var S=y._init;return d(v,S(y._payload),I)}if(Ga(y)||Da(y))return y=ws(y,v.mode,I,null),y.return=v,y;rc(v,y)}return null}function f(v,y,I,S){var k=y!==null?y.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return k!==null?null:a(v,y,""+I,S);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Xu:return I.key===k?l(v,y,I,S):null;case co:return I.key===k?c(v,y,I,S):null;case pr:return k=I._init,f(v,y,k(I._payload),S)}if(Ga(I)||Da(I))return k!==null?null:h(v,y,I,S,null);rc(v,I)}return null}function p(v,y,I,S,k){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(I)||null,a(y,v,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Xu:return v=v.get(S.key===null?I:S.key)||null,l(y,v,S,k);case co:return v=v.get(S.key===null?I:S.key)||null,c(y,v,S,k);case pr:var O=S._init;return p(v,y,I,O(S._payload),k)}if(Ga(S)||Da(S))return v=v.get(I)||null,h(y,v,S,k,null);rc(y,S)}return null}function _(v,y,I,S){for(var k=null,O=null,C=y,E=y=0,R=null;C!==null&&E<I.length;E++){C.index>E?(R=C,C=null):R=C.sibling;var P=f(v,C,I[E],S);if(P===null){C===null&&(C=R);break}n&&C&&P.alternate===null&&e(v,C),y=s(P,y,E),O===null?k=P:O.sibling=P,O=P,C=R}if(E===I.length)return t(v,C),je&&ls(v,E),k;if(C===null){for(;E<I.length;E++)C=d(v,I[E],S),C!==null&&(y=s(C,y,E),O===null?k=C:O.sibling=C,O=C);return je&&ls(v,E),k}for(C=i(v,C);E<I.length;E++)R=p(C,v,E,I[E],S),R!==null&&(n&&R.alternate!==null&&C.delete(R.key===null?E:R.key),y=s(R,y,E),O===null?k=R:O.sibling=R,O=R);return n&&C.forEach(function(D){return e(v,D)}),je&&ls(v,E),k}function w(v,y,I,S){var k=Da(I);if(typeof k!="function")throw Error(j(150));if(I=k.call(I),I==null)throw Error(j(151));for(var O=k=null,C=y,E=y=0,R=null,P=I.next();C!==null&&!P.done;E++,P=I.next()){C.index>E?(R=C,C=null):R=C.sibling;var D=f(v,C,P.value,S);if(D===null){C===null&&(C=R);break}n&&C&&D.alternate===null&&e(v,C),y=s(D,y,E),O===null?k=D:O.sibling=D,O=D,C=R}if(P.done)return t(v,C),je&&ls(v,E),k;if(C===null){for(;!P.done;E++,P=I.next())P=d(v,P.value,S),P!==null&&(y=s(P,y,E),O===null?k=P:O.sibling=P,O=P);return je&&ls(v,E),k}for(C=i(v,C);!P.done;E++,P=I.next())P=p(C,v,E,P.value,S),P!==null&&(n&&P.alternate!==null&&C.delete(P.key===null?E:P.key),y=s(P,y,E),O===null?k=P:O.sibling=P,O=P);return n&&C.forEach(function(L){return e(v,L)}),je&&ls(v,E),k}function T(v,y,I,S){if(typeof I=="object"&&I!==null&&I.type===ho&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Xu:e:{for(var k=I.key,O=y;O!==null;){if(O.key===k){if(k=I.type,k===ho){if(O.tag===7){t(v,O.sibling),y=r(O,I.props.children),y.return=v,v=y;break e}}else if(O.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===pr&&I0(k)===O.type){t(v,O.sibling),y=r(O,I.props),y.ref=Na(v,O,I),y.return=v,v=y;break e}t(v,O);break}else e(v,O);O=O.sibling}I.type===ho?(y=ws(I.props.children,v.mode,S,I.key),y.return=v,v=y):(S=Vc(I.type,I.key,I.props,null,v.mode,S),S.ref=Na(v,y,I),S.return=v,v=S)}return o(v);case co:e:{for(O=I.key;y!==null;){if(y.key===O)if(y.tag===4&&y.stateNode.containerInfo===I.containerInfo&&y.stateNode.implementation===I.implementation){t(v,y.sibling),y=r(y,I.children||[]),y.return=v,v=y;break e}else{t(v,y);break}else e(v,y);y=y.sibling}y=xf(I,v.mode,S),y.return=v,v=y}return o(v);case pr:return O=I._init,T(v,y,O(I._payload),S)}if(Ga(I))return _(v,y,I,S);if(Da(I))return w(v,y,I,S);rc(v,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,y!==null&&y.tag===6?(t(v,y.sibling),y=r(y,I),y.return=v,v=y):(t(v,y),y=Rf(I,v.mode,S),y.return=v,v=y),o(v)):t(v,y)}return T}var Bo=xw(!0),Sw=xw(!1),sh=Yr(null),oh=null,Eo=null,tm=null;function nm(){tm=Eo=oh=null}function im(n){var e=sh.current;Ue(sh),n._currentValue=e}function kg(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Do(n,e){oh=n,tm=Eo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(nn=!0),n.firstContext=null)}function Pn(n){var e=n._currentValue;if(tm!==n)if(n={context:n,memoizedValue:e,next:null},Eo===null){if(oh===null)throw Error(j(308));Eo=n,oh.dependencies={lanes:0,firstContext:n}}else Eo=Eo.next=n;return e}var fs=null;function rm(n){fs===null?fs=[n]:fs.push(n)}function Aw(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,rm(e)):(t.next=r.next,r.next=t),e.interleaved=t,$i(n,i)}function $i(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var mr=!1;function sm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pw(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function bi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Dr(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Ee&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,$i(n,t)}return r=i.interleaved,r===null?(e.next=e,rm(i)):(e.next=r.next,r.next=e),i.interleaved=e,$i(n,t)}function Lc(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Wp(n,t)}}function C0(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function ah(n,e,t,i){var r=n.updateQueue;mr=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,h=c=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((i&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=n,w=a;switch(f=e,p=t,w.tag){case 1:if(_=w.payload,typeof _=="function"){d=_.call(p,d,f);break e}d=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=w.payload,f=typeof _=="function"?_.call(p,d,f):_,f==null)break e;d=$e({},d,f);break e;case 2:mr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=p,l=d):h=h.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(h===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Ss|=o,n.lanes=o,n.memoizedState=d}}function R0(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(j(191,r));r.call(i)}}}var cu={},fi=Yr(cu),Sl=Yr(cu),Al=Yr(cu);function gs(n){if(n===cu)throw Error(j(174));return n}function om(n,e){switch(Ne(Al,e),Ne(Sl,n),Ne(fi,cu),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=hg(e,n)}Ue(fi),Ne(fi,e)}function jo(){Ue(fi),Ue(Sl),Ue(Al)}function Dw(n){gs(Al.current);var e=gs(fi.current),t=hg(e,n.type);e!==t&&(Ne(Sl,n),Ne(fi,t))}function am(n){Sl.current===n&&(Ue(fi),Ue(Sl))}var Ge=Yr(0);function lh(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vf=[];function lm(){for(var n=0;n<vf.length;n++)vf[n]._workInProgressVersionPrimary=null;vf.length=0}var Mc=Zi.ReactCurrentDispatcher,Ef=Zi.ReactCurrentBatchConfig,xs=0,We=null,at=null,pt=null,uh=!1,al=!1,Pl=0,rS=0;function Lt(){throw Error(j(321))}function um(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!qn(n[t],e[t]))return!1;return!0}function cm(n,e,t,i,r,s){if(xs=s,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Mc.current=n===null||n.memoizedState===null?lS:uS,n=t(i,r),al){s=0;do{if(al=!1,Pl=0,25<=s)throw Error(j(301));s+=1,pt=at=null,e.updateQueue=null,Mc.current=cS,n=t(i,r)}while(al)}if(Mc.current=ch,e=at!==null&&at.next!==null,xs=0,pt=at=We=null,uh=!1,e)throw Error(j(300));return n}function hm(){var n=Pl!==0;return Pl=0,n}function si(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?We.memoizedState=pt=n:pt=pt.next=n,pt}function Dn(){if(at===null){var n=We.alternate;n=n!==null?n.memoizedState:null}else n=at.next;var e=pt===null?We.memoizedState:pt.next;if(e!==null)pt=e,at=n;else{if(n===null)throw Error(j(310));at=n,n={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},pt===null?We.memoizedState=pt=n:pt=pt.next=n}return pt}function Dl(n,e){return typeof e=="function"?e(n):e}function wf(n){var e=Dn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var i=at,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((xs&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:n(i,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,We.lanes|=h,Ss|=h}c=c.next}while(c!==null&&c!==s);l===null?o=i:l.next=a,qn(i,e.memoizedState)||(nn=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,We.lanes|=s,Ss|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Tf(n){var e=Dn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);qn(s,e.memoizedState)||(nn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function kw(){}function Lw(n,e){var t=We,i=Dn(),r=e(),s=!qn(i.memoizedState,r);if(s&&(i.memoizedState=r,nn=!0),i=i.queue,dm(Nw.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||pt!==null&&pt.memoizedState.tag&1){if(t.flags|=2048,kl(9,Ow.bind(null,t,i,r,e),void 0,null),mt===null)throw Error(j(349));xs&30||Mw(t,e,r)}return r}function Mw(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Ow(n,e,t,i){e.value=t,e.getSnapshot=i,Fw(e)&&bw(n)}function Nw(n,e,t){return t(function(){Fw(e)&&bw(n)})}function Fw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!qn(n,t)}catch{return!0}}function bw(n){var e=$i(n,1);e!==null&&Xn(e,n,1,-1)}function x0(n){var e=si();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dl,lastRenderedState:n},e.queue=n,n=n.dispatch=aS.bind(null,We,n),[e.memoizedState,n]}function kl(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function Vw(){return Dn().memoizedState}function Oc(n,e,t,i){var r=si();We.flags|=n,r.memoizedState=kl(1|e,t,void 0,i===void 0?null:i)}function Qh(n,e,t,i){var r=Dn();i=i===void 0?null:i;var s=void 0;if(at!==null){var o=at.memoizedState;if(s=o.destroy,i!==null&&um(i,o.deps)){r.memoizedState=kl(e,t,s,i);return}}We.flags|=n,r.memoizedState=kl(1|e,t,s,i)}function S0(n,e){return Oc(8390656,8,n,e)}function dm(n,e){return Qh(2048,8,n,e)}function zw(n,e){return Qh(4,2,n,e)}function Uw(n,e){return Qh(4,4,n,e)}function Bw(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function jw(n,e,t){return t=t!=null?t.concat([n]):null,Qh(4,4,Bw.bind(null,e,n),t)}function fm(){}function Gw(n,e){var t=Dn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&um(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function Ww(n,e){var t=Dn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&um(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function $w(n,e,t){return xs&21?(qn(t,e)||(t=YE(),We.lanes|=t,Ss|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,nn=!0),n.memoizedState=t)}function sS(n,e){var t=Pe;Pe=t!==0&&4>t?t:4,n(!0);var i=Ef.transition;Ef.transition={};try{n(!1),e()}finally{Pe=t,Ef.transition=i}}function Kw(){return Dn().memoizedState}function oS(n,e,t){var i=Lr(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},Xw(n))Hw(e,t);else if(t=Aw(n,e,t,i),t!==null){var r=$t();Xn(t,n,i,r),qw(t,e,i)}}function aS(n,e,t){var i=Lr(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(Xw(n))Hw(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,qn(a,o)){var l=e.interleaved;l===null?(r.next=r,rm(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=Aw(n,e,r,i),t!==null&&(r=$t(),Xn(t,n,i,r),qw(t,e,i))}}function Xw(n){var e=n.alternate;return n===We||e!==null&&e===We}function Hw(n,e){al=uh=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function qw(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Wp(n,t)}}var ch={readContext:Pn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},lS={readContext:Pn,useCallback:function(n,e){return si().memoizedState=[n,e===void 0?null:e],n},useContext:Pn,useEffect:S0,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Oc(4194308,4,Bw.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Oc(4194308,4,n,e)},useInsertionEffect:function(n,e){return Oc(4,2,n,e)},useMemo:function(n,e){var t=si();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=si();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=oS.bind(null,We,n),[i.memoizedState,n]},useRef:function(n){var e=si();return n={current:n},e.memoizedState=n},useState:x0,useDebugValue:fm,useDeferredValue:function(n){return si().memoizedState=n},useTransition:function(){var n=x0(!1),e=n[0];return n=sS.bind(null,n[1]),si().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=We,r=si();if(je){if(t===void 0)throw Error(j(407));t=t()}else{if(t=e(),mt===null)throw Error(j(349));xs&30||Mw(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,S0(Nw.bind(null,i,s,n),[n]),i.flags|=2048,kl(9,Ow.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=si(),e=mt.identifierPrefix;if(je){var t=Fi,i=Ni;t=(i&~(1<<32-Kn(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Pl++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=rS++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},uS={readContext:Pn,useCallback:Gw,useContext:Pn,useEffect:dm,useImperativeHandle:jw,useInsertionEffect:zw,useLayoutEffect:Uw,useMemo:Ww,useReducer:wf,useRef:Vw,useState:function(){return wf(Dl)},useDebugValue:fm,useDeferredValue:function(n){var e=Dn();return $w(e,at.memoizedState,n)},useTransition:function(){var n=wf(Dl)[0],e=Dn().memoizedState;return[n,e]},useMutableSource:kw,useSyncExternalStore:Lw,useId:Kw,unstable_isNewReconciler:!1},cS={readContext:Pn,useCallback:Gw,useContext:Pn,useEffect:dm,useImperativeHandle:jw,useInsertionEffect:zw,useLayoutEffect:Uw,useMemo:Ww,useReducer:Tf,useRef:Vw,useState:function(){return Tf(Dl)},useDebugValue:fm,useDeferredValue:function(n){var e=Dn();return at===null?e.memoizedState=n:$w(e,at.memoizedState,n)},useTransition:function(){var n=Tf(Dl)[0],e=Dn().memoizedState;return[n,e]},useMutableSource:kw,useSyncExternalStore:Lw,useId:Kw,unstable_isNewReconciler:!1};function zn(n,e){if(n&&n.defaultProps){e=$e({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Lg(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:$e({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Jh={isMounted:function(n){return(n=n._reactInternals)?Os(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=$t(),r=Lr(n),s=bi(i,r);s.payload=e,t!=null&&(s.callback=t),e=Dr(n,s,r),e!==null&&(Xn(e,n,r,i),Lc(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=$t(),r=Lr(n),s=bi(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Dr(n,s,r),e!==null&&(Xn(e,n,r,i),Lc(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=$t(),i=Lr(n),r=bi(t,i);r.tag=2,e!=null&&(r.callback=e),e=Dr(n,r,i),e!==null&&(Xn(e,n,i,t),Lc(e,n,i))}};function A0(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Il(t,i)||!Il(r,s):!0}function Yw(n,e,t){var i=!1,r=Br,s=e.contextType;return typeof s=="object"&&s!==null?s=Pn(s):(r=on(e)?Cs:Bt.current,i=e.contextTypes,s=(i=i!=null)?zo(n,r):Br),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Jh,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function P0(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&Jh.enqueueReplaceState(e,e.state,null)}function Mg(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},sm(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Pn(s):(s=on(e)?Cs:Bt.current,r.context=zo(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Lg(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Jh.enqueueReplaceState(r,r.state,null),ah(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Go(n,e){try{var t="",i=e;do t+=VR(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function If(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Og(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var hS=typeof WeakMap=="function"?WeakMap:Map;function Zw(n,e,t){t=bi(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){dh||(dh=!0,Wg=i),Og(n,e)},t}function Qw(n,e,t){t=bi(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){Og(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Og(n,e),typeof i!="function"&&(kr===null?kr=new Set([this]):kr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function D0(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new hS;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=RS.bind(null,n,e,t),e.then(n,n))}function k0(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function L0(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=bi(-1,1),e.tag=2,Dr(t,e,1))),t.lanes|=1),n)}var dS=Zi.ReactCurrentOwner,nn=!1;function Gt(n,e,t,i){e.child=n===null?Sw(e,null,t,i):Bo(e,n.child,t,i)}function M0(n,e,t,i,r){t=t.render;var s=e.ref;return Do(e,r),i=cm(n,e,t,i,s,r),t=hm(),n!==null&&!nn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Ki(n,e,r)):(je&&t&&Qp(e),e.flags|=1,Gt(n,e,i,r),e.child)}function O0(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!wm(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,Jw(n,e,s,i,r)):(n=Vc(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Il,t(o,i)&&n.ref===e.ref)return Ki(n,e,r)}return e.flags|=1,n=Mr(s,i),n.ref=e.ref,n.return=e,e.child=n}function Jw(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(Il(s,i)&&n.ref===e.ref)if(nn=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(nn=!0);else return e.lanes=n.lanes,Ki(n,e,r)}return Ng(n,e,t,i,r)}function eT(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(To,hn),hn|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ne(To,hn),hn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,Ne(To,hn),hn|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,Ne(To,hn),hn|=i;return Gt(n,e,r,t),e.child}function tT(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Ng(n,e,t,i,r){var s=on(t)?Cs:Bt.current;return s=zo(e,s),Do(e,r),t=cm(n,e,t,i,s,r),i=hm(),n!==null&&!nn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Ki(n,e,r)):(je&&i&&Qp(e),e.flags|=1,Gt(n,e,t,r),e.child)}function N0(n,e,t,i,r){if(on(t)){var s=!0;nh(e)}else s=!1;if(Do(e,r),e.stateNode===null)Nc(n,e),Yw(e,t,i),Mg(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Pn(c):(c=on(t)?Cs:Bt.current,c=zo(e,c));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&P0(e,o,i,c),mr=!1;var f=e.memoizedState;o.state=f,ah(e,i,o,r),l=e.memoizedState,a!==i||f!==l||sn.current||mr?(typeof h=="function"&&(Lg(e,t,h,i),l=e.memoizedState),(a=mr||A0(e,t,a,i,f,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,Pw(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:zn(e.type,a),o.props=c,d=e.pendingProps,f=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Pn(l):(l=on(t)?Cs:Bt.current,l=zo(e,l));var p=t.getDerivedStateFromProps;(h=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&P0(e,o,i,l),mr=!1,f=e.memoizedState,o.state=f,ah(e,i,o,r);var _=e.memoizedState;a!==d||f!==_||sn.current||mr?(typeof p=="function"&&(Lg(e,t,p,i),_=e.memoizedState),(c=mr||A0(e,t,c,i,f,_,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,_,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=_),o.props=i,o.state=_,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),i=!1)}return Fg(n,e,t,i,s,r)}function Fg(n,e,t,i,r,s){tT(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&E0(e,t,!1),Ki(n,e,s);i=e.stateNode,dS.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Bo(e,n.child,null,s),e.child=Bo(e,null,a,s)):Gt(n,e,a,s),e.memoizedState=i.state,r&&E0(e,t,!0),e.child}function nT(n){var e=n.stateNode;e.pendingContext?v0(n,e.pendingContext,e.pendingContext!==e.context):e.context&&v0(n,e.context,!1),om(n,e.containerInfo)}function F0(n,e,t,i,r){return Uo(),em(r),e.flags|=256,Gt(n,e,t,i),e.child}var bg={dehydrated:null,treeContext:null,retryLane:0};function Vg(n){return{baseLanes:n,cachePool:null,transitions:null}}function iT(n,e,t){var i=e.pendingProps,r=Ge.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Ne(Ge,r&1),n===null)return Dg(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=nd(o,i,0,null),n=ws(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=Vg(t),e.memoizedState=bg,n):gm(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return fS(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Mr(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Mr(a,s):(s=ws(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?Vg(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=bg,i}return s=n.child,n=s.sibling,i=Mr(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function gm(n,e){return e=nd({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function sc(n,e,t,i){return i!==null&&em(i),Bo(e,n.child,null,t),n=gm(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function fS(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=If(Error(j(422))),sc(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=nd({mode:"visible",children:i.children},r,0,null),s=ws(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Bo(e,n.child,null,o),e.child.memoizedState=Vg(o),e.memoizedState=bg,s);if(!(e.mode&1))return sc(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(j(419)),i=If(s,i,void 0),sc(n,e,o,i)}if(a=(o&n.childLanes)!==0,nn||a){if(i=mt,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,$i(n,r),Xn(i,n,r,-1))}return Em(),i=If(Error(j(421))),sc(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=xS.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,fn=Pr(r.nextSibling),gn=e,je=!0,Bn=null,n!==null&&(In[Cn++]=Ni,In[Cn++]=Fi,In[Cn++]=Rs,Ni=n.id,Fi=n.overflow,Rs=e),e=gm(e,i.children),e.flags|=4096,e)}function b0(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),kg(n.return,e,t)}function Cf(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function rT(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Gt(n,e,i.children,t),i=Ge.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&b0(n,t,e);else if(n.tag===19)b0(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Ne(Ge,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&lh(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),Cf(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&lh(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}Cf(e,!0,t,null,s);break;case"together":Cf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Nc(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ki(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ss|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(j(153));if(e.child!==null){for(n=e.child,t=Mr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Mr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function gS(n,e,t){switch(e.tag){case 3:nT(e),Uo();break;case 5:Dw(e);break;case 1:on(e.type)&&nh(e);break;case 4:om(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Ne(sh,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Ne(Ge,Ge.current&1),e.flags|=128,null):t&e.child.childLanes?iT(n,e,t):(Ne(Ge,Ge.current&1),n=Ki(n,e,t),n!==null?n.sibling:null);Ne(Ge,Ge.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return rT(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ne(Ge,Ge.current),i)break;return null;case 22:case 23:return e.lanes=0,eT(n,e,t)}return Ki(n,e,t)}var sT,zg,oT,aT;sT=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};zg=function(){};oT=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,gs(fi.current);var s=null;switch(t){case"input":r=ag(n,r),i=ag(n,i),s=[];break;case"select":r=$e({},r,{value:void 0}),i=$e({},i,{value:void 0}),s=[];break;case"textarea":r=cg(n,r),i=cg(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=eh)}dg(t,i);var o;t=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ml.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ml.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ve("scroll",n),s||a===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};aT=function(n,e,t,i){t!==i&&(e.flags|=4)};function Fa(n,e){if(!je)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Mt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function pS(n,e,t){var i=e.pendingProps;switch(Jp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(e),null;case 1:return on(e.type)&&th(),Mt(e),null;case 3:return i=e.stateNode,jo(),Ue(sn),Ue(Bt),lm(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(ic(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Bn!==null&&(Xg(Bn),Bn=null))),zg(n,e),Mt(e),null;case 5:am(e);var r=gs(Al.current);if(t=e.type,n!==null&&e.stateNode!=null)oT(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(j(166));return Mt(e),null}if(n=gs(fi.current),ic(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[oi]=e,i[xl]=s,n=(e.mode&1)!==0,t){case"dialog":Ve("cancel",i),Ve("close",i);break;case"iframe":case"object":case"embed":Ve("load",i);break;case"video":case"audio":for(r=0;r<$a.length;r++)Ve($a[r],i);break;case"source":Ve("error",i);break;case"img":case"image":case"link":Ve("error",i),Ve("load",i);break;case"details":Ve("toggle",i);break;case"input":Ky(i,s),Ve("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ve("invalid",i);break;case"textarea":Hy(i,s),Ve("invalid",i)}dg(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&nc(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&nc(i.textContent,a,n),r=["children",""+a]):ml.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ve("scroll",i)}switch(t){case"input":Hu(i),Xy(i,s,!0);break;case"textarea":Hu(i),qy(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=eh)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=NE(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[oi]=e,n[xl]=i,sT(n,e,!1,!1),e.stateNode=n;e:{switch(o=fg(t,i),t){case"dialog":Ve("cancel",n),Ve("close",n),r=i;break;case"iframe":case"object":case"embed":Ve("load",n),r=i;break;case"video":case"audio":for(r=0;r<$a.length;r++)Ve($a[r],n);r=i;break;case"source":Ve("error",n),r=i;break;case"img":case"image":case"link":Ve("error",n),Ve("load",n),r=i;break;case"details":Ve("toggle",n),r=i;break;case"input":Ky(n,i),r=ag(n,i),Ve("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=$e({},i,{value:void 0}),Ve("invalid",n);break;case"textarea":Hy(n,i),r=cg(n,i),Ve("invalid",n);break;default:r=i}dg(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?VE(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&FE(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&_l(n,l):typeof l=="number"&&_l(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ml.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ve("scroll",n):l!=null&&Vp(n,s,l,o))}switch(t){case"input":Hu(n),Xy(n,i,!1);break;case"textarea":Hu(n),qy(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Ur(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?xo(n,!!i.multiple,s,!1):i.defaultValue!=null&&xo(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=eh)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Mt(e),null;case 6:if(n&&e.stateNode!=null)aT(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(j(166));if(t=gs(Al.current),gs(fi.current),ic(e)){if(i=e.stateNode,t=e.memoizedProps,i[oi]=e,(s=i.nodeValue!==t)&&(n=gn,n!==null))switch(n.tag){case 3:nc(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&nc(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[oi]=e,e.stateNode=i}return Mt(e),null;case 13:if(Ue(Ge),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(je&&fn!==null&&e.mode&1&&!(e.flags&128))Rw(),Uo(),e.flags|=98560,s=!1;else if(s=ic(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(j(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(j(317));s[oi]=e}else Uo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Mt(e),s=!1}else Bn!==null&&(Xg(Bn),Bn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Ge.current&1?lt===0&&(lt=3):Em())),e.updateQueue!==null&&(e.flags|=4),Mt(e),null);case 4:return jo(),zg(n,e),n===null&&Cl(e.stateNode.containerInfo),Mt(e),null;case 10:return im(e.type._context),Mt(e),null;case 17:return on(e.type)&&th(),Mt(e),null;case 19:if(Ue(Ge),s=e.memoizedState,s===null)return Mt(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Fa(s,!1);else{if(lt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=lh(n),o!==null){for(e.flags|=128,Fa(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ne(Ge,Ge.current&1|2),e.child}n=n.sibling}s.tail!==null&&Je()>Wo&&(e.flags|=128,i=!0,Fa(s,!1),e.lanes=4194304)}else{if(!i)if(n=lh(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Fa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!je)return Mt(e),null}else 2*Je()-s.renderingStartTime>Wo&&t!==1073741824&&(e.flags|=128,i=!0,Fa(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Je(),e.sibling=null,t=Ge.current,Ne(Ge,i?t&1|2:t&1),e):(Mt(e),null);case 22:case 23:return vm(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?hn&1073741824&&(Mt(e),e.subtreeFlags&6&&(e.flags|=8192)):Mt(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function mS(n,e){switch(Jp(e),e.tag){case 1:return on(e.type)&&th(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return jo(),Ue(sn),Ue(Bt),lm(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return am(e),null;case 13:if(Ue(Ge),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(j(340));Uo()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ue(Ge),null;case 4:return jo(),null;case 10:return im(e.type._context),null;case 22:case 23:return vm(),null;case 24:return null;default:return null}}var oc=!1,Vt=!1,_S=typeof WeakSet=="function"?WeakSet:Set,Z=null;function wo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){qe(n,e,i)}else t.current=null}function Ug(n,e,t){try{t()}catch(i){qe(n,e,i)}}var V0=!1;function yS(n,e){if(Ig=Zc,n=dw(),Zp(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,h=0,d=n,f=null;t:for(;;){for(var p;d!==t||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===n)break t;if(f===t&&++c===r&&(a=o),f===s&&++h===i&&(l=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Cg={focusedElem:n,selectionRange:t},Zc=!1,Z=e;Z!==null;)if(e=Z,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Z=n;else for(;Z!==null;){e=Z;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var w=_.memoizedProps,T=_.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:zn(e.type,w),T);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(S){qe(e,e.return,S)}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}return _=V0,V0=!1,_}function ll(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&Ug(e,t,s)}r=r.next}while(r!==i)}}function ed(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function Bg(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function lT(n){var e=n.alternate;e!==null&&(n.alternate=null,lT(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[oi],delete e[xl],delete e[Sg],delete e[eS],delete e[tS])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function uT(n){return n.tag===5||n.tag===3||n.tag===4}function z0(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||uT(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function jg(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=eh));else if(i!==4&&(n=n.child,n!==null))for(jg(n,e,t),n=n.sibling;n!==null;)jg(n,e,t),n=n.sibling}function Gg(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Gg(n,e,t),n=n.sibling;n!==null;)Gg(n,e,t),n=n.sibling}var wt=null,Un=!1;function ar(n,e,t){for(t=t.child;t!==null;)cT(n,e,t),t=t.sibling}function cT(n,e,t){if(di&&typeof di.onCommitFiberUnmount=="function")try{di.onCommitFiberUnmount(Kh,t)}catch{}switch(t.tag){case 5:Vt||wo(t,e);case 6:var i=wt,r=Un;wt=null,ar(n,e,t),wt=i,Un=r,wt!==null&&(Un?(n=wt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):wt.removeChild(t.stateNode));break;case 18:wt!==null&&(Un?(n=wt,t=t.stateNode,n.nodeType===8?_f(n.parentNode,t):n.nodeType===1&&_f(n,t),wl(n)):_f(wt,t.stateNode));break;case 4:i=wt,r=Un,wt=t.stateNode.containerInfo,Un=!0,ar(n,e,t),wt=i,Un=r;break;case 0:case 11:case 14:case 15:if(!Vt&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Ug(t,e,o),r=r.next}while(r!==i)}ar(n,e,t);break;case 1:if(!Vt&&(wo(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){qe(t,e,a)}ar(n,e,t);break;case 21:ar(n,e,t);break;case 22:t.mode&1?(Vt=(i=Vt)||t.memoizedState!==null,ar(n,e,t),Vt=i):ar(n,e,t);break;default:ar(n,e,t)}}function U0(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new _S),e.forEach(function(i){var r=SS.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function bn(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:wt=a.stateNode,Un=!1;break e;case 3:wt=a.stateNode.containerInfo,Un=!0;break e;case 4:wt=a.stateNode.containerInfo,Un=!0;break e}a=a.return}if(wt===null)throw Error(j(160));cT(s,o,r),wt=null,Un=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){qe(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)hT(e,n),e=e.sibling}function hT(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(bn(e,n),ri(n),i&4){try{ll(3,n,n.return),ed(3,n)}catch(w){qe(n,n.return,w)}try{ll(5,n,n.return)}catch(w){qe(n,n.return,w)}}break;case 1:bn(e,n),ri(n),i&512&&t!==null&&wo(t,t.return);break;case 5:if(bn(e,n),ri(n),i&512&&t!==null&&wo(t,t.return),n.flags&32){var r=n.stateNode;try{_l(r,"")}catch(w){qe(n,n.return,w)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&ME(r,s),fg(a,o);var c=fg(a,s);for(o=0;o<l.length;o+=2){var h=l[o],d=l[o+1];h==="style"?VE(r,d):h==="dangerouslySetInnerHTML"?FE(r,d):h==="children"?_l(r,d):Vp(r,h,d,c)}switch(a){case"input":lg(r,s);break;case"textarea":OE(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?xo(r,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?xo(r,!!s.multiple,s.defaultValue,!0):xo(r,!!s.multiple,s.multiple?[]:"",!1))}r[xl]=s}catch(w){qe(n,n.return,w)}}break;case 6:if(bn(e,n),ri(n),i&4){if(n.stateNode===null)throw Error(j(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(w){qe(n,n.return,w)}}break;case 3:if(bn(e,n),ri(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{wl(e.containerInfo)}catch(w){qe(n,n.return,w)}break;case 4:bn(e,n),ri(n);break;case 13:bn(e,n),ri(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(_m=Je())),i&4&&U0(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Vt=(c=Vt)||h,bn(e,n),Vt=c):bn(e,n),ri(n),i&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!h&&n.mode&1)for(Z=n,h=n.child;h!==null;){for(d=Z=h;Z!==null;){switch(f=Z,p=f.child,f.tag){case 0:case 11:case 14:case 15:ll(4,f,f.return);break;case 1:wo(f,f.return);var _=f.stateNode;if(typeof _.componentWillUnmount=="function"){i=f,t=f.return;try{e=i,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(w){qe(i,t,w)}}break;case 5:wo(f,f.return);break;case 22:if(f.memoizedState!==null){j0(d);continue}}p!==null?(p.return=f,Z=p):j0(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{r=d.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=bE("display",o))}catch(w){qe(n,n.return,w)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(w){qe(n,n.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:bn(e,n),ri(n),i&4&&U0(n);break;case 21:break;default:bn(e,n),ri(n)}}function ri(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(uT(t)){var i=t;break e}t=t.return}throw Error(j(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(_l(r,""),i.flags&=-33);var s=z0(n);Gg(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=z0(n);jg(n,a,o);break;default:throw Error(j(161))}}catch(l){qe(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function vS(n,e,t){Z=n,dT(n)}function dT(n,e,t){for(var i=(n.mode&1)!==0;Z!==null;){var r=Z,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||oc;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Vt;a=oc;var c=Vt;if(oc=o,(Vt=l)&&!c)for(Z=r;Z!==null;)o=Z,l=o.child,o.tag===22&&o.memoizedState!==null?G0(r):l!==null?(l.return=o,Z=l):G0(r);for(;s!==null;)Z=s,dT(s),s=s.sibling;Z=r,oc=a,Vt=c}B0(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Z=s):B0(n)}}function B0(n){for(;Z!==null;){var e=Z;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vt||ed(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Vt)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:zn(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&R0(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}R0(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&wl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}Vt||e.flags&512&&Bg(e)}catch(f){qe(e,e.return,f)}}if(e===n){Z=null;break}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}}function j0(n){for(;Z!==null;){var e=Z;if(e===n){Z=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Z=t;break}Z=e.return}}function G0(n){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{ed(4,e)}catch(l){qe(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){qe(e,r,l)}}var s=e.return;try{Bg(e)}catch(l){qe(e,s,l)}break;case 5:var o=e.return;try{Bg(e)}catch(l){qe(e,o,l)}}}catch(l){qe(e,e.return,l)}if(e===n){Z=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Z=a;break}Z=e.return}}var ES=Math.ceil,hh=Zi.ReactCurrentDispatcher,pm=Zi.ReactCurrentOwner,An=Zi.ReactCurrentBatchConfig,Ee=0,mt=null,it=null,St=0,hn=0,To=Yr(0),lt=0,Ll=null,Ss=0,td=0,mm=0,ul=null,Yt=null,_m=0,Wo=1/0,Li=null,dh=!1,Wg=null,kr=null,ac=!1,wr=null,fh=0,cl=0,$g=null,Fc=-1,bc=0;function $t(){return Ee&6?Je():Fc!==-1?Fc:Fc=Je()}function Lr(n){return n.mode&1?Ee&2&&St!==0?St&-St:iS.transition!==null?(bc===0&&(bc=YE()),bc):(n=Pe,n!==0||(n=window.event,n=n===void 0?16:iw(n.type)),n):1}function Xn(n,e,t,i){if(50<cl)throw cl=0,$g=null,Error(j(185));au(n,t,i),(!(Ee&2)||n!==mt)&&(n===mt&&(!(Ee&2)&&(td|=t),lt===4&&vr(n,St)),an(n,i),t===1&&Ee===0&&!(e.mode&1)&&(Wo=Je()+500,Zh&&Zr()))}function an(n,e){var t=n.callbackNode;ix(n,e);var i=Yc(n,n===mt?St:0);if(i===0)t!==null&&Qy(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&Qy(t),e===1)n.tag===0?nS(W0.bind(null,n)):Tw(W0.bind(null,n)),Qx(function(){!(Ee&6)&&Zr()}),t=null;else{switch(ZE(i)){case 1:t=Gp;break;case 4:t=HE;break;case 16:t=qc;break;case 536870912:t=qE;break;default:t=qc}t=ET(t,fT.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function fT(n,e){if(Fc=-1,bc=0,Ee&6)throw Error(j(327));var t=n.callbackNode;if(ko()&&n.callbackNode!==t)return null;var i=Yc(n,n===mt?St:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=gh(n,i);else{e=i;var r=Ee;Ee|=2;var s=pT();(mt!==n||St!==e)&&(Li=null,Wo=Je()+500,Es(n,e));do try{IS();break}catch(a){gT(n,a)}while(!0);nm(),hh.current=s,Ee=r,it!==null?e=0:(mt=null,St=0,e=lt)}if(e!==0){if(e===2&&(r=yg(n),r!==0&&(i=r,e=Kg(n,r))),e===1)throw t=Ll,Es(n,0),vr(n,i),an(n,Je()),t;if(e===6)vr(n,i);else{if(r=n.current.alternate,!(i&30)&&!wS(r)&&(e=gh(n,i),e===2&&(s=yg(n),s!==0&&(i=s,e=Kg(n,s))),e===1))throw t=Ll,Es(n,0),vr(n,i),an(n,Je()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(j(345));case 2:us(n,Yt,Li);break;case 3:if(vr(n,i),(i&130023424)===i&&(e=_m+500-Je(),10<e)){if(Yc(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){$t(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=xg(us.bind(null,n,Yt,Li),e);break}us(n,Yt,Li);break;case 4:if(vr(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-Kn(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Je()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*ES(i/1960))-i,10<i){n.timeoutHandle=xg(us.bind(null,n,Yt,Li),i);break}us(n,Yt,Li);break;case 5:us(n,Yt,Li);break;default:throw Error(j(329))}}}return an(n,Je()),n.callbackNode===t?fT.bind(null,n):null}function Kg(n,e){var t=ul;return n.current.memoizedState.isDehydrated&&(Es(n,e).flags|=256),n=gh(n,e),n!==2&&(e=Yt,Yt=t,e!==null&&Xg(e)),n}function Xg(n){Yt===null?Yt=n:Yt.push.apply(Yt,n)}function wS(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!qn(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vr(n,e){for(e&=~mm,e&=~td,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Kn(e),i=1<<t;n[t]=-1,e&=~i}}function W0(n){if(Ee&6)throw Error(j(327));ko();var e=Yc(n,0);if(!(e&1))return an(n,Je()),null;var t=gh(n,e);if(n.tag!==0&&t===2){var i=yg(n);i!==0&&(e=i,t=Kg(n,i))}if(t===1)throw t=Ll,Es(n,0),vr(n,e),an(n,Je()),t;if(t===6)throw Error(j(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,us(n,Yt,Li),an(n,Je()),null}function ym(n,e){var t=Ee;Ee|=1;try{return n(e)}finally{Ee=t,Ee===0&&(Wo=Je()+500,Zh&&Zr())}}function As(n){wr!==null&&wr.tag===0&&!(Ee&6)&&ko();var e=Ee;Ee|=1;var t=An.transition,i=Pe;try{if(An.transition=null,Pe=1,n)return n()}finally{Pe=i,An.transition=t,Ee=e,!(Ee&6)&&Zr()}}function vm(){hn=To.current,Ue(To)}function Es(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Zx(t)),it!==null)for(t=it.return;t!==null;){var i=t;switch(Jp(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&th();break;case 3:jo(),Ue(sn),Ue(Bt),lm();break;case 5:am(i);break;case 4:jo();break;case 13:Ue(Ge);break;case 19:Ue(Ge);break;case 10:im(i.type._context);break;case 22:case 23:vm()}t=t.return}if(mt=n,it=n=Mr(n.current,null),St=hn=e,lt=0,Ll=null,mm=td=Ss=0,Yt=ul=null,fs!==null){for(e=0;e<fs.length;e++)if(t=fs[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}fs=null}return n}function gT(n,e){do{var t=it;try{if(nm(),Mc.current=ch,uh){for(var i=We.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}uh=!1}if(xs=0,pt=at=We=null,al=!1,Pl=0,pm.current=null,t===null||t.return===null){lt=1,Ll=e,it=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=St,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=k0(o);if(p!==null){p.flags&=-257,L0(p,o,a,s,e),p.mode&1&&D0(s,c,e),e=p,l=c;var _=e.updateQueue;if(_===null){var w=new Set;w.add(l),e.updateQueue=w}else _.add(l);break e}else{if(!(e&1)){D0(s,c,e),Em();break e}l=Error(j(426))}}else if(je&&a.mode&1){var T=k0(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),L0(T,o,a,s,e),em(Go(l,a));break e}}s=l=Go(l,a),lt!==4&&(lt=2),ul===null?ul=[s]:ul.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=Zw(s,l,e);C0(s,v);break e;case 1:a=l;var y=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(kr===null||!kr.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=Qw(s,a,e);C0(s,S);break e}}s=s.return}while(s!==null)}_T(t)}catch(k){e=k,it===t&&t!==null&&(it=t=t.return);continue}break}while(!0)}function pT(){var n=hh.current;return hh.current=ch,n===null?ch:n}function Em(){(lt===0||lt===3||lt===2)&&(lt=4),mt===null||!(Ss&268435455)&&!(td&268435455)||vr(mt,St)}function gh(n,e){var t=Ee;Ee|=2;var i=pT();(mt!==n||St!==e)&&(Li=null,Es(n,e));do try{TS();break}catch(r){gT(n,r)}while(!0);if(nm(),Ee=t,hh.current=i,it!==null)throw Error(j(261));return mt=null,St=0,lt}function TS(){for(;it!==null;)mT(it)}function IS(){for(;it!==null&&!HR();)mT(it)}function mT(n){var e=vT(n.alternate,n,hn);n.memoizedProps=n.pendingProps,e===null?_T(n):it=e,pm.current=null}function _T(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=mS(t,e),t!==null){t.flags&=32767,it=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{lt=6,it=null;return}}else if(t=pS(t,e,hn),t!==null){it=t;return}if(e=e.sibling,e!==null){it=e;return}it=e=n}while(e!==null);lt===0&&(lt=5)}function us(n,e,t){var i=Pe,r=An.transition;try{An.transition=null,Pe=1,CS(n,e,t,i)}finally{An.transition=r,Pe=i}return null}function CS(n,e,t,i){do ko();while(wr!==null);if(Ee&6)throw Error(j(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(j(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(rx(n,s),n===mt&&(it=mt=null,St=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ac||(ac=!0,ET(qc,function(){return ko(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=An.transition,An.transition=null;var o=Pe;Pe=1;var a=Ee;Ee|=4,pm.current=null,yS(n,t),hT(t,n),Wx(Cg),Zc=!!Ig,Cg=Ig=null,n.current=t,vS(t),qR(),Ee=a,Pe=o,An.transition=s}else n.current=t;if(ac&&(ac=!1,wr=n,fh=r),s=n.pendingLanes,s===0&&(kr=null),QR(t.stateNode),an(n,Je()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(dh)throw dh=!1,n=Wg,Wg=null,n;return fh&1&&n.tag!==0&&ko(),s=n.pendingLanes,s&1?n===$g?cl++:(cl=0,$g=n):cl=0,Zr(),null}function ko(){if(wr!==null){var n=ZE(fh),e=An.transition,t=Pe;try{if(An.transition=null,Pe=16>n?16:n,wr===null)var i=!1;else{if(n=wr,wr=null,fh=0,Ee&6)throw Error(j(331));var r=Ee;for(Ee|=4,Z=n.current;Z!==null;){var s=Z,o=s.child;if(Z.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Z=c;Z!==null;){var h=Z;switch(h.tag){case 0:case 11:case 15:ll(8,h,s)}var d=h.child;if(d!==null)d.return=h,Z=d;else for(;Z!==null;){h=Z;var f=h.sibling,p=h.return;if(lT(h),h===c){Z=null;break}if(f!==null){f.return=p,Z=f;break}Z=p}}}var _=s.alternate;if(_!==null){var w=_.child;if(w!==null){_.child=null;do{var T=w.sibling;w.sibling=null,w=T}while(w!==null)}}Z=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Z=o;else e:for(;Z!==null;){if(s=Z,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ll(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Z=v;break e}Z=s.return}}var y=n.current;for(Z=y;Z!==null;){o=Z;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,Z=I;else e:for(o=y;Z!==null;){if(a=Z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ed(9,a)}}catch(k){qe(a,a.return,k)}if(a===o){Z=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,Z=S;break e}Z=a.return}}if(Ee=r,Zr(),di&&typeof di.onPostCommitFiberRoot=="function")try{di.onPostCommitFiberRoot(Kh,n)}catch{}i=!0}return i}finally{Pe=t,An.transition=e}}return!1}function $0(n,e,t){e=Go(t,e),e=Zw(n,e,1),n=Dr(n,e,1),e=$t(),n!==null&&(au(n,1,e),an(n,e))}function qe(n,e,t){if(n.tag===3)$0(n,n,t);else for(;e!==null;){if(e.tag===3){$0(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(kr===null||!kr.has(i))){n=Go(t,n),n=Qw(e,n,1),e=Dr(e,n,1),n=$t(),e!==null&&(au(e,1,n),an(e,n));break}}e=e.return}}function RS(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=$t(),n.pingedLanes|=n.suspendedLanes&t,mt===n&&(St&t)===t&&(lt===4||lt===3&&(St&130023424)===St&&500>Je()-_m?Es(n,0):mm|=t),an(n,e)}function yT(n,e){e===0&&(n.mode&1?(e=Zu,Zu<<=1,!(Zu&130023424)&&(Zu=4194304)):e=1);var t=$t();n=$i(n,e),n!==null&&(au(n,e,t),an(n,t))}function xS(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),yT(n,t)}function SS(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(j(314))}i!==null&&i.delete(e),yT(n,t)}var vT;vT=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||sn.current)nn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return nn=!1,gS(n,e,t);nn=!!(n.flags&131072)}else nn=!1,je&&e.flags&1048576&&Iw(e,rh,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Nc(n,e),n=e.pendingProps;var r=zo(e,Bt.current);Do(e,t),r=cm(null,e,i,n,r,t);var s=hm();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,on(i)?(s=!0,nh(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,sm(e),r.updater=Jh,e.stateNode=r,r._reactInternals=e,Mg(e,i,n,t),e=Fg(null,e,i,!0,s,t)):(e.tag=0,je&&s&&Qp(e),Gt(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Nc(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=PS(i),n=zn(i,n),r){case 0:e=Ng(null,e,i,n,t);break e;case 1:e=N0(null,e,i,n,t);break e;case 11:e=M0(null,e,i,n,t);break e;case 14:e=O0(null,e,i,zn(i.type,n),t);break e}throw Error(j(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:zn(i,r),Ng(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:zn(i,r),N0(n,e,i,r,t);case 3:e:{if(nT(e),n===null)throw Error(j(387));i=e.pendingProps,s=e.memoizedState,r=s.element,Pw(n,e),ah(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Go(Error(j(423)),e),e=F0(n,e,i,t,r);break e}else if(i!==r){r=Go(Error(j(424)),e),e=F0(n,e,i,t,r);break e}else for(fn=Pr(e.stateNode.containerInfo.firstChild),gn=e,je=!0,Bn=null,t=Sw(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Uo(),i===r){e=Ki(n,e,t);break e}Gt(n,e,i,t)}e=e.child}return e;case 5:return Dw(e),n===null&&Dg(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,Rg(i,r)?o=null:s!==null&&Rg(i,s)&&(e.flags|=32),tT(n,e),Gt(n,e,o,t),e.child;case 6:return n===null&&Dg(e),null;case 13:return iT(n,e,t);case 4:return om(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Bo(e,null,i,t):Gt(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:zn(i,r),M0(n,e,i,r,t);case 7:return Gt(n,e,e.pendingProps,t),e.child;case 8:return Gt(n,e,e.pendingProps.children,t),e.child;case 12:return Gt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Ne(sh,i._currentValue),i._currentValue=o,s!==null)if(qn(s.value,o)){if(s.children===r.children&&!sn.current){e=Ki(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=bi(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),kg(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(j(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),kg(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Gt(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Do(e,t),r=Pn(r),i=i(r),e.flags|=1,Gt(n,e,i,t),e.child;case 14:return i=e.type,r=zn(i,e.pendingProps),r=zn(i.type,r),O0(n,e,i,r,t);case 15:return Jw(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:zn(i,r),Nc(n,e),e.tag=1,on(i)?(n=!0,nh(e)):n=!1,Do(e,t),Yw(e,i,r),Mg(e,i,r,t),Fg(null,e,i,!0,n,t);case 19:return rT(n,e,t);case 22:return eT(n,e,t)}throw Error(j(156,e.tag))};function ET(n,e){return XE(n,e)}function AS(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(n,e,t,i){return new AS(n,e,t,i)}function wm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function PS(n){if(typeof n=="function")return wm(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Up)return 11;if(n===Bp)return 14}return 2}function Mr(n,e){var t=n.alternate;return t===null?(t=xn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Vc(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")wm(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case ho:return ws(t.children,r,s,e);case zp:o=8,r|=8;break;case ig:return n=xn(12,t,e,r|2),n.elementType=ig,n.lanes=s,n;case rg:return n=xn(13,t,e,r),n.elementType=rg,n.lanes=s,n;case sg:return n=xn(19,t,e,r),n.elementType=sg,n.lanes=s,n;case DE:return nd(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case AE:o=10;break e;case PE:o=9;break e;case Up:o=11;break e;case Bp:o=14;break e;case pr:o=16,i=null;break e}throw Error(j(130,n==null?n:typeof n,""))}return e=xn(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function ws(n,e,t,i){return n=xn(7,n,i,e),n.lanes=t,n}function nd(n,e,t,i){return n=xn(22,n,i,e),n.elementType=DE,n.lanes=t,n.stateNode={isHidden:!1},n}function Rf(n,e,t){return n=xn(6,n,null,e),n.lanes=t,n}function xf(n,e,t){return e=xn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function DS(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=of(0),this.expirationTimes=of(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=of(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Tm(n,e,t,i,r,s,o,a,l){return n=new DS(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xn(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},sm(s),n}function kS(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:co,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function wT(n){if(!n)return Br;n=n._reactInternals;e:{if(Os(n)!==n||n.tag!==1)throw Error(j(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(on(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(n.tag===1){var t=n.type;if(on(t))return ww(n,t,e)}return e}function TT(n,e,t,i,r,s,o,a,l){return n=Tm(t,i,!0,n,r,s,o,a,l),n.context=wT(null),t=n.current,i=$t(),r=Lr(t),s=bi(i,r),s.callback=e??null,Dr(t,s,r),n.current.lanes=r,au(n,r,i),an(n,i),n}function id(n,e,t,i){var r=e.current,s=$t(),o=Lr(r);return t=wT(t),e.context===null?e.context=t:e.pendingContext=t,e=bi(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Dr(r,e,o),n!==null&&(Xn(n,r,o,s),Lc(n,r,o)),o}function ph(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function K0(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Im(n,e){K0(n,e),(n=n.alternate)&&K0(n,e)}function LS(){return null}var IT=typeof reportError=="function"?reportError:function(n){console.error(n)};function Cm(n){this._internalRoot=n}rd.prototype.render=Cm.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(j(409));id(n,e,null,null)};rd.prototype.unmount=Cm.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;As(function(){id(null,n,null,null)}),e[Wi]=null}};function rd(n){this._internalRoot=n}rd.prototype.unstable_scheduleHydration=function(n){if(n){var e=ew();n={blockedOn:null,target:n,priority:e};for(var t=0;t<yr.length&&e!==0&&e<yr[t].priority;t++);yr.splice(t,0,n),t===0&&nw(n)}};function Rm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function sd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function X0(){}function MS(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=ph(o);s.call(c)}}var o=TT(e,i,n,0,null,!1,!1,"",X0);return n._reactRootContainer=o,n[Wi]=o.current,Cl(n.nodeType===8?n.parentNode:n),As(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var c=ph(l);a.call(c)}}var l=Tm(n,0,!1,null,null,!1,!1,"",X0);return n._reactRootContainer=l,n[Wi]=l.current,Cl(n.nodeType===8?n.parentNode:n),As(function(){id(e,l,t,i)}),l}function od(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=ph(o);a.call(l)}}id(e,o,n,r)}else o=MS(t,e,n,r,i);return ph(o)}QE=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Wa(e.pendingLanes);t!==0&&(Wp(e,t|1),an(e,Je()),!(Ee&6)&&(Wo=Je()+500,Zr()))}break;case 13:As(function(){var i=$i(n,1);if(i!==null){var r=$t();Xn(i,n,1,r)}}),Im(n,1)}};$p=function(n){if(n.tag===13){var e=$i(n,134217728);if(e!==null){var t=$t();Xn(e,n,134217728,t)}Im(n,134217728)}};JE=function(n){if(n.tag===13){var e=Lr(n),t=$i(n,e);if(t!==null){var i=$t();Xn(t,n,e,i)}Im(n,e)}};ew=function(){return Pe};tw=function(n,e){var t=Pe;try{return Pe=n,e()}finally{Pe=t}};pg=function(n,e,t){switch(e){case"input":if(lg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=Yh(i);if(!r)throw Error(j(90));LE(i),lg(i,r)}}}break;case"textarea":OE(n,t);break;case"select":e=t.value,e!=null&&xo(n,!!t.multiple,e,!1)}};BE=ym;jE=As;var OS={usingClientEntryPoint:!1,Events:[uu,mo,Yh,zE,UE,ym]},ba={findFiberByHostInstance:ds,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NS={bundleType:ba.bundleType,version:ba.version,rendererPackageName:ba.rendererPackageName,rendererConfig:ba.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=$E(n),n===null?null:n.stateNode},findFiberByHostInstance:ba.findFiberByHostInstance||LS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lc.isDisabled&&lc.supportsFiber)try{Kh=lc.inject(NS),di=lc}catch{}}_n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OS;_n.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rm(e))throw Error(j(200));return kS(n,e,null,t)};_n.createRoot=function(n,e){if(!Rm(n))throw Error(j(299));var t=!1,i="",r=IT;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Tm(n,1,!1,null,null,t,!1,i,r),n[Wi]=e.current,Cl(n.nodeType===8?n.parentNode:n),new Cm(e)};_n.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(j(188)):(n=Object.keys(n).join(","),Error(j(268,n)));return n=$E(e),n=n===null?null:n.stateNode,n};_n.flushSync=function(n){return As(n)};_n.hydrate=function(n,e,t){if(!sd(e))throw Error(j(200));return od(null,n,e,!0,t)};_n.hydrateRoot=function(n,e,t){if(!Rm(n))throw Error(j(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=IT;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=TT(e,null,n,1,t??null,r,!1,s,o),n[Wi]=e.current,Cl(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new rd(e)};_n.render=function(n,e,t){if(!sd(e))throw Error(j(200));return od(null,n,e,!1,t)};_n.unmountComponentAtNode=function(n){if(!sd(n))throw Error(j(40));return n._reactRootContainer?(As(function(){od(null,null,n,!1,function(){n._reactRootContainer=null,n[Wi]=null})}),!0):!1};_n.unstable_batchedUpdates=ym;_n.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!sd(t))throw Error(j(200));if(n==null||n._reactInternals===void 0)throw Error(j(38));return od(n,e,t,!1,i)};_n.version="18.3.1-next-f1338f8080-20240426";function CT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CT)}catch(n){console.error(n)}}CT(),CE.exports=_n;var FS=CE.exports,RT,H0=FS;RT=H0.createRoot,H0.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ml(){return Ml=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ml.apply(this,arguments)}var Tr;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Tr||(Tr={}));const q0="popstate";function bS(n){n===void 0&&(n={});function e(i,r){let{pathname:s,search:o,hash:a}=i.location;return Hg("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:ST(r)}return zS(e,t,null,n)}function ut(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function xT(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function VS(){return Math.random().toString(36).substr(2,8)}function Y0(n,e){return{usr:n.state,key:n.key,idx:e}}function Hg(n,e,t,i){return t===void 0&&(t=null),Ml({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?ua(e):e,{state:t,key:e&&e.key||i||VS()})}function ST(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function ua(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function zS(n,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=Tr.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(Ml({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function d(){a=Tr.Pop;let T=h(),v=T==null?null:T-c;c=T,l&&l({action:a,location:w.location,delta:v})}function f(T,v){a=Tr.Push;let y=Hg(w.location,T,v);c=h()+1;let I=Y0(y,c),S=w.createHref(y);try{o.pushState(I,"",S)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(S)}s&&l&&l({action:a,location:w.location,delta:1})}function p(T,v){a=Tr.Replace;let y=Hg(w.location,T,v);c=h();let I=Y0(y,c),S=w.createHref(y);o.replaceState(I,"",S),s&&l&&l({action:a,location:w.location,delta:0})}function _(T){let v=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof T=="string"?T:ST(T);return y=y.replace(/ $/,"%20"),ut(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let w={get action(){return a},get location(){return n(r,o)},listen(T){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(q0,d),l=T,()=>{r.removeEventListener(q0,d),l=null}},createHref(T){return e(r,T)},createURL:_,encodeLocation(T){let v=_(T);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:p,go(T){return o.go(T)}};return w}var Z0;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Z0||(Z0={}));function US(n,e,t){return t===void 0&&(t="/"),BS(n,e,t,!1)}function BS(n,e,t,i){let r=typeof e=="string"?ua(e):e,s=DT(r.pathname||"/",t);if(s==null)return null;let o=AT(n);jS(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=JS(s);a=ZS(o[l],c,i)}return a}function AT(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(ut(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=Ts([i,l.relativePath]),h=t.concat(l);s.children&&s.children.length>0&&(ut(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),AT(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:qS(c,s.index),routesMeta:h})};return n.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let l of PT(s.path))r(s,o,l)}),e}function PT(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=PT(i.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),r&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function jS(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:YS(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const GS=/^:[\w-]+$/,WS=3,$S=2,KS=1,XS=10,HS=-2,Q0=n=>n==="*";function qS(n,e){let t=n.split("/"),i=t.length;return t.some(Q0)&&(i+=HS),e&&(i+=$S),t.filter(r=>!Q0(r)).reduce((r,s)=>r+(GS.test(s)?WS:s===""?KS:XS),i)}function YS(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function ZS(n,e,t){let{routesMeta:i}=n,r={},s="/",o=[];for(let a=0;a<i.length;++a){let l=i[a],c=a===i.length-1,h=s==="/"?e:e.slice(s.length)||"/",d=J0({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),f=l.route;if(!d&&c&&t&&!i[i.length-1].route.index&&(d=J0({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:Ts([s,d.pathname]),pathnameBase:sA(Ts([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=Ts([s,d.pathnameBase]))}return o}function J0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=QS(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((c,h,d)=>{let{paramName:f,isOptional:p}=h;if(f==="*"){let w=a[d]||"";o=s.slice(0,s.length-w.length).replace(/(.)\/+$/,"$1")}const _=a[d];return p&&!_?c[f]=void 0:c[f]=(_||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:n}}function QS(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),xT(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function JS(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xT(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function DT(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function eA(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?ua(n):n;return{pathname:t?t.startsWith("/")?t:tA(t,e):e,search:oA(i),hash:aA(r)}}function tA(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function Sf(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nA(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function iA(n,e){let t=nA(n);return e?t.map((i,r)=>r===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function rA(n,e,t,i){i===void 0&&(i=!1);let r;typeof n=="string"?r=ua(n):(r=Ml({},n),ut(!r.pathname||!r.pathname.includes("?"),Sf("?","pathname","search",r)),ut(!r.pathname||!r.pathname.includes("#"),Sf("#","pathname","hash",r)),ut(!r.search||!r.search.includes("#"),Sf("#","search","hash",r)));let s=n===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=t;else{let d=e.length-1;if(!i&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;r.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=eA(r,a),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const Ts=n=>n.join("/").replace(/\/\/+/g,"/"),sA=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),oA=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,aA=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function lA(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const kT=["post","put","patch","delete"];new Set(kT);const uA=["get",...kT];new Set(uA);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ol(){return Ol=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ol.apply(this,arguments)}const xm=Y.createContext(null),cA=Y.createContext(null),ad=Y.createContext(null),ld=Y.createContext(null),ca=Y.createContext({outlet:null,matches:[],isDataRoute:!1}),LT=Y.createContext(null);function ud(){return Y.useContext(ld)!=null}function MT(){return ud()||ut(!1),Y.useContext(ld).location}function OT(n){Y.useContext(ad).static||Y.useLayoutEffect(n)}function NT(){let{isDataRoute:n}=Y.useContext(ca);return n?IA():hA()}function hA(){ud()||ut(!1);let n=Y.useContext(xm),{basename:e,future:t,navigator:i}=Y.useContext(ad),{matches:r}=Y.useContext(ca),{pathname:s}=MT(),o=JSON.stringify(iA(r,t.v7_relativeSplatPath)),a=Y.useRef(!1);return OT(()=>{a.current=!0}),Y.useCallback(function(c,h){if(h===void 0&&(h={}),!a.current)return;if(typeof c=="number"){i.go(c);return}let d=rA(c,JSON.parse(o),s,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Ts([e,d.pathname])),(h.replace?i.replace:i.push)(d,h.state,h)},[e,i,o,s,n])}function dA(n,e){return fA(n,e)}function fA(n,e,t,i){ud()||ut(!1);let{navigator:r}=Y.useContext(ad),{matches:s}=Y.useContext(ca),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=MT(),h;if(e){var d;let T=typeof e=="string"?ua(e):e;l==="/"||(d=T.pathname)!=null&&d.startsWith(l)||ut(!1),h=T}else h=c;let f=h.pathname||"/",p=f;if(l!=="/"){let T=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(T.length).join("/")}let _=US(n,{pathname:p}),w=yA(_&&_.map(T=>Object.assign({},T,{params:Object.assign({},a,T.params),pathname:Ts([l,r.encodeLocation?r.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?l:Ts([l,r.encodeLocation?r.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),s,t,i);return e&&w?Y.createElement(ld.Provider,{value:{location:Ol({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Tr.Pop}},w):w}function gA(){let n=TA(),e=lA(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},e),t?Y.createElement("pre",{style:r},t):null,null)}const pA=Y.createElement(gA,null);class mA extends Y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?Y.createElement(ca.Provider,{value:this.props.routeContext},Y.createElement(LT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _A(n){let{routeContext:e,match:t,children:i}=n,r=Y.useContext(xm);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),Y.createElement(ca.Provider,{value:e},i)}function yA(n,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=i)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(r=t)==null?void 0:r.errors;if(a!=null){let h=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);h>=0||ut(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,c=-1;if(t&&i&&i.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=h),d.route.id){let{loaderData:f,errors:p}=t,_=d.route.loader&&f[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||_){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((h,d,f)=>{let p,_=!1,w=null,T=null;t&&(p=a&&d.route.id?a[d.route.id]:void 0,w=d.route.errorElement||pA,l&&(c<0&&f===0?(_=!0,T=null):c===f&&(_=!0,T=d.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),y=()=>{let I;return p?I=w:_?I=T:d.route.Component?I=Y.createElement(d.route.Component,null):d.route.element?I=d.route.element:I=h,Y.createElement(_A,{match:d,routeContext:{outlet:h,matches:v,isDataRoute:t!=null},children:I})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?Y.createElement(mA,{location:t.location,revalidation:t.revalidation,component:w,error:p,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var FT=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(FT||{}),mh=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(mh||{});function vA(n){let e=Y.useContext(xm);return e||ut(!1),e}function EA(n){let e=Y.useContext(cA);return e||ut(!1),e}function wA(n){let e=Y.useContext(ca);return e||ut(!1),e}function bT(n){let e=wA(),t=e.matches[e.matches.length-1];return t.route.id||ut(!1),t.route.id}function TA(){var n;let e=Y.useContext(LT),t=EA(mh.UseRouteError),i=bT(mh.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function IA(){let{router:n}=vA(FT.UseNavigateStable),e=bT(mh.UseNavigateStable),t=Y.useRef(!1);return OT(()=>{t.current=!0}),Y.useCallback(function(r,s){s===void 0&&(s={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,Ol({fromRouteId:e},s)))},[n,e])}const ev={};function CA(n,e){ev[e]||(ev[e]=!0,console.warn(e))}const tv=(n,e,t)=>CA(n,"⚠️ React Router Future Flag Warning: "+e+". "+("You can use the `"+n+"` future flag to opt-in early. ")+("For more information, see "+t+"."));function RA(n,e){n!=null&&n.v7_startTransition||tv("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(n!=null&&n.v7_relativeSplatPath)&&!e&&tv("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function to(n){ut(!1)}function xA(n){let{basename:e="/",children:t=null,location:i,navigationType:r=Tr.Pop,navigator:s,static:o=!1,future:a}=n;ud()&&ut(!1);let l=e.replace(/^\/*/,"/"),c=Y.useMemo(()=>({basename:l,navigator:s,static:o,future:Ol({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof i=="string"&&(i=ua(i));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:_="default"}=i,w=Y.useMemo(()=>{let T=DT(h,l);return T==null?null:{location:{pathname:T,search:d,hash:f,state:p,key:_},navigationType:r}},[l,h,d,f,p,_,r]);return w==null?null:Y.createElement(ad.Provider,{value:c},Y.createElement(ld.Provider,{children:t,value:w}))}function SA(n){let{children:e,location:t}=n;return dA(qg(e),t)}new Promise(()=>{});function qg(n,e){e===void 0&&(e=[]);let t=[];return Y.Children.forEach(n,(i,r)=>{if(!Y.isValidElement(i))return;let s=[...e,r];if(i.type===Y.Fragment){t.push.apply(t,qg(i.props.children,s));return}i.type!==to&&ut(!1),!i.props.index||!i.props.children||ut(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=qg(i.props.children,s)),t.push(o)}),t}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const AA="6";try{window.__reactRouterVersion=AA}catch{}const PA="startTransition",nv=RR[PA];function DA(n){let{basename:e,children:t,future:i,window:r}=n,s=Y.useRef();s.current==null&&(s.current=bS({window:r,v5Compat:!0}));let o=s.current,[a,l]=Y.useState({action:o.action,location:o.location}),{v7_startTransition:c}=i||{},h=Y.useCallback(d=>{c&&nv?nv(()=>l(d)):l(d)},[l,c]);return Y.useLayoutEffect(()=>o.listen(h),[o,h]),Y.useEffect(()=>RA(i),[i]),Y.createElement(xA,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:i})}var iv;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(iv||(iv={}));var rv;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(rv||(rv={}));const VT="/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/assets/prevIcon-BPrWVZaj.png",zT="/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/assets/rotasIcon-CkFiRzTn.png",kA="/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/assets/homeIcon-DYYY2IIc.png",UT="/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/assets/chatIcon-DeJr9Ml2.png";function LA(){const n=NT();function e(t){n(t)}return b.jsxs("footer",{children:[b.jsx("button",{onClick:()=>{e("/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/")},children:b.jsx("img",{className:"Footerimg",src:kA})}),b.jsx("button",{onClick:()=>{e("/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/rotas")},children:b.jsx("img",{className:"Footerimg",src:zT})}),b.jsx("button",{onClick:()=>{e("/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/previsoes")},children:b.jsx("img",{className:"Footerimg",src:VT})}),b.jsx("button",{onClick:()=>{e("/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/chat")},children:b.jsx("img",{className:"Footerimg",src:UT})})]})}const sv={nome:"Anel Viário",pontos:["Letras","ICB","ICE","IAD","Engenharia","RU","CRITT","CBR","ICB","FAEFID","Curva Repressa","Corpo de Bombeiros","Direito"]},uc={nome:"Circular",pontos:["Letras","ICB","ICE","IAD","Engenharia","RU","CRITT","CBR","ICB","FAEFID","HU","Corpo de Bombeiros","Odonto","Economia","Educação","ICH","Direito"]},ov={nome:"Odonto-Direto",pontos:["Letras","ICB","ICE","IAD","Engenharia","RU","CRITT","CBR","ICB","FAEFID","Curva Repressa","Corpo de Bombeiros","Odonto","Economia","Educação","Direito"]},av={nome:"Odonto-ICH-RU",pontos:["Letras","ICB","ICE","IAD","Engenharia","RU","CRITT","CBR","ICB","FAEFID","Curva Repressa","Corpo de Bombeiros","Odonto","Economia","Educação","ICH","Direito"]},lv={nome:"HU-RU direto",pontos:["Letras","ICB","ICE","IAD","Engenharia","RU","CRITT","CBR","ICB","FAEFID","HU","Corpo de Bombeiros","Direito"]},MA=[{nome:"horario do almoço",inicio:"11:00:00",fim:"14:15:00",rotas:[ov,av,sv,lv,uc],intervaloPontos:Math.round(15/13),intervaloTotal:15},{nome:"horario da jantar",inicio:"17:00:00",fim:"20:15:00",rotas:[ov,av,sv,lv,uc],intervaloPontos:Math.round(15/13),intervaloTotal:15},{nome:"horario da manhã",inicio:"06:00:00",fim:"11:00:00",rotas:[uc],intervaloPontos:Math.round(30/13),intervaloTotal:30},{nome:"horario da tarde",inicio:"14:00:00",fim:"16:00:00",rotas:[uc],intervaloPontos:Math.round(30/13),intervaloTotal:30}],uv={nome:"fora do horário",inicio:"21:00:00",fim:"24:00:00",rotas:[{nome:"Fora do horário",pontos:[]}],intervaloPontos:0,intervaloTotal:0};class OA{constructor(){$u(this,"calculaRestante",(e,t,i)=>{const r=e.pontos.indexOf(t),s=i.intervaloPontos,o=e.pontos.length,a=new Date,[l,c,h]=i.inicio.split(":").map(Number);a.setHours(l),a.setMinutes(c),a.setSeconds(h);const d=new Date,p=Math.floor((d.getTime()-a.getTime())/6e4)%(o*s)+s*r,_=o*s-p;d.setMinutes(d.getMinutes()+_);const w=d.getHours().toString().padStart(2,"0"),T=d.getMinutes().toString().padStart(2,"0");return{tempo:`${w}:${T}`,restante:`${_}m`}});$u(this,"calcularHorariosRestantes",(e,t,i)=>e.map(r=>({rota:r,...this.calculaRestante(r,t,i)})).sort((r,s)=>parseInt(r.restante)-parseInt(s.restante)))}get Pontos(){return["Letras","ICB","ICE","IAD","Engenharia","CRITT","RU","CBR","ICB","FAEFID","Direito","HU","Curva Repressa","Corpo de Bombeiros","Odonto","Economia","Educação","ICH"]}get horariosDate(){const e=new Date;return e.getDay()===0||e.getDay()===6?uv:MA.find(i=>{const r=new Date(`${e.toDateString()} ${i.inicio}`),s=new Date(`${e.toDateString()} ${i.fim}`);return e>=r&&e<=s})??uv}}const Af=new OA;function NA({horaChegada:n,horaPrevisão:e,nome:t}){const i=parseInt(e.replace("m",""));return b.jsxs("div",{className:"container",children:[b.jsx("h2",{children:t}),b.jsxs("div",{className:"data",children:[b.jsxs("section",{children:[b.jsx("h3",{children:"chegada:"}),b.jsx("p",{children:n})]}),b.jsxs("section",{children:[b.jsx("h3",{children:"Previsão:"}),b.jsx("p",{children:e})]})]}),i<15?b.jsx("div",{className:"blink",style:{backgroundColor:"green"}}):i<30?b.jsx("div",{className:"blink",style:{backgroundColor:"orange"}}):b.jsx("div",{className:"blink",style:{backgroundColor:"red"}})]})}function hu({titulo:n,children:e}){return b.jsxs("header",{children:[b.jsx("h1",{children:n}),e]})}const FA="/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/assets/semHoraIcon-mmLVA8hB.svg";function bA({nomeAtual:n,intervalo:e}){if(n!="fora do horário")return b.jsx("div",{className:"DisclaimerHorario",children:b.jsxs("p",{children:["Os horarios são apenas uma previsão, podendo haver atrasos ou adiantamentos. Você está no ",b.jsx("span",{children:n}),", os onibus agora passam em média a cada  ",b.jsxs("span",{children:[e," minutos"]})," ."]})})}function BT({onchangeHandler:n,options:e,nomeInput:t}){return b.jsxs("section",{className:"DropDown",children:[b.jsx("label",{htmlFor:"pontos",children:t}),b.jsx("select",{onChange:i=>n(i),children:e.map((i,r)=>b.jsx("option",{value:i,children:i},`valor${r}`))})]})}function VA(){const[n,e]=Y.useState("Letras");function t(o){const a=o.target;if(a){const l=a.options[a.selectedIndex].value;e(l)}}const i=Af.Pontos,r=Af.horariosDate,s=Af.calcularHorariosRestantes(r.rotas,n,r);return b.jsxs("div",{className:"Previsão",children:[b.jsx(hu,{titulo:"Previsão",children:b.jsx(BT,{onchangeHandler:t,options:i,nomeInput:"Ponto Atual"})}),b.jsx("main",{children:b.jsxs("div",{className:"Previsões",children:[b.jsx(bA,{nomeAtual:r.nome,intervalo:r.intervaloTotal}),s.map(({rota:o,tempo:a,restante:l},c)=>o.nome=="Fora do horário"?b.jsx("img",{className:"semHoraImg",src:FA,alt:"fora do horário"}):b.jsx(NA,{horaChegada:a,horaPrevisão:l,nome:o.nome},`Horario${c}`))]})})]})}const cv=[[-4827423815761e-6,-2484590680306e-6],[-4827425010089e-6,-2484587694485e-6],[-4827421277813e-6,-2484573959706e-6],[-4827424412925e-6,-2484565599406e-6],[-4827432623934e-6,-2484552312501e-6],[-4827442178563e-6,-2484528873803e-6],[-4827448000914e-6,-2484505435105e-6],[-4827445015093e-6,-2484471844614e-6],[-4827429040948e-6,-2484380926351e-6],[-4827422024268e-6,-2484360324184e-6],[-4827402168556e-6,-2484326733693e-6],[-4827394106838e-6,-2484323150707e-6],[-4827391121016e-6,-2484316656545e-6],[-4827393584319e-6,-2484309117346e-6],[-4827400227772e-6,-2484305758297e-6],[-4827407095161e-6,-2484307251208e-6],[-4827411573893e-6,-2484313222851e-6],[-4827410678147e-6,-2484320388822e-6],[-4827404557213e-6,-2484325912592e-6],[-482740209391e-5,-2484326733693e-6],[-482741112602e-5,-2484345917595e-6],[-4827421949622e-6,-2484360025602e-6],[-4827428443784e-6,-2484376820847e-6],[-4827447851623e-6,-2484505136522e-6],[-4827432623934e-6,-2484551864628e-6],[-4827434415427e-6,-2484585529764e-6],[-4827434564718e-6,-2484585753701e-6]],hv=[[-4827640984175e-6,-2484575772764e-6],[-4827614319561e-6,-2484570439841e-6],[-4827594442303e-6,-2484574803142e-6],[-4827578928346e-6,-2484584984176e-6],[-4827578928346e-6,-2484600013322e-6],[-4827596381548e-6,-2484617466524e-6],[-4827620622106e-6,-2484625223503e-6],[-4827649225965e-6,-2484654312173e-6],[-4827667163978e-6,-2484705217345e-6],[-4827668618412e-6,-2484742062994e-6],[-4827656498133e-6,-2484777454209e-6],[-4827640014553e-6,-2484814784669e-6],[-4827640014553e-6,-2484814784669e-6],[-4827581837213e-6,-2484858902485e-6],[-4827568926682e-6,-2484857911323e-6],[-4827552504664e-6,-2484848356694e-6],[-4827525930853e-6,-248483103893e-5],[-4827496968386e-6,-2484795806237e-6],[-4827495774057e-6,-2484792223252e-6],[-4827467558045e-6,-2484792969707e-6],[-4827447851623e-6,-2484789834595e-6],[-4827434415427e-6,-2484780130675e-6],[-4827270643122e-6,-2484642633599e-6],[-4827292364973e-6,-2484613148612e-6],[-4827292364973e-6,-2484613148612e-6],[-4827317744455e-6,-2484635169045e-6],[-4827317595164e-6,-2484637557702e-6],[-4827297515515e-6,-2484664056867e-6],[-4827437923767e-6,-2484783415079e-6],[-4827449045952e-6,-2484790282468e-6],[-4827468080563e-6,-248479274577e-5],[-4827487040529e-6,-2484791402151e-6],[-4827487040529e-6,-2484791402151e-6],[-4827488160212e-6,-2484768262035e-6],[-482747114103e-5,-2484741688224e-6],[-4827446582649e-6,-2484717279134e-6],[-4827362830358e-6,-2484666669461e-6],[-4827354395413e-6,-2484657114833e-6],[-4827349468808e-6,-2484646067293e-6],[-4827347901251e-6,-248463725912e-5],[-482734909558e-5,-2484625614417e-6],[-4827354693995e-6,-2484612775385e-6],[-4827365592243e-6,-2484603370047e-6],[-4827365592243e-6,-2484603370047e-6],[-4827402317847e-6,-2484589187395e-6],[-482741396255e-5,-2484588142358e-6],[-4827423815761e-6,-2484590680306e-6],[-4827434564718e-6,-2484585753701e-6],[-4827472186068e-6,-2484615462624e-6],[-4827501447118e-6,-2484617254117e-6],[-4827526975891e-6,-2484615761206e-6],[-4827545487984e-6,-2484608893817e-6],[-4827578033437e-6,-2484584857954e-6],[-4827612818257e-6,-2484523797906e-6]],zA=[[-4827748971713e-6,-2485155299136e-6],[-4827725484067e-6,-2485179418305e-6],[-4827698959204e-6,-2485204415898e-6],[-4827645662292e-6,-2485297722818e-6],[-4827585945864e-6,-2485330566853e-6],[-4827591917507e-6,-2485392671939e-6],[-4827609832435e-6,-2485417454257e-6],[-4827678207746e-6,-2485427008885e-6],[-4827817123087e-6,-2485497474271e-6],[-482789699381e-5,-2485538454669e-6],[-4827909011741e-6,-2485608696118e-6],[-4827900352859e-6,-2485678116466e-6],[-482788094502e-5,-248574410312e-5],[-4827858849941e-6,-248577134874e-5],[-4827840636431e-6,-2485776424636e-6],[-4827779874965e-6,-2485773065587e-6],[-4827742402906e-6,-2485787696112e-6],[-4827779874965e-6,-2485773065587e-6],[-4827779874965e-6,-2485773065587e-6],[-4827840636431e-6,-2485776424636e-6],[-4827858849941e-6,-248577134874e-5],[-482788094502e-5,-248574410312e-5],[-4827900352859e-6,-2485678116466e-6],[-4827906847021e-6,-2485631388361e-6],[-4827906847021e-6,-2485631388361e-6],[-4827863254028e-6,-2485527929649e-6],[-482782525945e-5,-2485505983862e-6],[-4827808762787e-6,-2485493368766e-6],[-4827694480472e-6,-2485430367934e-6],[-4827626329098e-6,-2485423351254e-6],[-4827610131017e-6,-2485417678193e-6],[-4827592962544e-6,-2485395209887e-6],[-4827582213587e-6,-2485311159014e-6],[-4827622522176e-6,-2485302724069e-6],[-4827654321174e-6,-2485270029324e-6],[-4827659919589e-6,-2485254503053e-6],[-4827699108496e-6,-2485057886712e-6]],cc=[[-4827922447938e-6,-2484341214927e-6],[-4827958576377e-6,-2484373909671e-6],[-4827963652273e-6,-2484424817926e-6],[-4827907817413e-6,-2484709814581e-6],[-4827976491305e-6,-2484844773709e-6],[-4828015306984e-6,-2484916433423e-6],[-4828088459608e-6,-248499973784e-5],[-4828107568865e-6,-248499824493e-5],[-4828115332001e-6,-2484986600226e-6],[-4828172958354e-6,-2485017354187e-6],[-4828393311975e-6,-248512663525e-5],[-4828416004218e-6,-2485124246593e-6],[-4828426753175e-6,-2485117677786e-6],[-4828448848253e-6,-2485073487629e-6],[-4828439592207e-6,-2485060648597e-6],[-4828394506304e-6,-2485066321658e-6],[-4828359572193e-6,-2485068113151e-6],[-4828332251927e-6,-248505825994e-5],[-4828235212731e-6,-2484998394221e-6],[-4828162358688e-6,-2484950471787e-6],[-4828142950849e-6,-248489657771e-5],[-4828172958354e-6,-2484731461786e-6],[-4828199681456e-6,-2484693243272e-6],[-482824476736e-5,-2484705037266e-6],[-4828479602214e-6,-2484990033921e-6],[-4828450341164e-6,-2485075577704e-6],[-4828425857429e-6,-2485119170697e-6],[-4828401373693e-6,-2485126933833e-6],[-4828175347012e-6,-2485019742844e-6],[-4828113241926e-6,-2485022131501e-6],[-4828085772369e-6,-2485000036422e-6],[-4828015306984e-6,-2484919120662e-6],[-4827991420412e-6,-2484863584384e-6],[-4827932898313e-6,-2484760573545e-6],[-4827911997563e-6,-2484740568541e-6],[-482790751883e-5,-2484741165706e-6],[-4827898262784e-6,-2484754004738e-6],[-4827895575545e-6,-2484770128173e-6],[-4827919205059e-6,-2484854877169e-6],[-4828032027584e-6,-2485063335836e-6],[-4828029041762e-6,-2485108123158e-6],[-4828018889969e-6,-2485127232415e-6],[-4827982462948e-6,-2485148133165e-6],[-4827938272791e-6,-2485138578536e-6],[-4827867807406e-6,-2485093791215e-6],[-482784332367e-5,-2485094985543e-6],[-4827815256949e-6,-2485102748679e-6],[-4827748971713e-6,-2485155299136e-6],[-4827725682306e-6,-2485158882122e-6],[-4827697615585e-6,-24851391757e-4],[-4827692838271e-6,-2485116483458e-6],[-4827699108496e-6,-2485057886712e-6],[-4827725682306e-6,-2484708620252e-6],[-4827716724842e-6,-2484640543524e-6],[-4827690449613e-6,-2484604116502e-6],[-4827667757371e-6,-248458978456e-5],[-4827640984175e-6,-2484575772764e-6],[-4827621178557e-6,-2484555746195e-6],[-4827612818257e-6,-2484523797906e-6],[-4827652081808e-6,-2484335392575e-6],[-4827680447112e-6,-2484300159882e-6],[-4827727772381e-6,-2484294188239e-6],[-4827922447938e-6,-2484341214927e-6]],UA=["Anel Viario","Circular","Odonto Direto","Odonto-Ich-RU","HU-RU Direto"],Sm={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class jT{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Sm[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const du=6378137,Io=Math.PI*du,BA=[-Io,-Io,Io,Io],jA=[-180,-85,180,85],hc=du*Math.log(Math.tan(Math.PI/2));class Xs extends jT{constructor(e){super({code:e,units:"m",extent:BA,global:!0,worldExtent:jA,getPointResolution:function(t,i){return t/Math.cosh(i[1]/du)}})}}const dv=[new Xs("EPSG:3857"),new Xs("EPSG:102100"),new Xs("EPSG:102113"),new Xs("EPSG:900913"),new Xs("http://www.opengis.net/def/crs/EPSG/0/3857"),new Xs("http://www.opengis.net/gml/srs/epsg.xml#3857")];function GA(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Io*n[s]/180;let o=du*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>hc?o=hc:o<-hc&&(o=-hc),e[s+1]=o}return e}function WA(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Io,e[s+1]=360*Math.atan(Math.exp(n[s+1]/du))/Math.PI-90;return e}const $A=6378137,fv=[-180,-90,180,90],KA=Math.PI*$A/180;class os extends jT{constructor(e,t){super({code:e,units:"degrees",extent:fv,axisOrientation:t,global:!0,metersPerUnit:KA,worldExtent:fv})}}const gv=[new os("CRS:84"),new os("EPSG:4326","neu"),new os("urn:ogc:def:crs:OGC:1.3:CRS84"),new os("urn:ogc:def:crs:OGC:2:84"),new os("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new os("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new os("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Yg={};function XA(n){return Yg[n]||Yg[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function HA(n,e){Yg[n]=e}function fu(n){for(const e in n)delete n[e]}function $o(n){let e;for(e in n)return!1;return!e}let Lo={};function _h(n,e,t){const i=n.getCode(),r=e.getCode();i in Lo||(Lo[i]={}),Lo[i][r]=t}function qA(n,e){let t;return n in Lo&&e in Lo[n]&&(t=Lo[n][e]),t}const ft={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function pv(n){const e=kn();for(let t=0,i=n.length;t<i;++t)hl(e,n[t]);return e}function Am(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function GT(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Pm(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function Ko(n,e){return WT(n,e[0],e[1])}function Co(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function WT(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Zg(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let l=ft.UNKNOWN;return o<t?l=l|ft.LEFT:o>r&&(l=l|ft.RIGHT),a<i?l=l|ft.BELOW:a>s&&(l=l|ft.ABOVE),l===ft.UNKNOWN&&(l=ft.INTERSECTING),l}function kn(){return[1/0,1/0,-1/0,-1/0]}function jr(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function cd(n){return jr(1/0,1/0,-1/0,-1/0,n)}function $T(n,e){const t=n[0],i=n[1];return jr(t,i,t,i,e)}function Dm(n,e,t,i,r){const s=cd(r);return KT(s,n,e,t,i)}function Nl(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function YA(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function hl(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function KT(n,e,t,i,r){for(;t<i;t+=r)ZA(n,e[t],e[t+1]);return n}function ZA(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function XT(n,e){let t;return t=e(hd(n)),t||(t=e(dd(n)),t)||(t=e(fd(n)),t)||(t=e(Ns(n)),t)?t:!1}function Fl(n){let e=0;return gd(n)||(e=Re(n)*Ut(n)),e}function hd(n){return[n[0],n[1]]}function dd(n){return[n[2],n[1]]}function Ps(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function QA(n,e){let t;if(e==="bottom-left")t=hd(n);else if(e==="bottom-right")t=dd(n);else if(e==="top-left")t=Ns(n);else if(e==="top-right")t=fd(n);else throw new Error("Invalid corner");return t}function Qg(n,e,t,i,r){const[s,o,a,l,c,h,d,f]=JA(n,e,t,i);return jr(Math.min(s,a,c,d),Math.min(o,l,h,f),Math.max(s,a,c,d),Math.max(o,l,h,f),r)}function JA(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),l=r*o,c=r*a,h=s*o,d=s*a,f=n[0],p=n[1];return[f-l+d,p-c-h,f-l-d,p-c+h,f+l-d,p+c+h,f+l+d,p+c-h,f-l+d,p-c-h]}function Ut(n){return n[3]-n[1]}function Wn(n,e,t){const i=t||kn();return en(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):cd(i),i}function Ns(n){return[n[0],n[3]]}function fd(n){return[n[2],n[3]]}function Re(n){return n[2]-n[0]}function en(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function gd(n){return n[2]<n[0]||n[3]<n[1]}function eP(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function tP(n,e,t){let i=!1;const r=Zg(n,e),s=Zg(n,t);if(r===ft.INTERSECTING||s===ft.INTERSECTING)i=!0;else{const o=n[0],a=n[1],l=n[2],c=n[3],h=e[0],d=e[1],f=t[0],p=t[1],_=(p-d)/(f-h);let w,T;s&ft.ABOVE&&!(r&ft.ABOVE)&&(w=f-(p-c)/_,i=w>=o&&w<=l),!i&&s&ft.RIGHT&&!(r&ft.RIGHT)&&(T=p-(f-l)*_,i=T>=a&&T<=c),!i&&s&ft.BELOW&&!(r&ft.BELOW)&&(w=f-(p-a)/_,i=w>=o&&w<=l),!i&&s&ft.LEFT&&!(r&ft.LEFT)&&(T=p-(f-o)*_,i=T>=a&&T<=c)}return i}function HT(n,e){const t=e.getExtent(),i=Ps(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=Re(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function km(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];HT(n,e);const r=Re(i);if(Re(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Ye(n,e,t){return Math.min(Math.max(n,e),t)}function nP(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const l=((n-t)*o+(e-i)*a)/(o*o+a*a);l>1?(t=r,i=s):l>0&&(t+=o*l,i+=a*l)}return Mo(n,e,t,i)}function Mo(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function iP(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const l=Math.abs(n[a][i]);l>s&&(s=l,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const l=-n[a][i]/n[i][i];for(let c=i;c<e+1;c++)i==c?n[a][c]=0:n[a][c]+=l*n[i][c]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function zc(n){return n*Math.PI/180}function Oo(n,e){const t=n%e;return t*e<0?t+e:t}function dn(n,e,t){return n+t*(e-n)}function Lm(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function dc(n,e){return Math.floor(Lm(n,e))}function fc(n,e){return Math.ceil(Lm(n,e))}function rP(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function yh(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Mm(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function sP(n,e){return n[0]*=e,n[1]*=e,n}function qT(n,e){if(e.canWrapX()){const t=Re(e.getExtent()),i=oP(n,e,t);i&&(n[0]-=i*t)}return n}function oP(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||Re(i),r=Math.floor((n[0]-i[0])/t)),r}const aP=63710088e-1;function mv(n,e,t){t=t||aP;const i=zc(n[1]),r=zc(e[1]),s=(r-i)/2,o=zc(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function YT(...n){console.warn(...n)}let Jg=!0;function ZT(n){Jg=!1}function Om(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function QT(n,e){if(e!==void 0&&n!==e){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];n=e}return n}function lP(n){HA(n.getCode(),n),_h(n,n,Om)}function uP(n){n.forEach(lP)}function Ln(n){return typeof n=="string"?XA(n):n||null}function _v(n,e,t,i){n=Ln(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(e,t);else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=Fm(n,Ln("EPSG:4326"));if(a===QT&&o!=="degrees")r=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=a(c,c,2);const h=mv(c.slice(0,2),c.slice(2,4)),d=mv(c.slice(4,6),c.slice(6,8));r=(h+d)/2}const l=n.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function yv(n){uP(n),n.forEach(function(e){n.forEach(function(t){e!==t&&_h(e,t,Om)})})}function cP(n,e,t,i){n.forEach(function(r){e.forEach(function(s){_h(r,s,t),_h(s,r,i)})})}function Nm(n,e){return n?typeof n=="string"?Ln(n):n:Ln(e)}function hP(n,e){return ZT(),JT(n,"EPSG:4326","EPSG:3857")}function Pf(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||Fm(n,e)===Om)&&t}function Fm(n,e){const t=n.getCode(),i=e.getCode();let r=qA(t,i);return r||(r=QT),r}function vh(n,e){const t=Ln(n),i=Ln(e);return Fm(t,i)}function JT(n,e,t){return vh(e,t)(n,void 0,n.length)}function ep(n,e){return n}function Di(n,e){return Jg&&!yh(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Jg=!1,YT("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function eI(n,e){return n}function Ir(n,e){return n}function dP(){yv(dv),yv(gv),cP(gv,dv,GA,WA)}dP();var su;class fP{constructor(){Vy(this,su,[-4827769166891132e-9,-2484616878317465e-9]);navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{const t=e.coords.latitude,i=e.coords.longitude,r=hP([i,t]);zy(this,su,r)},e=>{console.error("Erro ao obter localização:",e)})}get RotasNome(){return UA}get PosAtual(){return by(this,su)}concatenaAnexo(e,t){let i,r;i=e.map(a=>a[0]).indexOf(t[0][0]),r=e.map(a=>a[0]).indexOf(t[t.length-1][0]);const s=e.slice(0,i),o=e.slice(r+1);return s.push(...t),s.push(...o),s}getRotaByName(e){const t=this.concatenaAnexo(cc,zA),i=this.concatenaAnexo(cc,hv),r=this.concatenaAnexo(i,cv);let s=this.concatenaAnexo(t,hv);switch(s=this.concatenaAnexo(s,cv),e){case"Circular":return s;case"HU-RU Direto":return t;case"Anel Viario":return cc;case"Odonto Direto":return i;case"Odonto-Ich-RU":return r;default:return cc}}}su=new WeakMap;const No=new fP;class Qi{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const Xo={PROPERTYCHANGE:"propertychange"};class pd{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function gP(n,e,t){let i,r;t=t||Vi;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function Vi(n,e){return n>e?1:n<e?-1:0}function bm(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function pP(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function md(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function Qr(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function mP(n,e,t){const i=e||Vi;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function bl(){return!0}function _d(){return!1}function Ho(){}function tI(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!Qr(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function _P(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}class yd extends pd{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Qi(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let c=0,h=r.length;c<h;++c)if("handleEvent"in r[c]?l=r[c].handleEvent(s):l=r[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,Ho);delete o[i]}return l}disposeInternal(){this.listeners_&&fu(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Ho,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}const ue={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function ve(n,e,t,i,r){if(r){const o=t;t=function(){n.removeEventListener(e,t),o.apply(i??this,arguments)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Eh(n,e,t,i){return ve(n,e,t,i,!0)}function Fe(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),fu(n))}class gu extends yd{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ue.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ve(this,e[s],t);return r}return ve(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Eh(this,e[s],t)}else i=Eh(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)yP(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}gu.prototype.on;gu.prototype.once;gu.prototype.un;function yP(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Fe(n[e]);else Fe(n)}function Te(){throw new Error("Unimplemented abstract method.")}let vP=0;function xe(n){return n.ol_uid||(n.ol_uid=String(++vP))}class vv extends Qi{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class yi extends gu{constructor(e){super(),this.on,this.once,this.un,xe(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new vv(i,e,t)),i=Xo.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new vv(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],$o(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const Zt={ADD:"add",REMOVE:"remove"},Ev={LENGTH:"length"};class gc extends Qi{constructor(e,t,i){super(e),this.element=t,this.index=i}}class ui extends yi{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(Ev.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new gc(Zt.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new gc(Zt.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new gc(Zt.REMOVE,r,e)),this.dispatchEvent(new gc(Zt.ADD,t,e))}updateLength_(){this.set(Ev.LENGTH,this.array_.length)}assertUnique_(e,t){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}const Ae={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};function Ie(n,e){if(!n)throw new Error(e)}class nI extends yi{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Ae.OPACITY]=e.opacity!==void 0?e.opacity:1,Ie(typeof t[Ae.OPACITY]=="number","Layer opacity must be a number"),t[Ae.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Ae.Z_INDEX]=e.zIndex,t[Ae.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Ae.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Ae.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Ae.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Ye(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Te()}getLayerStatesArray(e){return Te()}getExtent(){return this.get(Ae.EXTENT)}getMaxResolution(){return this.get(Ae.MAX_RESOLUTION)}getMinResolution(){return this.get(Ae.MIN_RESOLUTION)}getMinZoom(){return this.get(Ae.MIN_ZOOM)}getMaxZoom(){return this.get(Ae.MAX_ZOOM)}getOpacity(){return this.get(Ae.OPACITY)}getSourceState(){return Te()}getVisible(){return this.get(Ae.VISIBLE)}getZIndex(){return this.get(Ae.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Ae.EXTENT,e)}setMaxResolution(e){this.set(Ae.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Ae.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Ae.MAX_ZOOM,e)}setMinZoom(e){this.set(Ae.MIN_ZOOM,e)}setOpacity(e){Ie(typeof e=="number","Layer opacity must be a number"),this.set(Ae.OPACITY,e)}setVisible(e){this.set(Ae.VISIBLE,e)}setZIndex(e){this.set(Ae.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Sn={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Ft={ANIMATING:0,INTERACTING:1},Vn={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},EP=42,Vm=256;function wv(n,e,t){return function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const l=e?0:s[0]*r,c=e?0:s[1]*r,h=a?a[0]:0,d=a?a[1]:0;let f=n[0]+l/2+h,p=n[2]-l/2+h,_=n[1]+c/2+d,w=n[3]-c/2+d;f>p&&(f=(p+f)/2,p=f),_>w&&(_=(w+_)/2,w=_);let T=Ye(i[0],f,p),v=Ye(i[1],_,w);if(o&&t&&r){const y=30*r;T+=-y*Math.log(1+Math.max(0,f-i[0])/y)+y*Math.log(1+Math.max(0,i[0]-p)/y),v+=-y*Math.log(1+Math.max(0,_-i[1])/y)+y*Math.log(1+Math.max(0,i[1]-w)/y)}return[T,v]}}function wP(n){return n}function zm(n,e,t,i){const r=Re(e)/t[0],s=Ut(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Um(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Ye(i,t/2,e*2)}function TP(n,e,t,i){return e=e!==void 0?e:!0,function(r,s,o,a){if(r!==void 0){const l=n[0],c=n[n.length-1],h=t?zm(l,t,o,i):l;if(a)return e?Um(r,h,c):Ye(r,c,h);const d=Math.min(h,r),f=Math.floor(bm(n,d,s));return n[f]>h&&f<n.length-1?n[f+1]:n[f]}}}function IP(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,function(o,a,l,c){if(o!==void 0){const h=r?zm(e,r,l,s):e;if(c)return i?Um(o,h,t):Ye(o,t,h);const d=1e-9,f=Math.ceil(Math.log(e/h)/Math.log(n)-d),p=-a*(.5-d)+.5,_=Math.min(h,o),w=Math.floor(Math.log(e/_)/Math.log(n)+p),T=Math.max(f,w),v=e/Math.pow(n,T);return Ye(v,t,h)}}}function Tv(n,e,t,i,r){return t=t!==void 0?t:!0,function(s,o,a,l){if(s!==void 0){const c=i?zm(n,i,a,r):n;return!t||!l?Ye(s,e,c):Um(s,c,e)}}}function Bm(n){if(n!==void 0)return 0}function Iv(n){if(n!==void 0)return n}function CP(n){const e=2*Math.PI/n;return function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function RP(n){const e=zc(5);return function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t}}function iI(n){return Math.pow(n,3)}function ha(n){return 1-iI(1-n)}function xP(n){return 3*n*n-2*n*n*n}function SP(n){return n}new Array(6);function Hn(){return[1,0,0,1,0,0]}function AP(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Tt(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Xi(n,e,t,i,r,s,o,a){const l=Math.sin(s),c=Math.cos(s);return n[0]=i*c,n[1]=r*l,n[2]=-i*l,n[3]=r*c,n[4]=o*i*c-a*i*l+e,n[5]=o*r*l+a*r*c+t,n}function rI(n,e){const t=PP(e);Ie(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*l-o*a)/t,n[5]=-(i*l-r*a)/t,n}function PP(n){return n[0]*n[3]-n[1]*n[2]}const Cv=[1e6,1e6,1e6,1e6,2,2];function DP(n){return"matrix("+n.map((t,i)=>Math.round(t*Cv[i])/Cv[i]).join(", ")+")"}function Or(n,e,t,i,r,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<t;l+=i){const c=n[l],h=n[l+1];s[a++]=r[0]*c+r[2]*h+r[4],s[a++]=r[1]*c+r[3]*h+r[5];for(let d=2;d<o;d++)s[a++]=n[l+d]}return s&&s.length!=a&&(s.length=a),s}function sI(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),c=s[0],h=s[1];let d=0;for(let f=e;f<t;f+=i){const p=n[f]-c,_=n[f+1]-h;o[d++]=c+p*a-_*l,o[d++]=h+p*l+_*a;for(let w=f+2;w<f+i;++w)o[d++]=n[w]}return o&&o.length!=d&&(o.length=d),o}function kP(n,e,t,i,r,s,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let d=e;d<t;d+=i){const f=n[d]-l,p=n[d+1]-c;a[h++]=l+r*f,a[h++]=c+s*p;for(let _=d+2;_<d+i;++_)a[h++]=n[_]}return a&&a.length!=h&&(a.length=h),a}function LP(n,e,t,i,r,s,o){o=o||[];let a=0;for(let l=e;l<t;l+=i){o[a++]=n[l]+r,o[a++]=n[l+1]+s;for(let c=l+2;c<l+i;++c)o[a++]=n[c]}return o&&o.length!=a&&(o.length=a),o}const Rv=Hn();class MP extends yi{constructor(){super(),this.extent_=kn(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=tI((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Te()}closestPointXY(e,t,i,r){return Te()}containsXY(e,t){const i=this.getClosestPoint([e,t]);return i[0]===e&&i[1]===t}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Te()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&cd(t),this.extentRevision_=this.getRevision()}return eP(this.extent_,e)}rotate(e,t){Te()}scale(e,t,i){Te()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Te()}getType(){return Te()}applyTransform(e){Te()}intersectsExtent(e){return Te()}translate(e,t){Te()}transform(e,t){const i=Ln(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),c=i.getWorldExtent(),h=Ut(c)/Ut(l);return Xi(Rv,c[0],c[3],h,-h,0,0,0),Or(s,0,s.length,a,Rv,o),vh(i,t)(s,o,a)}:vh(i,t);return this.applyTransform(r),this}}class vd extends MP{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Dm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Te()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=xv(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Te()}setLayout(e,t,i){let r;if(e)r=xv(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=OP(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();sI(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=Ps(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();kP(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();LP(i,0,i.length,r,e,t,i),this.changed()}}}function OP(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function xv(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function NP(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Or(i,0,i.length,r,e,t)}function Sv(n,e,t,i,r,s,o){const a=n[e],l=n[e+1],c=n[t]-a,h=n[t+1]-l;let d;if(c===0&&h===0)d=e;else{const f=((r-a)*c+(s-l)*h)/(c*c+h*h);if(f>1)d=t;else if(f>0){for(let p=0;p<i;++p)o[p]=dn(n[e+p],n[t+p],f);o.length=i;return}else d=e}for(let f=0;f<i;++f)o[f]=n[d+f];o.length=i}function jm(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],l=n[e+1],c=Mo(s,o,a,l);c>r&&(r=c),s=a,o=l}return r}function FP(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=jm(n,e,a,i,r),e=a}return r}function Gm(n,e,t,i,r,s,o,a,l,c,h){if(e==t)return c;let d,f;if(r===0){if(f=Mo(o,a,n[e],n[e+1]),f<c){for(d=0;d<i;++d)l[d]=n[e+d];return l.length=i,f}return c}h=h||[NaN,NaN];let p=e+i;for(;p<t;)if(Sv(n,p-i,p,i,o,a,h),f=Mo(o,a,h[0],h[1]),f<c){for(c=f,d=0;d<i;++d)l[d]=h[d];l.length=i,p+=i}else p+=i*Math.max((Math.sqrt(f)-Math.sqrt(c))/r|0,1);if(s&&(Sv(n,t-i,e,i,o,a,h),f=Mo(o,a,h[0],h[1]),f<c)){for(c=f,d=0;d<i;++d)l[d]=h[d];l.length=i}return c}function bP(n,e,t,i,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let d=0,f=t.length;d<f;++d){const p=t[d];c=Gm(n,e,p,i,r,s,o,a,l,c,h),e=p}return c}function VP(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function Wm(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function zP(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=Wm(n,e,t[o],i);r[s++]=l,e=l}return r.length=s,r}function Ed(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,t-i];let h=0;for(;c.length>0;){const d=c.pop(),f=c.pop();let p=0;const _=n[f],w=n[f+1],T=n[d],v=n[d+1];for(let y=f+i;y<d;y+=i){const I=n[y],S=n[y+1],k=nP(I,S,_,w,T,v);k>p&&(h=y,p=k)}p>r&&(l[(h-e)/i]=1,f+i<h&&c.push(f,h),h+i<d&&c.push(h,d))}for(let d=0;d<a;++d)l[d]&&(s[o++]=n[e+d*i],s[o++]=n[e+d*i+1]);return o}function UP(n,e,t,i,r,s,o,a){for(let l=0,c=t.length;l<c;++l){const h=t[l];o=Ed(n,e,h,i,r,s,o),a.push(o),e=h}return o}function cs(n,e){return e*Math.round(n/e)}function BP(n,e,t,i,r,s,o){if(e==t)return o;let a=cs(n[e],r),l=cs(n[e+1],r);e+=i,s[o++]=a,s[o++]=l;let c,h;do if(c=cs(n[e],r),h=cs(n[e+1],r),e+=i,e==t)return s[o++]=c,s[o++]=h,o;while(c==a&&h==l);for(;e<t;){const d=cs(n[e],r),f=cs(n[e+1],r);if(e+=i,d==c&&f==h)continue;const p=c-a,_=h-l,w=d-a,T=f-l;if(p*T==_*w&&(p<0&&w<p||p==w||p>0&&w>p)&&(_<0&&T<_||_==T||_>0&&T>_)){c=d,h=f;continue}s[o++]=c,s[o++]=h,a=c,l=h,c=d,h=f}return s[o++]=c,s[o++]=h,o}function oI(n,e,t,i,r,s,o,a){for(let l=0,c=t.length;l<c;++l){const h=t[l];o=BP(n,e,h,i,r,s,o),a.push(o),e=h}return o}function ps(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function wh(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=ps(n,e,l,i,r[s]),e=l}return r.length=s,r}function Av(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=l.length===1&&l[0]===e?[]:wh(n,e,l,i,r[s]),e=l[l.length-1]}return r.length=s,r}function aI(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let a=0,l=0;for(;e<t;e+=i){const c=n[e]-s,h=n[e+1]-o;r+=l*c-a*h,a=c,l=h}return r/2}function jP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=aI(n,e,a,i),e=a}return r}class Vl extends vd{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Vl(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Pm(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return aI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return ps(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Ed(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Vl(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wm(this.flatCoordinates,0,e,this.stride),this.changed()}}class wd extends vd{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new wd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Mo(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return $T(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return WT(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=VP(this.flatCoordinates,0,e,this.stride),this.changed()}}function GP(n,e,t,i,r){return!XT(r,function(o){return!ms(n,e,t,i,o[0],o[1])})}function ms(n,e,t,i,r,s){let o=0,a=n[t-i],l=n[t-i+1];for(;e<t;e+=i){const c=n[e],h=n[e+1];l<=s?h>s&&(c-a)*(s-l)-(r-a)*(h-l)>0&&o++:h<=s&&(c-a)*(s-l)-(r-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function lI(n,e,t,i,r,s){if(t.length===0||!ms(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(ms(n,t[o-1],t[o],i,r,s))return!1;return!0}function $m(n,e,t,i,r,s,o){let a,l,c,h,d,f,p;const _=r[s+1],w=[];for(let y=0,I=t.length;y<I;++y){const S=t[y];for(h=n[S-i],f=n[S-i+1],a=e;a<S;a+=i)d=n[a],p=n[a+1],(_<=f&&p<=_||f<=_&&_<=p)&&(c=(_-f)/(p-f)*(d-h)+h,w.push(c)),h=d,f=p}let T=NaN,v=-1/0;for(w.sort(Vi),h=w[0],a=1,l=w.length;a<l;++a){d=w[a];const y=Math.abs(d-h);y>v&&(c=(h+d)/2,lI(n,e,t,i,c,_)&&(T=c,v=y)),h=d}return isNaN(T)&&(T=r[s]),o?(o.push(T,_,v),o):[T,_,v]}function WP(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const l=t[o];s=$m(n,e,l,i,r,2*o,s),e=l[l.length-1]}return s}function uI(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function Km(n,e,t,i,r){const s=KT(kn(),n,e,t,i);return en(r,s)?Co(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:uI(n,e,t,i,function(o,a){return tP(r,o,a)}):!1}function cI(n,e,t,i,r){return!!(Km(n,e,t,i,r)||ms(n,e,t,i,r[0],r[1])||ms(n,e,t,i,r[0],r[3])||ms(n,e,t,i,r[2],r[1])||ms(n,e,t,i,r[2],r[3]))}function $P(n,e,t,i,r){if(!cI(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(GP(n,t[s-1],t[s],i,r)&&!Km(n,t[s-1],t[s],i,r))return!1;return!0}function KP(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function Xm(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],l=n[e+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function XP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=Xm(n,e,a,i);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=a}return!0}function Pv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=Xm(n,e,a,i);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&KP(n,e,a,i),e=a}return e}function HP(n,e){const t=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=Xm(n,i,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=l}return t}class zl extends vd{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?md(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new zl(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Pm(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(FP(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bP(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return lI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return jP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Pv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,wh(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Ps(this.getExtent());this.flatInteriorPoint_=$m(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new wd(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Vl(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=new Vl(t.slice(s,l),e);r.push(c),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;XP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Pv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=oI(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new zl(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return $P(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=zP(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function Dv(n){if(gd(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new zl(s,"XY",[s.length])}const Df=0;class ai extends yi{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Nm(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&ZT(),e.center&&(e.center=Di(e.center,this.projection_)),e.extent&&(e.extent=Ir(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in Vn)delete t[a];this.setProperties(t,!0);const i=YP(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=qP(e),s=i.constraint,o=ZP(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Di(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Di(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const h=arguments[r];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(r===t){i&&pc(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;r<t;++r){const h=arguments[r],d={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||xP,callback:i};if(h.center&&(d.sourceCenter=o,d.targetCenter=h.center.slice(),o=d.targetCenter),h.zoom!==void 0?(d.sourceResolution=a,d.targetResolution=this.getResolutionForZoom(h.zoom),a=d.targetResolution):h.resolution&&(d.sourceResolution=a,d.targetResolution=h.resolution,a=d.targetResolution),h.rotation!==void 0){d.sourceRotation=l;const f=Oo(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+f,l=d.targetRotation}QP(d)?d.complete=!0:s+=d.duration,c.push(d)}this.animations_.push(c),this.setHint(Ft.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ft.ANIMATING]>0}getInteracting(){return this.hints_[Ft.INTERACTING]>0}cancelAnimations(){this.setHint(Ft.ANIMATING,-this.hints_[Ft.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&pc(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const d=l.easing(h);if(l.sourceCenter){const f=l.sourceCenter[0],p=l.sourceCenter[1],_=l.targetCenter[0],w=l.targetCenter[1];this.nextCenter_=l.targetCenter;const T=f+d*(_-f),v=p+d*(w-p);this.targetCenter_=[T,v]}if(l.sourceResolution&&l.targetResolution){const f=d===1?l.targetResolution:l.sourceResolution+d*(l.targetResolution-l.sourceResolution);if(l.anchor){const p=this.getViewportSize_(this.getRotation()),_=this.constraints_.resolution(f,0,p,!0);this.targetCenter_=this.calculateCenterZoom(_,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const f=d===1?Oo(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+d*(l.targetRotation-l.sourceRotation);if(l.anchor){const p=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(p,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(Ft.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&pc(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Mm(i,e-this.getRotation()),rP(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&ep(e,this.getProjection())}getCenterInternal(){return this.get(Vn.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return eI(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Ie(t,"The view center is not defined");const i=this.getResolution();Ie(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return Ie(r!==void 0,"The view rotation is not defined"),Qg(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Vn.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Ir(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=Re(e)/t[0],r=Ut(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return function(s){return t/Math.pow(e,s*r)}}getRotation(){return this.get(Vn.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return function(o){return Math.log(i/o)/t/s}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=kf(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=bm(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){var t;if((t=this.resolutions_)!=null&&t.length){if(this.resolutions_.length===1)return this.resolutions_[0];const i=Ye(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(r,Ye(e-i,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(Ie(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Ie(!gd(e),"Cannot fit empty extent provided as `geometry`");const r=Ir(e,this.getProjection());i=Dv(r)}else if(e.getType()==="Circle"){const r=Ir(e.getExtent(),this.getProjection());i=Dv(r),i.rotate(this.getRotation(),Ps(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let d=0,f=s.length;d<f;d+=o){const p=s[d]*i-s[d+1]*r,_=s[d]*r+s[d+1]*i;a=Math.min(a,p),l=Math.min(l,_),c=Math.max(c,p),h=Math.max(h,_)}return[a,l,c,h]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),d=Math.cos(c),f=Ps(a);f[0]+=(r[1]-r[3])/2*l,f[1]+=(r[0]-r[2])/2*l;const p=f[0]*d-f[1]*h,_=f[1]*d+f[0]*h,w=this.getConstrainedCenter([p,_],l),T=t.callback?t.callback:Ho;t.duration!==void 0?this.animateInternal({resolution:l,center:w,duration:t.duration,easing:t.easing},T):(this.targetResolution_=l,this.targetCenter_=w,this.applyTargetState_(!1,!0),pc(T,!0))}centerOn(e,t,i){this.centerOnInternal(Di(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(kf(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),l=kf(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=ep(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Di(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Di(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Di(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Vn.ROTATION)!==r&&this.set(Vn.ROTATION,r),this.get(Vn.RESOLUTION)!==o&&(this.set(Vn.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Vn.CENTER)||!yh(this.get(Vn.CENTER),a))&&this.set(Vn.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!yh(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:ha,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ft.INTERACTING,1)}endInteraction(e,t,i){i=i&&Di(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Ft.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function pc(n,e){setTimeout(function(){n(e)},0)}function qP(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return wv(n.extent,n.constrainOnlyCenter,t)}const e=Nm(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,wv(t,!1,!1)}return wP}function YP(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:Df,a=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,d=n.showFullExtent!==void 0?n.showFullExtent:!1,f=Nm(n.projection,"EPSG:3857"),p=f.getExtent();let _=n.constrainOnlyCenter,w=n.extent;if(!c&&!w&&f.isGlobal()&&(_=!1,w=p),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[a]!==void 0?T[a]:T[T.length-1],n.constrainResolution?e=TP(T,h,!_&&w,d):e=Tv(t,i,h,!_&&w,d)}else{const v=(p?Math.max(Re(p),Ut(p)):360*Sm.degrees/f.getMetersPerUnit())/Vm/Math.pow(2,Df),y=v/Math.pow(2,28-Df);t=n.maxResolution,t!==void 0?o=0:t=v/Math.pow(l,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(l,a):i=v/Math.pow(l,a):i=y),a=o+Math.floor(Math.log(t/i)/Math.log(l)),i=t/Math.pow(l,a-o),n.constrainResolution?e=IP(l,t,i,h,!_&&w,d):e=Tv(t,i,h,!_&&w,d)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:l}}function ZP(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?RP():t===!1?Iv:typeof t=="number"?CP(t):Iv}return Bm}function QP(n){return!(n.sourceCenter&&n.targetCenter&&!yh(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function kf(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,l=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,l+=(t[1]-e[1]/2)*i,o=-o;const c=a*s-l*o,h=l*s+a*o;return[c,h]}class Td extends nI{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Ae.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Ae.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Fe(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=ve(e,ue.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof ai?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;t.layerStatesArray?r=t.layerStatesArray.find(o=>o.layer===this):r=this.getLayerState();const s=this.getExtent();return Hm(r,t.viewState)&&(!s||en(s,t.extent))}getAttributions(e){var s;if(!this.isVisible(e))return[];const t=(s=this.getSource())==null?void 0:s.getAttributions();if(!t)return[];const i=e instanceof ai?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Ae.MAP,e)}getMapInternal(){return this.get(Ae.MAP)}setMap(e){this.mapPrecomposeKey_&&(Fe(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Fe(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=ve(e,Sn.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=ve(this,ue.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);Ie(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(Ae.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function Hm(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}function hI(n,e,t=0,i=n.length-1,r=JP){for(;i>t;){if(i-t>600){const l=i-t+1,c=e-t+1,h=Math.log(l),d=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*d*(l-d)/l)*(c-l/2<0?-1:1),p=Math.max(t,Math.floor(e-c*d/l+f)),_=Math.min(i,Math.floor(e+(l-c)*d/l+f));hI(n,e,p,_,r)}const s=n[e];let o=t,a=i;for(Va(n,t,e),r(n[i],s)>0&&Va(n,t,i);o<a;){for(Va(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?Va(n,t,a):(a++,Va(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function Va(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function JP(n,e){return n<e?-1:n>e?1:0}let dI=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!_c(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],l=t.leaf?r(a):a;_c(e,l)&&(t.leaf?i.push(a):Mf(e,l)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!_c(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(_c(e,o)){if(t.leaf||Mf(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=no([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,l,c;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),i.leaf){const h=e4(e,i.children,t);if(h!==-1)return i.children.splice(h,1),s.push(i),this._condense(s),this}!c&&!i.leaf&&Mf(i,r)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],c=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=no(e.slice(t,i+1)),Hs(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=no([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));kv(e,t,i,c,this.compareMinX);for(let h=t;h<=i;h+=c){const d=Math.min(h+c-1,i);kv(e,h,d,l,this.compareMinY);for(let f=h;f<=d;f+=l){const p=Math.min(f+l-1,d);a.children.push(this._build(e,f,p,r-1))}}return Hs(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=Lf(c),d=i4(e,c)-h;d<o?(o=d,s=h<s?h:s,a=c):d===o&&h<s&&(s=h,a=c)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Xa(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=no(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,Hs(i,this.toBBox),Hs(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=no([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Hs(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const l=Ka(e,0,a,this.toBBox),c=Ka(e,a,i,this.toBBox),h=r4(l,c),d=Lf(l)+Lf(c);h<s?(s=h,r=a,o=d<o?d:o):h===s&&d<o&&(o=d,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:t4,s=e.leaf?this.compareMinY:n4,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Ka(e,0,t,s),a=Ka(e,i-t,i,s);let l=mc(o)+mc(a);for(let c=t;c<i-t;c++){const h=e.children[c];Xa(o,e.leaf?s(h):h),l+=mc(o)}for(let c=i-t-1;c>=t;c--){const h=e.children[c];Xa(a,e.leaf?s(h):h),l+=mc(a)}return l}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Xa(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():Hs(e[t],this.toBBox)}};function e4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function Hs(n,e){Ka(n,0,n.children.length,e,n)}function Ka(n,e,t,i,r){r||(r=no(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Xa(r,n.leaf?i(o):o)}return r}function Xa(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function t4(n,e){return n.minX-e.minX}function n4(n,e){return n.minY-e.minY}function Lf(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function mc(n){return n.maxX-n.minX+(n.maxY-n.minY)}function i4(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function r4(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function Mf(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function _c(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function no(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function kv(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;hI(n,o,e,t,r),s.push(e,o,o,t)}}const de={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Lv(n){return n[0]>0&&n[1]>0}function s4(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function rn(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Id{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=rn(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Id({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Te()}getImage(e){return Te()}getHitDetectionImage(){return Te()}getPixelRatio(e){return 1}getImageState(){return Te()}getImageSize(){return Te()}getOrigin(){return Te()}getSize(){return Te()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=rn(e)}listenImageChange(e){Te()}load(){Te()}unlistenImageChange(e){Te()}ready(){return Promise.resolve()}}const Ul={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var Rt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};Rt.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};Rt.max=Rt.whitepoint[2].D65;Rt.rgb=function(n,e){e=e||Rt.whitepoint[2].E;var t=n[0]/e[0],i=n[1]/e[1],r=n[2]/e[2],s,o,a;return s=t*3.240969941904521+i*-1.537383177570093+r*-.498610760293,o=t*-.96924363628087+i*1.87596750150772+r*.041555057407175,a=t*.055630079696993+i*-.20397695888897+r*1.056971514242878,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s=s*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),[s*255,o*255,a*255]};Ul.xyz=function(n,e){var t=n[0]/255,i=n[1]/255,r=n[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var s=t*.41239079926595+i*.35758433938387+r*.18048078840183,o=t*.21263900587151+i*.71516867876775+r*.072192315360733,a=t*.019330818715591+i*.11919477979462+r*.95053215224966;return e=e||Rt.whitepoint[2].E,[s*e[0],o*e[1],a*e[2]]};const qm={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(n,e,t){var i,r,s,o,a,l,c,h,d,f,p,_,w;if(s=n[0],o=n[1],a=n[2],s===0)return[0,0,0];var T=.0011070564598794539;return e=e||"D65",t=t||2,d=Rt.whitepoint[t][e][0],f=Rt.whitepoint[t][e][1],p=Rt.whitepoint[t][e][2],_=4*d/(d+15*f+3*p),w=9*f/(d+15*f+3*p),i=o/(13*s)+_||0,r=a/(13*s)+w||0,c=s>8?f*Math.pow((s+16)/116,3):f*s*T,l=c*9*i/(4*r)||0,h=c*(12-3*i-20*r)/(4*r)||0,[l,c,h]}};Rt.luv=function(n,e,t){var i,r,s,o,a,l,c,h,d,f,p,_,w,T=.008856451679035631,v=903.2962962962961;e=e||"D65",t=t||2,d=Rt.whitepoint[t][e][0],f=Rt.whitepoint[t][e][1],p=Rt.whitepoint[t][e][2],_=4*d/(d+15*f+3*p),w=9*f/(d+15*f+3*p),l=n[0],c=n[1],h=n[2],i=4*l/(l+15*c+3*h)||0,r=9*c/(l+15*c+3*h)||0;var y=c/f;return s=y<=T?v*y:116*Math.pow(y,1/3)-16,o=13*s*(i-_),a=13*s*(r-w),[s,o,a]};var fI={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(n){var e=n[0],t=n[1],i=n[2],r,s,o;return o=i/360*2*Math.PI,r=t*Math.cos(o),s=t*Math.sin(o),[e,r,s]},xyz:function(n){return qm.xyz(fI.luv(n))}};qm.lchuv=function(n){var e=n[0],t=n[1],i=n[2],r=Math.sqrt(t*t+i*i),s=Math.atan2(i,t),o=s*360/2/Math.PI;return o<0&&(o+=360),[e,r,o]};Rt.lchuv=function(n){return qm.lchuv(Rt.luv(n))};const Mv={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var Ov={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function o4(n){var h,d;var e,t=[],i=1,r;if(typeof n=="number")return{space:"rgb",values:[n>>>16,(n&65280)>>>8,n&255],alpha:1};if(typeof n=="number")return{space:"rgb",values:[n>>>16,(n&65280)>>>8,n&255],alpha:1};if(n=String(n).toLowerCase(),Mv[n])t=Mv[n].slice(),r="rgb";else if(n==="transparent")i=0,r="rgb",t=[0,0,0];else if(n[0]==="#"){var s=n.slice(1),o=s.length,a=o<=4;i=1,a?(t=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],o===4&&(i=parseInt(s[3]+s[3],16)/255)):(t=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],o===8&&(i=parseInt(s[6]+s[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),r="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(n)){var l=e[1];r=l.replace(/a$/,"");var c=r==="cmyk"?4:r==="gray"?1:3;t=e[2].trim().split(/\s*[,\/]\s*|\s+/),r==="color"&&(r=t.shift()),t=t.map(function(f,p){if(f[f.length-1]==="%")return f=parseFloat(f)/100,p===3?f:r==="rgb"?f*255:r[0]==="h"||r[0]==="l"&&!p?f*100:r==="lab"?f*125:r==="lch"?p<2?f*150:f*360:r[0]==="o"&&!p?f:r==="oklab"?f*.4:r==="oklch"?p<2?f*.4:f*360:f;if(r[p]==="h"||p===2&&r[r.length-1]==="h"){if(Ov[f]!==void 0)return Ov[f];if(f.endsWith("deg"))return parseFloat(f);if(f.endsWith("turn"))return parseFloat(f)*360;if(f.endsWith("grad"))return parseFloat(f)*360/400;if(f.endsWith("rad"))return parseFloat(f)*180/Math.PI}return f==="none"?0:parseFloat(f)}),i=t.length>c?t.pop():1}else/[0-9](?:\s|\/|,)/.test(n)&&(t=n.match(/([0-9]+)/g).map(function(f){return parseFloat(f)}),r=((d=(h=n.match(/([a-z])/ig))==null?void 0:h.join(""))==null?void 0:d.toLowerCase())||"rgb");return{space:r,values:t,alpha:i}}const Of={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(n){var e=n[0]/360,t=n[1]/100,i=n[2]/100,r,s,o,a,l,c=0;if(t===0)return l=i*255,[l,l,l];for(s=i<.5?i*(1+t):i+t-i*t,r=2*i-s,a=[0,0,0];c<3;)o=e+1/3*-(c-1),o<0?o++:o>1&&o--,l=6*o<1?r+(s-r)*6*o:2*o<1?s:3*o<2?r+(s-r)*(2/3-o)*6:r,a[c++]=l*255;return a}};Ul.hsl=function(n){var e=n[0]/255,t=n[1]/255,i=n[2]/255,r=Math.min(e,t,i),s=Math.max(e,t,i),o=s-r,a,l,c;return s===r?a=0:e===s?a=(t-i)/o:t===s?a=2+(i-e)/o:i===s&&(a=4+(e-t)/o),a=Math.min(a*60,360),a<0&&(a+=360),c=(r+s)/2,s===r?l=0:c<=.5?l=o/(s+r):l=o/(2-s-r),[a,l*100,c*100]};function a4(n){Array.isArray(n)&&n.raw&&(n=String.raw(...arguments)),n instanceof Number&&(n=+n);var e,t=o4(n);if(!t.space)return[];const i=t.space[0]==="h"?Of.min:Ul.min,r=t.space[0]==="h"?Of.max:Ul.max;return e=Array(3),e[0]=Math.min(Math.max(t.values[0],i[0]),r[0]),e[1]=Math.min(Math.max(t.values[1],i[1]),r[1]),e[2]=Math.min(Math.max(t.values[2],i[2]),r[2]),t.space[0]==="h"&&(e=Of.rgb(e)),e.push(Math.min(Math.max(t.alpha,0),1)),e}const Ym=[NaN,NaN,NaN,0];function l4(n){return typeof n=="string"?n:Qm(n)}const u4=1024,za={};let Nf=0;function c4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function Nv(n){const e=Rt.lchuv(Ul.xyz(n));return e[3]=n[3],e}function h4(n){const e=Rt.rgb(fI.xyz(n));return e[3]=n[3],e}function Zm(n){if(n==="none")return Ym;if(za.hasOwnProperty(n))return za[n];if(Nf>=u4){let t=0;for(const i in za)t++&3||(delete za[i],--Nf)}const e=a4(n);if(e.length!==4)throw new Error('failed to parse "'+n+'" as color');for(const t of e)if(isNaN(t))throw new Error('failed to parse "'+n+'" as color');return gI(e),za[n]=e,++Nf,e}function Bl(n){return Array.isArray(n)?n:Zm(n)}function gI(n){return n[0]=Ye(n[0]+.5|0,0,255),n[1]=Ye(n[1]+.5|0,0,255),n[2]=Ye(n[2]+.5|0,0,255),n[3]=Ye(n[3],0,1),n}function Qm(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}const Gr=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",d4=Gr.includes("firefox"),f4=Gr.includes("safari")&&!Gr.includes("chrom");f4&&(Gr.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Gr));const g4=Gr.includes("webkit")&&!Gr.includes("edge"),pI=Gr.includes("macintosh"),mI=typeof devicePixelRatio<"u"?devicePixelRatio:1,_I=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,yI=typeof Image<"u"&&Image.prototype.decode,vI=function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n}();function et(n,e,t,i){let r;return t&&t.length?r=t.shift():_I?r=new OffscreenCanvas(n||300,e||300):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let Ff;function Th(){return Ff||(Ff=et(1,1)),Ff}function qo(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function Fv(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function p4(n){for(;n.lastChild;)n.lastChild.remove()}function m4(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function _4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[Eh(i,ue.LOAD,function(){o=!0,s||e()})];return i.src&&yI?(s=!0,i.decode().then(function(){r&&e()}).catch(function(l){r&&(o?e():t())})):a.push(Eh(i,ue.ERROR,t)),function(){r=!1,a.forEach(Fe)}}function y4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function v4(n,e){return e&&(n.src=e),n.src&&yI?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):y4(n)}class E4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];!(e++&3)&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=bf(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=bf(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=bf(e,t,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===de.IDLE&&r.load(),r.getImageState()===de.LOADING?r.ready().then(()=>{this.patternCache_[o]=Th().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Th().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function bf(n,e,t){const i=t?Bl(t):"null";return e+":"+n+":"+i}const ci=new E4;let Ua=null;class w4 extends yd{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?de.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===de.LOADED){Ua||(Ua=et(1,1,void 0,{willReadFrequently:!0})),Ua.drawImage(this.image_,0,0);try{Ua.getImageData(0,0,1,1),this.tainted_=!1}catch{Ua=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ue.CHANGE)}handleImageError_(){this.imageState_=de.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=de.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=et(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===de.IDLE){this.image_||this.initializeImage_(),this.imageState_=de.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&v4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==de.LOADED)return;const t=this.image_,i=et(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=l4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===de.LOADED||this.imageState_===de.ERROR)e();else{const t=()=>{(this.imageState_===de.LOADED||this.imageState_===de.ERROR)&&(this.removeEventListener(ue.CHANGE,t),e())};this.addEventListener(ue.CHANGE,t)}})),this.ready_}}function Jm(n,e,t,i,r,s){let o=e===void 0?void 0:ci.get(e,t,r);return o||(o=new w4(n,n&&"src"in n?n.src||void 0:e,t,i,r),ci.set(e,t,r,o,s)),s&&o&&!ci.getPattern(e,t,r)&&ci.set(e,t,r,o,s),o}function hi(n){return n?Array.isArray(n)?Qm(n):typeof n=="object"&&"src"in n?T4(n):n:null}function T4(n){if(!n.offset||!n.size)return ci.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=ci.getPattern(e,void 0,n.color);if(t)return t;const i=ci.get(n.src,"anonymous",null);if(i.getImageState()!==de.LOADED)return null;const r=et(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Jm(r.canvas,e,void 0,de.LOADED,n.color,!0),ci.getPattern(e,void 0,n.color)}const yc="ol-hidden",Cd="ol-unselectable",e_="ol-control",bv="ol-collapsed",I4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Vv=["style","variant","weight","size","lineHeight","family"],EI=function(n){const e=n.match(I4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,r=Vv.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[Vv[i]]=s)}return t.families=t.family.split(/,\s?/),t},wI="10px sans-serif",Qt="#000",Yo="round",zi=[],Ui=0,Zo="round",jl=10,Gl="#000",Wl="center",Ih="middle",_s=[0,0,0,0],$l=1,ki=new yi;let io=null,tp;const np={},C4=function(){const e="32px ",t=["monospace","serif"],i=t.length,r="wmytzilWMYTZIL@#/&?$%10";let s,o;function a(c,h,d){let f=!0;for(let p=0;p<i;++p){const _=t[p];if(o=Ch(c+" "+h+" "+e+_,r),d!=_){const w=Ch(c+" "+h+" "+e+d+","+_,r);f=f&&w!=o}}return!!f}function l(){let c=!0;const h=ki.getKeys();for(let d=0,f=h.length;d<f;++d){const p=h[d];if(ki.get(p)<100){const[_,w,T]=p.split(`
`);a(_,w,T)?(fu(np),io=null,tp=void 0,ki.set(p,100)):(ki.set(p,ki.get(p)+1,!0),c=!1)}}c&&(clearInterval(s),s=void 0)}return function(c){const h=EI(c);if(!h)return;const d=h.families;for(let f=0,p=d.length;f<p;++f){const _=d[f],w=h.style+`
`+h.weight+`
`+_;ki.get(w)===void 0&&(ki.set(w,100,!0),a(h.style,h.weight,_)||(ki.set(w,0,!0),s===void 0&&(s=setInterval(l,32))))}}}(),R4=function(){let n;return function(e){let t=np[e];if(t==null){if(_I){const i=EI(e),r=TI(e,"Žg");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);np[e]=t}return t}}();function TI(n,e){return io||(io=et(1,1)),n!=tp&&(io.font=n,tp=io.font),io.measureText(e)}function Ch(n,e){return TI(n,e).width}function zv(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Ch(n,s)),0);return t[e]=i,i}function x4(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const d=e[c];if(d===`
`||c===h){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const f=e[c+1]||n.font,p=Ch(f,d);t.push(p),o+=p;const _=R4(f);i.push(_),l=Math.max(l,_)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function S4(n,e,t,i,r,s,o,a,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=d=>d.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),A4(i,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,l,c,o*h[0],a*h[1]),n.restore()}function A4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class Rd extends Id{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?de.LOADING:de.LOADED,this.imageState_===de.LOADING&&this.ready().then(()=>this.imageState_=de.LOADED),this.render()}clone(){const e=this.getScale(),t=new Rd({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){let t=this.canvases_[e];if(!t){const i=this.renderOptions_,r=et(i.size*e,i.size*e);this.draw_(i,r,e),t=r.canvas,this.canvases_[e]=t}return t}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const O=r;r=s,s=O}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),h=r-c,d=Math.sqrt(l*l+h*h),f=d/l;if(e==="miter"&&f<=i)return f*t;const p=t/2/f,_=t/2*(h/d),T=Math.sqrt((r+p)*(r+p)+_*_)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const v=r*Math.sin(a),y=Math.sqrt(r*r-v*v),I=s-y,k=Math.sqrt(v*v+I*I)/v;if(k<=i){const O=k*t/2-s-r;return 2*Math.max(T,O)}return T*2}createRenderOptions(){let e=Yo,t=Zo,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=hi(this.stroke_.getColor()??Gl),a=this.stroke_.getWidth()??$l,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??Zo,e=this.stroke_.getLineCap()??Yo,i=this.stroke_.getMiterLimit()??jl);const l=this.calculateLineJoinSize_(t,a,i),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=Qt),t.fillStyle=hi(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=Bl(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=et(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const l=s+a*o,c=a%2===0?i:r;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Qt,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class xd extends Rd{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new xd({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class pu{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new pu({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Jm(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===de.IDLE&&t.load(),t.getImageState()===de.LOADING&&(this.patternImage_=t)}this.color_=e}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class mu{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new mu({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}class Bi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=Uv,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Bi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=Uv,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function P4(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Ie(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let Vf=null;function II(n,e){if(!Vf){const t=new pu({color:"rgba(255,255,255,0.4)"}),i=new mu({color:"#3399CC",width:1.25});Vf=[new Bi({image:new xd({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return Vf}function Uv(n){return n.getGeometry()}function Bv(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}class _u extends Id{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;Ie(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||xe(o)),Ie(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Ie(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=de.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?de.LOADED:de.IDLE:l=de.LOADING:l=de.LOADED),this.color_=e.color!==void 0?Bl(e.color):null,this.iconImage_=Jm(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const d=this.getImage(1);if(d.width&&d.height)c=d.width,h=d.height;else if(d instanceof HTMLImageElement){this.initialOptions_=e;const f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;const p=this.iconImage_.getSize();this.setScale(Bv(p[0],p[1],e.width,e.height))};this.listenImageChange(f);return}}c!==void 0&&this.setScale(Bv(c,h,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new _u({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==de.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==de.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(ue.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(ue.CHANGE,e)}ready(){return this.iconImage_.ready()}}const D4="#333";class t_{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=rn(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new pu({color:D4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new t_({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=rn(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}let Fs=0;const Wt=1<<Fs++,pe=1<<Fs++,Jt=1<<Fs++,Gn=1<<Fs++,Ds=1<<Fs++,Ha=1<<Fs++,vc=Math.pow(2,Fs)-1,n_={[Wt]:"boolean",[pe]:"number",[Jt]:"string",[Gn]:"color",[Ds]:"number[]",[Ha]:"size"},k4=Object.keys(n_).map(Number).sort(Vi);function L4(n){return n in n_}function qa(n){const e=[];for(const t of k4)Ya(n,t)&&e.push(n_[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Ya(n,e){return(n&e)===e}function lr(n,e){return n===e}class ot{constructor(e,t){if(!L4(e))throw new Error(`literal expressions must have a specific type, got ${qa(e)}`);this.type=e,this.value=t}}class M4{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function CI(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1}}function xt(n,e,t){switch(typeof n){case"boolean":{if(lr(e,Jt))return new ot(Jt,n?"true":"false");if(!Ya(e,Wt))throw new Error(`got a boolean, but expected ${qa(e)}`);return new ot(Wt,n)}case"number":{if(lr(e,Ha))return new ot(Ha,rn(n));if(lr(e,Wt))return new ot(Wt,!!n);if(lr(e,Jt))return new ot(Jt,n.toString());if(!Ya(e,pe))throw new Error(`got a number, but expected ${qa(e)}`);return new ot(pe,n)}case"string":{if(lr(e,Gn))return new ot(Gn,Zm(n));if(lr(e,Wt))return new ot(Wt,!!n);if(!Ya(e,Jt))throw new Error(`got a string, but expected ${qa(e)}`);return new ot(Jt,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return W4(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(lr(e,Ha)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new ot(Ha,n)}if(lr(e,Gn)){if(n.length===3)return new ot(Gn,[...n,1]);if(n.length===4)return new ot(Gn,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Ya(e,Ds))throw new Error(`got an array of numbers, but expected ${qa(e)}`);return new ot(Ds,n)}const F={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},O4={[F.Get]:se(ce(1,1/0),jv),[F.Var]:se(ce(1,1),N4),[F.Has]:se(ce(1,1/0),jv),[F.Id]:se(F4,qs),[F.Concat]:se(ce(2,1/0),Ce(Jt)),[F.GeometryType]:se(b4,qs),[F.LineMetric]:se(qs),[F.Resolution]:se(qs),[F.Zoom]:se(qs),[F.Time]:se(qs),[F.Any]:se(ce(2,1/0),Ce(Wt)),[F.All]:se(ce(2,1/0),Ce(Wt)),[F.Not]:se(ce(1,1),Ce(Wt)),[F.Equal]:se(ce(2,2),Ce(vc)),[F.NotEqual]:se(ce(2,2),Ce(vc)),[F.GreaterThan]:se(ce(2,2),Ce(pe)),[F.GreaterThanOrEqualTo]:se(ce(2,2),Ce(pe)),[F.LessThan]:se(ce(2,2),Ce(pe)),[F.LessThanOrEqualTo]:se(ce(2,2),Ce(pe)),[F.Multiply]:se(ce(2,1/0),Gv),[F.Coalesce]:se(ce(2,1/0),Gv),[F.Divide]:se(ce(2,2),Ce(pe)),[F.Add]:se(ce(2,1/0),Ce(pe)),[F.Subtract]:se(ce(2,2),Ce(pe)),[F.Clamp]:se(ce(3,3),Ce(pe)),[F.Mod]:se(ce(2,2),Ce(pe)),[F.Pow]:se(ce(2,2),Ce(pe)),[F.Abs]:se(ce(1,1),Ce(pe)),[F.Floor]:se(ce(1,1),Ce(pe)),[F.Ceil]:se(ce(1,1),Ce(pe)),[F.Round]:se(ce(1,1),Ce(pe)),[F.Sin]:se(ce(1,1),Ce(pe)),[F.Cos]:se(ce(1,1),Ce(pe)),[F.Atan]:se(ce(1,2),Ce(pe)),[F.Sqrt]:se(ce(1,1),Ce(pe)),[F.Match]:se(ce(4,1/0),Wv,z4),[F.Between]:se(ce(3,3),Ce(pe)),[F.Interpolate]:se(ce(6,1/0),Wv,U4),[F.Case]:se(ce(3,1/0),V4,B4),[F.In]:se(ce(2,2),j4),[F.Number]:se(ce(1,1/0),Ce(vc)),[F.String]:se(ce(1,1/0),Ce(vc)),[F.Array]:se(ce(1,1/0),Ce(pe)),[F.Color]:se(ce(1,4),Ce(pe)),[F.Band]:se(ce(1,3),Ce(pe)),[F.Palette]:se(ce(2,2),G4),[F.ToString]:se(ce(1,1),Ce(Wt|pe|Jt|Gn))};function jv(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new ot(pe,o);break}case"string":{r[s]=new ot(Jt,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function N4(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new ot(Jt,i)]}function F4(n,e,t){t.featureId=!0}function b4(n,e,t){t.geometryType=!0}function qs(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function ce(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>e){const a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function Gv(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=xt(n[s+1],e,t);r[s]=o}return r}function Ce(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=xt(e[o+1],n,i);s[o]=a}return s}}function V4(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function Wv(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function z4(n,e,t){const i=n.length-1,r=Jt|pe|Wt,s=xt(n[1],r,t),o=xt(n[n.length-1],e,t),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const c=xt(n[l+2],s.type,t);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=xt(n[l+3],o.type,t);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function U4(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new ot(pe,r);let o;try{o=xt(n[2],pe,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(n.length-3);for(let l=0;l<a.length;l+=2){try{const c=xt(n[l+3],pe,t);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=xt(n[l+4],e,t);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function B4(n,e,t){const i=xt(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=xt(n[s+1],Wt,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=xt(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function j4(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Jt}else r=pe;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const l=xt(i[a],r,t);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[xt(n[1],r,t),...s]}function G4(n,e,t){let i;try{i=xt(n[1],pe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=xt(r[o],Gn,t)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof ot))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function se(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const a=n[o](e,t,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new M4(t,r,...s)}}function W4(n,e,t){const i=n[0],r=O4[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function RI(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return RI(n.getGeometries()[0]);default:return""}}function xI(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ji(n,e,t){const i=xt(n,e,t);return Yn(i)}function Yn(n,e){if(n instanceof ot){if(n.type===Gn&&typeof n.value=="string"){const i=Zm(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case F.Number:case F.String:case F.Coalesce:return $4(n);case F.Get:case F.Var:case F.Has:return K4(n);case F.Id:return i=>i.featureId;case F.GeometryType:return i=>i.geometryType;case F.Concat:{const i=n.args.map(r=>Yn(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case F.Resolution:return i=>i.resolution;case F.Any:case F.All:case F.Between:case F.In:case F.Not:return H4(n);case F.Equal:case F.NotEqual:case F.LessThan:case F.LessThanOrEqualTo:case F.GreaterThan:case F.GreaterThanOrEqualTo:return X4(n);case F.Multiply:case F.Divide:case F.Add:case F.Subtract:case F.Clamp:case F.Mod:case F.Pow:case F.Abs:case F.Floor:case F.Ceil:case F.Round:case F.Sin:case F.Cos:case F.Atan:case F.Sqrt:return q4(n);case F.Case:return Y4(n);case F.Match:return Z4(n);case F.Interpolate:return Q4(n);case F.ToString:return J4(n);default:throw new Error(`Unsupported operator ${t}`)}}function $4(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yn(n.args[s]);switch(t){case F.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case F.Number:case F.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function K4(n,e){const i=n.args[0].value;switch(n.operator){case F.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;o=o[h]}return o};case F.Var:return r=>r.variables[i];case F.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;if(!o||!Object.hasOwn(o,h))return!1;o=o[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function X4(n,e){const t=n.operator,i=Yn(n.args[0]),r=Yn(n.args[1]);switch(t){case F.Equal:return s=>i(s)===r(s);case F.NotEqual:return s=>i(s)!==r(s);case F.LessThan:return s=>i(s)<r(s);case F.LessThanOrEqualTo:return s=>i(s)<=r(s);case F.GreaterThan:return s=>i(s)>r(s);case F.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function H4(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yn(n.args[s]);switch(t){case F.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case F.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case F.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case F.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case F.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function q4(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yn(n.args[s]);switch(t){case F.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case F.Divide:return s=>r[0](s)/r[1](s);case F.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case F.Subtract:return s=>r[0](s)-r[1](s);case F.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case F.Mod:return s=>r[0](s)%r[1](s);case F.Pow:return s=>Math.pow(r[0](s),r[1](s));case F.Abs:return s=>Math.abs(r[0](s));case F.Floor:return s=>Math.floor(r[0](s));case F.Ceil:return s=>Math.ceil(r[0](s));case F.Round:return s=>Math.round(r[0](s));case F.Sin:return s=>Math.sin(r[0](s));case F.Cos:return s=>Math.cos(r[0](s));case F.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case F.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function Y4(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yn(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function Z4(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yn(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function Q4(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yn(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,l;for(let c=2;c<t;c+=2){const h=i[c](r);let d=i[c+1](r);const f=Array.isArray(d);if(f&&(d=c4(d)),h>=o)return c===2?d:f?eD(s,o,a,l,h,d):Za(s,o,a,l,h,d);a=h,l=d}return l}}function J4(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yn(n.args[s]);switch(t){case F.ToString:return s=>{const o=r[0](s);return n.args[0].type===Gn?Qm(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Za(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const a=e-t,l=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+l*(s-i)}function eD(n,e,t,i,r,s){if(r-t===0)return i;const a=Nv(i),l=Nv(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const h=[Za(n,e,t,a[0],r,l[0]),Za(n,e,t,a[1],r,l[1]),a[2]+Za(n,e,t,0,r,c),Za(n,e,t,i[3],r,s[3])];return gI(h4(h))}function tD(n){return!0}function nD(n){const e=CI(),t=iD(n,e),i=xI();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=RI(r.getGeometry())),t(i)}}function $v(n){const e=CI(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=ip(n[o],e);const r=xI(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const c=o.getId();c!==void 0?r.featureId=c:r.featureId=null}let l=0;for(let c=0;c<t;++c){const h=i[c](r);h&&(s[l]=h,l+=1)}return s.length=l,s}}function iD(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Ji(s.filter,Wt,e):tD;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=ip(s.style[c],e)}else a=[ip(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const l=i[a].filter;if(l(r)&&!(n[a].else&&o)){o=!0;for(const c of i[a].styles){const h=c(r);h&&s.push(h)}}}return s}}function ip(n,e){const t=Kl(n,"",e),i=Xl(n,"",e),r=rD(n,e),s=sD(n,e),o=tn(n,"z-index",e);if(!t&&!i&&!r&&!s&&!$o(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Bi;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),a.setFill(h)}if(i){const h=i(l);h&&(c=!1),a.setStroke(h)}if(r){const h=r(l);h&&(c=!1),a.setText(h)}if(s){const h=s(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function Kl(n,e,t){let i;if(e+"fill-pattern-src"in n)i=uD(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=i_(n,e+"fill-color",t)}if(!i)return null;const r=new pu;return function(s){const o=i(s);return o===Ym?null:(r.setColor(o),r)}}function Xl(n,e,t){const i=tn(n,e+"stroke-width",t),r=i_(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Oi(n,e+"stroke-line-cap",t),o=Oi(n,e+"stroke-line-join",t),a=SI(n,e+"stroke-line-dash",t),l=tn(n,e+"stroke-line-dash-offset",t),c=tn(n,e+"stroke-miter-limit",t),h=new mu;return function(d){if(r){const f=r(d);if(f===Ym)return null;h.setColor(f)}if(i&&h.setWidth(i(d)),s){const f=s(d);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(f)}if(o){const f=o(d);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(f)}return a&&h.setLineDash(a(d)),l&&h.setLineDashOffset(l(d)),c&&h.setMiterLimit(c(d)),h}}function rD(n,e){const t="text-",i=Oi(n,t+"value",e);if(!i)return null;const r=Kl(n,t,e),s=Kl(n,t+"background-",e),o=Xl(n,t,e),a=Xl(n,t+"background-",e),l=Oi(n,t+"font",e),c=tn(n,t+"max-angle",e),h=tn(n,t+"offset-x",e),d=tn(n,t+"offset-y",e),f=Hl(n,t+"overflow",e),p=Oi(n,t+"placement",e),_=tn(n,t+"repeat",e),w=Sd(n,t+"scale",e),T=Hl(n,t+"rotate-with-view",e),v=tn(n,t+"rotation",e),y=Oi(n,t+"align",e),I=Oi(n,t+"justify",e),S=Oi(n,t+"baseline",e),k=SI(n,t+"padding",e),O=Ad(n,t+"declutter-mode"),C=new t_({declutterMode:O});return function(E){if(C.setText(i(E)),r&&C.setFill(r(E)),s&&C.setBackgroundFill(s(E)),o&&C.setStroke(o(E)),a&&C.setBackgroundStroke(a(E)),l&&C.setFont(l(E)),c&&C.setMaxAngle(c(E)),h&&C.setOffsetX(h(E)),d&&C.setOffsetY(d(E)),f&&C.setOverflow(f(E)),p){const R=p(E);if(R!=="point"&&R!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(R)}if(_&&C.setRepeat(_(E)),w&&C.setScale(w(E)),T&&C.setRotateWithView(T(E)),v&&C.setRotation(v(E)),y){const R=y(E);if(R!=="left"&&R!=="center"&&R!=="right"&&R!=="end"&&R!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(R)}if(I){const R=I(E);if(R!=="left"&&R!=="right"&&R!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(R)}if(S){const R=S(E);if(R!=="bottom"&&R!=="top"&&R!=="middle"&&R!=="alphabetic"&&R!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(R)}return k&&C.setPadding(k(E)),C}}function sD(n,e){return"icon-src"in n?oD(n,e):"shape-points"in n?aD(n,e):"circle-radius"in n?lD(n,e):null}function oD(n,e){const t="icon-",i=t+"src",r=AI(n[i],i),s=Rh(n,t+"anchor",e),o=Sd(n,t+"scale",e),a=tn(n,t+"opacity",e),l=Rh(n,t+"displacement",e),c=tn(n,t+"rotation",e),h=Hl(n,t+"rotate-with-view",e),d=Xv(n,t+"anchor-origin"),f=Hv(n,t+"anchor-x-units"),p=Hv(n,t+"anchor-y-units"),_=fD(n,t+"color"),w=hD(n,t+"cross-origin"),T=dD(n,t+"offset"),v=Xv(n,t+"offset-origin"),y=xh(n,t+"width"),I=xh(n,t+"height"),S=cD(n,t+"size"),k=Ad(n,t+"declutter-mode"),O=new _u({src:r,anchorOrigin:d,anchorXUnits:f,anchorYUnits:p,color:_,crossOrigin:w,offset:T,offsetOrigin:v,height:I,width:y,size:S,declutterMode:k});return function(C){return a&&O.setOpacity(a(C)),l&&O.setDisplacement(l(C)),c&&O.setRotation(c(C)),h&&O.setRotateWithView(h(C)),o&&O.setScale(o(C)),s&&O.setAnchor(s(C)),O}}function aD(n,e){const t="shape-",i=t+"points",r=t+"radius",s=rp(n[i],i),o=rp(n[r],r),a=Kl(n,t,e),l=Xl(n,t,e),c=Sd(n,t+"scale",e),h=Rh(n,t+"displacement",e),d=tn(n,t+"rotation",e),f=Hl(n,t+"rotate-with-view",e),p=xh(n,t+"radius2"),_=xh(n,t+"angle"),w=Ad(n,t+"declutter-mode"),T=new Rd({points:s,radius:o,radius2:p,angle:_,declutterMode:w});return function(v){return a&&T.setFill(a(v)),l&&T.setStroke(l(v)),h&&T.setDisplacement(h(v)),d&&T.setRotation(d(v)),f&&T.setRotateWithView(f(v)),c&&T.setScale(c(v)),T}}function lD(n,e){const t="circle-",i=Kl(n,t,e),r=Xl(n,t,e),s=tn(n,t+"radius",e),o=Sd(n,t+"scale",e),a=Rh(n,t+"displacement",e),l=tn(n,t+"rotation",e),c=Hl(n,t+"rotate-with-view",e),h=Ad(n,t+"declutter-mode"),d=new xd({radius:5,declutterMode:h});return function(f){return s&&d.setRadius(s(f)),i&&d.setFill(i(f)),r&&d.setStroke(r(f)),a&&d.setDisplacement(a(f)),l&&d.setRotation(l(f)),c&&d.setRotateWithView(c(f)),o&&d.setScale(o(f)),d}}function tn(n,e,t){if(!(e in n))return;const i=Ji(n[e],pe,t);return function(r){return rp(i(r),e)}}function Oi(n,e,t){if(!(e in n))return null;const i=Ji(n[e],Jt,t);return function(r){return AI(i(r),e)}}function uD(n,e,t){const i=Oi(n,e+"pattern-src",t),r=Kv(n,e+"pattern-offset",t),s=Kv(n,e+"pattern-size",t),o=i_(n,e+"color",t);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function Hl(n,e,t){if(!(e in n))return null;const i=Ji(n[e],Wt,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function i_(n,e,t){if(!(e in n))return null;const i=Ji(n[e],Gn,t);return function(r){return PI(i(r),e)}}function SI(n,e,t){if(!(e in n))return null;const i=Ji(n[e],Ds,t);return function(r){return yu(i(r),e)}}function Rh(n,e,t){if(!(e in n))return null;const i=Ji(n[e],Ds,t);return function(r){const s=yu(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function Kv(n,e,t){if(!(e in n))return null;const i=Ji(n[e],Ds,t);return function(r){return DI(i(r),e)}}function Sd(n,e,t){if(!(e in n))return null;const i=Ji(n[e],Ds|pe,t);return function(r){return gD(i(r),e)}}function xh(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function cD(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return rn(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function hD(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function Xv(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function Hv(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function dD(n,e){const t=n[e];if(t!==void 0)return yu(t,e)}function Ad(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function fD(n,e){const t=n[e];if(t!==void 0)return PI(t,e)}function yu(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function AI(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function rp(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function PI(n,e){if(typeof n=="string")return n;const t=yu(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function DI(n,e){const t=yu(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function gD(n,e){return typeof n=="number"?n:DI(n,e)}const qv={RENDER_ORDER:"renderOrder"};class kI extends Td{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(qv.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new dI(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(qv.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?II:e;const t=pD(e);this.styleFunction_=e===null?void 0:P4(t),this.changed()}}function pD(n){if(n===void 0)return II;if(!n)return null;if(typeof n=="function"||n instanceof Bi)return n;if(!Array.isArray(n))return $v([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Bi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Bi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return nD(r)}return $v(n)}class mD extends pd{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Te()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Xi(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),rI(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,l){let c;const h=t.viewState;function d(S,k,O,C){return s.call(o,k,S?O:null,C)}const f=h.projection,p=qT(e.slice(),f),_=[[0,0]];if(f.canWrapX()&&r){const S=f.getExtent(),k=Re(S);_.push([-k,0],[k,0])}const w=t.layerStatesArray,T=w.length,v=[],y=[];for(let S=0;S<_.length;S++)for(let k=T-1;k>=0;--k){const O=w[k],C=O.layer;if(C.hasRenderer()&&Hm(O,h)&&a.call(l,C)){const E=C.getRenderer(),R=C.getSource();if(E&&R){const P=R.getWrapX()?p:e,D=d.bind(null,O.managed);y[0]=P[0]+_[S][0],y[1]=P[1]+_[S][1],c=E.forEachFeatureAtCoordinate(y,t,i,D,v)}if(c)return c}}if(v.length===0)return;const I=1/v.length;return v.forEach((S,k)=>S.distanceSq+=k*I),v.sort((S,k)=>S.distanceSq-k.distanceSq),v.some(S=>c=S.callback(S.feature,S.layer,S.geometry)),c}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,bl,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){Te()}scheduleExpireIconCache(e){ci.canExpireCache()&&e.postRenderFunctions.push(_D)}}function _D(n,e){ci.expire()}class LI extends Qi{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}class yD extends mD{constructor(e){super(e),this.fontChangeListenerKey_=ve(ki,Xo.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Cd+" ol-layers";const i=e.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new LI(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Fe(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Sn.PRECOMPOSE,e);const t=e.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);t.some(a=>a.layer instanceof kI&&a.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let a=0,l=t.length;a<l;++a){const c=t[a];e.layerIndex=a;const h=c.layer,d=h.getSourceState();if(!Hm(c,r)||d!="ready"&&d!="undefined"){h.unrender();continue}const f=h.render(e,o);f&&(f!==o&&(this.children_.push(f),o=f),s.push(c))}this.declutter(e,s),m4(this.element_,this.children_),this.dispatchRenderEvent(Sn.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}class _r extends Qi{constructor(e,t){super(e),this.layer=t}}const zf={LAYERS:"layers"};class da extends nI{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(zf.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new ui(i.slice(),{unique:!0}):Ie(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new ui(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Fe),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(ve(e,Zt.ADD,this.handleLayersAdd_,this),ve(e,Zt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Fe);fu(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new _r("addlayer",s))}this.changed()}registerLayerListeners_(e){const t=[ve(e,Xo.PROPERTYCHANGE,this.handleLayerChange_,this),ve(e,ue.CHANGE,this.handleLayerChange_,this)];e instanceof da&&t.push(ve(e,"addlayer",this.handleLayerGroupAdd_,this),ve(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[xe(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new _r("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new _r("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new _r("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=xe(t);this.listenerKeys_[i].forEach(Fe),delete this.listenerKeys_[i],this.dispatchEvent(new _r("removelayer",t)),this.changed()}getLayers(){return this.get(zf.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new _r("removelayer",i[r]))}this.set(zf.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const l=t[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=Wn(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}}class ro extends Qi{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class fr extends ro{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const He={SINGLECLICK:"singleclick",CLICK:ue.CLICK,DBLCLICK:ue.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},sp={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class vD extends yd{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=ve(i,sp.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=ve(i,sp.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ue.TOUCHMOVE,this.boundHandleTouchMove_,vI?{passive:!1}:!1)}emulateClick_(e){let t=new fr(He.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new fr(He.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new fr(He.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==He.POINTERUP||t.type==He.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==He.POINTERDOWN||t.type==He.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new fr(He.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Fe),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new fr(He.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(ve(i,He.POINTERMOVE,this.handlePointerMove_,this),ve(i,He.POINTERUP,this.handlePointerUp_,this),ve(this.element_,He.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(ve(this.element_.getRootNode(),He.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new fr(He.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new fr(He.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Fe(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ue.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Fe(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Fe),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const gr={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Nt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},Sh=1/0;class ED{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,fu(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){Ie(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Sh?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<r&&i[c]<i[l]?c:l;t[e]=t[h],i[e]=i[h],e=h}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,l;for(a=0;a<s;++a)o=t[a],l=e(o),l==Sh?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}const H={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class wD extends ED{constructor(e,t){super(function(i){return e.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(ue.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===H.LOADED||i===H.ERROR||i===H.EMPTY){i!==H.ERROR&&t.removeEventListener(ue.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===H.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function TD(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Sh;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class r_ extends yi{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var t;this.map_&&((t=this.element)==null||t.remove());for(let i=0,r=this.listenerKeys.length;i<r;++i)Fe(this.listenerKeys[i]);this.listenerKeys.length=0,this.map_=e,e&&((this.target_??e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Ho&&this.listenerKeys.push(ve(e,gr.POSTRENDER,this.render,this)),e.render())}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class ID extends r_{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"›",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(ue.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+Cd+" "+e_+(this.collapsed_&&this.collapsible_?" "+bv:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>{var o;return((o=s.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>_P(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Qr(t,this.renderedAttributions_)){p4(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(bv),this.collapsed_?Fv(this.collapseLabel_,this.label_):Fv(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class CD extends r_{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"⇧",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(ue.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+Cd+" "+e_,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(yc)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ha}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(yc);!s&&i===0?this.element.classList.add(yc):s&&i!==0&&this.element.classList.remove(yc)}this.label_.style.transform=r}this.rotation_=i}}class RD extends r_{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"–",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(ue.CLICK,this.handleClick_.bind(this,i),!1);const d=document.createElement("button");d.className=s,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof a=="string"?document.createTextNode(a):a),d.addEventListener(ue.CLICK,this.handleClick_.bind(this,-i),!1);const f=t+" "+Cd+" "+e_,p=this.element;p.className=f,p.appendChild(h),p.appendChild(d),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:ha})):i.setZoom(s)}}}function xD(n){n=n||{};const e=new ui;return(n.zoom!==void 0?n.zoom:!0)&&e.push(new RD(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&e.push(new CD(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&e.push(new ID(n.attributionOptions)),e}const Yv={ACTIVE:"active"};class vu extends yi{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Yv.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(Yv.ACTIVE,e)}setMap(e){this.map_=e}}function SD(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:SP,center:n.getConstrainedCenter(r)})}}function s_(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:ha})}class AD extends vu{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==He.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();s_(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}class Eu extends vu{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==He.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==He.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==He.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==He.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function o_(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}function op(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const PD=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},DD=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},MI=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?DD(n):!0},kD=bl,OI=function(n){const e=n.originalEvent;return e.button==0&&!(g4&&pI&&e.ctrlKey)},NI=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},LD=function(n){const e=n.originalEvent;return pI?e.metaKey:e.ctrlKey},MD=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},FI=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},Uf=function(n){const e=n.originalEvent;return Ie(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.pointerType=="mouse"},OD=function(n){const e=n.originalEvent;return Ie(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&e.button===0};class ND extends Eu{constructor(e){super({stopDown:_d}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:op(NI,OD);this.condition_=e.onFocusOnly?op(MI,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(o_(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();sP(s,a.getResolution()),Mm(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),l=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:ha})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class FD extends Eu{constructor(e){e=e||{},super({stopDown:_d}),this.condition_=e.condition?e.condition:PD,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Uf(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===Bm)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return Uf(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Uf(e)&&OI(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class bD extends pd{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new zl([r])}getGeometry(){return this.geometry_}}const Ys={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ba extends Qi{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class VD extends Eu{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new bD(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??OI,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ba(Ys.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ba(t?Ys.BOXEND:Ys.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ba(Ys.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ba(Ys.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ba(Ys.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class zD extends VD{constructor(e){e=e||{};const t=e.condition?e.condition:MD;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:ha})}}const as={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class UD extends vu{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return NI(t)&&FI(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==ue.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==as.DOWN||r==as.LEFT||r==as.RIGHT||r==as.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;r==as.DOWN?c=-a:r==as.LEFT?l=-a:r==as.RIGHT?l=a:c=a;const h=[l,c];Mm(h,o.getRotation()),SD(o,h,this.duration_),i.preventDefault(),t=!0}}return!t}}class BD extends vu{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!LD(t)&&FI(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==ue.KEYDOWN||e.type==ue.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();s_(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}class jD{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class GD extends vu{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:kD;this.condition_=e.onFocusOnly?op(MI,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==ue.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s;if(e.type==ue.WHEEL&&(s=r.deltaY,d4&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=mI),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Ye(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),s_(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class WD extends Eu{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=_d),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==Bm&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(o_(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class $D extends Eu{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=_d),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(o_(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function KD(n){n=n||{};const e=new ui,t=new jD(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&e.push(new FD),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&e.push(new AD({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&e.push(new ND({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&e.push(new WD),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&e.push(new $D({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(e.push(new UD),e.push(new BD({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&e.push(new GD({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&e.push(new zD({duration:n.zoomDuration})),e}function bI(n){if(n instanceof Td){n.setMapInternal(null);return}n instanceof da&&n.getLayers().forEach(bI)}function VI(n,e){if(n instanceof Td){n.setMapInternal(e);return}if(n instanceof da){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)VI(t[i],e)}}let XD=class extends yi{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=HD(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:mI,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Hn(),this.pixelToCoordinateTransform_=Hn(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||xD(),this.interactions=t.interactions||KD({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new wD(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Nt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Nt.VIEW,this.handleViewChanged_),this.addChangeListener(Nt.SIZE,this.handleSizeChanged_),this.addChangeListener(Nt.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof ai)&&e.view.then(function(r){i.setView(new ai(r))}),this.controls.addEventListener(Zt.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Zt.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Zt.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Zt.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Zt.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Zt.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){VI(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:bl,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof da?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:bl,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(Nt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return ep(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Tt(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Nt.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof ui){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Di(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Tt(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Nt.SIZE)}getView(){return this.get(Nt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return TD(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new fr(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===sp.POINTERDOWN||i===ue.WHEEL||i===ue.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Ft.ANIMATING]||o[Ft.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Sn.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Sn.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new ro(gr.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new ro(gr.LOADSTART,this,e))));const i=this.postRenderFunctions_;for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Fe(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ue.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ue.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new yD(this)),this.mapBrowserEventHandler_=new vD(this,this.moveTolerance_);for(const s in He)this.mapBrowserEventHandler_.addEventListener(He[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ue.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ue.WHEEL,this.boundHandleBrowserEvent_,vI?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const s=t.getRootNode();i=s instanceof ShadowRoot?s.host:t}this.targetChangeHandlerKeys_=[ve(i,ue.KEYDOWN,this.handleBrowserEvent,this),ve(i,ue.KEYPRESS,this.handleBrowserEvent,this)];const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Fe(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Fe(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=ve(e,Xo.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=ve(e,ue.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Fe),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new _r("addlayer",e)),this.layerGroupPropertyListenerKeys_=[ve(e,Xo.PROPERTYCHANGE,this.render,this),ve(e,ue.CHANGE,this.render,this),ve(e,"addlayer",this.handleLayerAdd_,this),ve(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){bI(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&Lv(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Qg(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:xe(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=Qg(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!gd(this.previousExtent_)&&!Nl(s.extent,this.previousExtent_))&&(this.dispatchEvent(new ro(gr.MOVESTART,this,r)),this.previousExtent_=cd(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Ft.ANIMATING]&&!s.viewHints[Ft.INTERACTING]&&!Nl(s.extent,this.previousExtent_)&&(this.dispatchEvent(new ro(gr.MOVEEND,this,s)),GT(s.extent,this.previousExtent_))),this.dispatchEvent(new ro(gr.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(gr.LOADSTART)||this.hasListener(gr.LOADEND)||this.hasListener(Sn.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new _r("removelayer",t)),this.set(Nt.LAYERGROUP,e)}setSize(e){this.set(Nt.SIZE,e)}setTarget(e){this.set(Nt.TARGET,e)}setView(e){if(!e||e instanceof ai){this.set(Nt.VIEW,e);return}this.set(Nt.VIEW,new ai);const t=this;e.then(function(i){t.setView(new ai(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){const r=getComputedStyle(e),s=e.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=e.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(t=[Math.max(0,s),Math.max(0,o)],!Lv(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&YT("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!Qr(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function HD(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new da({layers:n.layers});t[Nt.LAYERGROUP]=i,t[Nt.TARGET]=n.target,t[Nt.VIEW]=n.view instanceof ai?n.view:new ai;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new ui(n.controls.slice()):(Ie(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new ui(n.interactions.slice()):(Ie(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new ui(n.overlays.slice()):(Ie(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new ui,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}class Ah extends yi{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new Ah(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Fe(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=ve(e,ue.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?qD(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function qD(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Ie(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}function ap(n,e,t,i,r,s,o){let a,l;const c=(t-e)/i;if(c===1)a=e;else if(c===2)a=e,l=r;else if(c!==0){let h=n[e],d=n[e+1],f=0;const p=[0];for(let T=e+i;T<t;T+=i){const v=n[T],y=n[T+1];f+=Math.sqrt((v-h)*(v-h)+(y-d)*(y-d)),p.push(f),h=v,d=y}const _=r*f,w=gP(p,_);w<0?(l=(_-p[-w-2])/(p[-w-1]-p[-w-2]),a=e+(-w-2)*i):a=e+w*i}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?n[a+h]:dn(n[a+h],n[a+i+h],l);return s}function YD(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,l=t/i;for(;a<l;){const f=a+l>>1;r<n[(f+1)*i-1]?l=f:a=f+1}const c=n[a*i-1];if(r==c)return n.slice((a-1)*i,(a-1)*i+i);const h=n[(a+1)*i-1],d=(r-c)/(h-c);o=[];for(let f=0;f<i-1;++f)o.push(dn(n[(a-1)*i+f],n[a*i+f],d));return o.push(r),o}function zI(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const l=n[a],c=n[a+1];o+=Math.sqrt((l-r)*(l-r)+(c-s)*(c-s)),r=l,s=c}return o}class Ph extends vd{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){md(this.flatCoordinates,e),this.changed()}clone(){const e=new Ph(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Pm(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return uI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,YD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return ps(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return ap(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return zI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Ed(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ph(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return Km(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wm(this.flatCoordinates,0,e,this.stride),this.changed()}}const ie={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ec=[ie.FILL],Cr=[ie.STROKE],ys=[ie.BEGIN_PATH],Zv=[ie.CLOSE_PATH];class UI{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}class wu extends UI{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=t)r[0]=e[a],r[1]=e[a+1],Ko(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(t+=r);let h=e[t],d=e[t+1];const f=this.tmpCoordinate_;let p=!0,_,w,T;for(_=t+r;_<i;_+=r)f[0]=e[_],f[1]=e[_+1],T=Zg(c,f),T!==w?(p&&(a[l++]=h,a[l++]=d,p=!1),a[l++]=f[0],a[l++]=f[1]):T===ft.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],p=!1):p=!0,h=f[0],d=f[1],w=T;return(s&&p||_===t+r)&&(a[l++]=h,a[l++]=d),l}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(e,t,l,r,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let c,h,d,f,p;switch(o){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),f=[];const _=e.getEndss();p=0;for(let w=0,T=_.length;w<T;++w){const v=[];p=this.drawCustomCoordinates_(c,p,_[w],a,v),f.push(v)}this.instructions.push([ie.CUSTOM,l,f,e,i,Av,s]),this.hitDetectionInstructions.push([ie.CUSTOM,l,f,e,r||i,Av,s]);break;case"Polygon":case"MultiLineString":d=[],c=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),p=this.drawCustomCoordinates_(c,0,e.getEnds(),a,d),this.instructions.push([ie.CUSTOM,l,d,e,i,wh,s]),this.hitDetectionInstructions.push([ie.CUSTOM,l,d,e,r||i,wh,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([ie.CUSTOM,l,h,e,i,ps,s]),this.hitDetectionInstructions.push([ie.CUSTOM,l,h,e,r||i,ps,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([ie.CUSTOM,l,h,e,i,ps,s]),this.hitDetectionInstructions.push([ie.CUSTOM,l,h,e,r||i,ps,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([ie.CUSTOM,l,h,e,i,void 0,s]),this.hitDetectionInstructions.push([ie.CUSTOM,l,h,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[ie.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ie.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==ie.END_GEOMETRY?o=t:s==ie.BEGIN_GEOMETRY&&(r[2]=t,pP(this.hitDetectionInstructions,o,t),o=-1)}setFillStrokeStyle(e,t){const i=this.state;if(e){const r=e.getColor();i.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,i.fillStyle=hi(r||Qt)}else i.fillStyle=void 0;if(t){const r=t.getColor();i.strokeStyle=hi(r||Gl);const s=t.getLineCap();i.lineCap=s!==void 0?s:Yo;const o=t.getLineDash();i.lineDash=o?o.slice():zi;const a=t.getLineDashOffset();i.lineDashOffset=a||Ui;const l=t.getLineJoin();i.lineJoin=l!==void 0?l:Zo;const c=t.getWidth();i.lineWidth=c!==void 0?c:$l;const h=t.getMiterLimit();i.miterLimit=h!==void 0?h:jl,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(e){const t=e.fillStyle,i=[ie.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[ie.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,this.applyPixelRatio(e.lineDash),e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!Qr(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(i!==void 0&&t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[ie.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=GT(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Am(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class ZD extends wu{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!Ko(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([ie.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ie.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let l=0,c=r.length;l<c;l+=e.getStride())(!this.maxExtent||Ko(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([ie.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ie.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class QD extends wu{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[ie.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,zi,Ui],ys);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Cr),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,zi,Ui],ys);const a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let d=0,f=a.length;d<f;++d)h=this.drawFlatCoordinates_(l,h,a[d],c);this.hitDetectionInstructions.push(Cr),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Cr),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Cr),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(ys)}}class Qv extends wu{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(ys),this.hitDetectionInstructions.push(ys);for(let c=0;c<l;++c){const h=i[c],d=this.coordinates.length,f=this.appendFlatLineCoordinates(e,t,h,r,!0,!a),p=[ie.MOVE_TO_LINE_TO,d,f];this.instructions.push(p),this.hitDetectionInstructions.push(p),a&&(this.instructions.push(Zv),this.hitDetectionInstructions.push(Zv)),t=h}return o&&(this.instructions.push(Ec),this.hitDetectionInstructions.push(Ec)),a&&(this.instructions.push(Cr),this.hitDetectionInstructions.push(Cr)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ie.SET_FILL_STYLE,Qt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,zi,Ui]);const a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[ie.CIRCLE,c];this.instructions.push(ys,h),this.hitDetectionInstructions.push(ys,h),r.fillStyle!==void 0&&(this.instructions.push(Ec),this.hitDetectionInstructions.push(Ec)),r.strokeStyle!==void 0&&(this.instructions.push(Cr),this.hitDetectionInstructions.push(Cr)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ie.SET_FILL_STYLE,Qt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,zi,Ui]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ie.SET_FILL_STYLE,Qt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,zi,Ui]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let d=0,f=a.length;d<f;++d)h=this.drawFlatCoordinatess_(l,h,a[d],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=cs(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;e.fillStyle!==void 0&&this.updateFillStyle(e,this.createFill),e.strokeStyle!==void 0&&this.updateStrokeStyle(e,this.applyStroke)}}function JD(n,e,t,i,r){const s=[];let o=t,a=0,l=e.slice(t,2);for(;a<n&&o+r<i;){const[c,h]=l.slice(-2),d=e[o+r],f=e[o+r+1],p=Math.sqrt((d-c)*(d-c)+(f-h)*(f-h));if(a+=p,a>=n){const _=(n-a+p)/p,w=dn(c,d,_),T=dn(h,f,_);l.push(w,T),s.push(l),l=[w,T],a==n&&(o+=r),a=0}else if(a<n)l.push(e[o+r],e[o+r+1]),o+=r;else{const _=p-a,w=dn(c,d,_/p),T=dn(h,f,_/p);l.push(w,T),s.push(l),l=[w,T],a=0,o+=r}}return a>0&&s.push(l),s}function ek(n,e,t,i,r){let s=t,o=t,a=0,l=0,c=t,h,d,f,p,_,w,T,v,y,I;for(d=t;d<i;d+=r){const S=e[d],k=e[d+1];_!==void 0&&(y=S-_,I=k-w,p=Math.sqrt(y*y+I*I),T!==void 0&&(l+=f,h=Math.acos((T*y+v*I)/(f*p)),h>n&&(l>a&&(a=l,s=c,o=d),l=0,c=d-r)),f=p,T=y,v=I),_=S,w=k}return l+=p,l>a?[c,d]:[s,o]}const Dh={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class tk extends wu{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Qt]={fillStyle:Qt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const c=e.getType();let h=null,d=e.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!en(this.maxExtent,e.getExtent()))return;let f;if(h=e.getFlatCoordinates(),c=="LineString")f=[h.length];else if(c=="MultiLineString")f=e.getEnds();else if(c=="Polygon")f=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const T=e.getEndss();f=[];for(let v=0,y=T.length;v<y;++v)f.push(T[v][0])}this.beginGeometry(e,t,i);const p=o.repeat,_=p?void 0:o.textAlign;let w=0;for(let T=0,v=f.length;T<v;++T){let y;p?y=JD(p*this.resolution,h,w,f[T],d):y=[h.slice(w,f[T])];for(let I=0,S=y.length;I<S;++I){const k=y[I];let O=0,C=k.length;if(_==null){const R=ek(o.maxAngle,k,0,k.length,2);O=R[0],C=R[1]}for(let R=O;R<C;R+=d)a.push(k[R],k[R+1]);const E=a.length;w=f[T],this.drawChars_(l,E),l=E}}this.endGeometry(t)}else{let f=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),d=2;break;case"Polygon":h=e.getFlatInteriorPoint(),o.overflow||f.push(h[2]/this.resolution),d=3;break;case"MultiPolygon":const y=e.getFlatInteriorPoints();h=[];for(let I=0,S=y.length;I<S;I+=3)o.overflow||f.push(y[I+2]/this.resolution),h.push(y[I],y[I+1]);if(h.length===0)return;d=2;break}const p=this.appendFlatPointCoordinates(h,d);if(p===l)return;if(f&&(p-l)/2!==h.length/d){let y=l/2;f=f.filter((I,S)=>{const k=a[(y+S)*2]===h[S*d]&&a[(y+S)*2+1]===h[S*d+1];return k||--y,k})}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(e,t,i);let _=o.padding;if(_!=_s&&(o.scale[0]<0||o.scale[1]<0)){let y=o.padding[0],I=o.padding[1],S=o.padding[2],k=o.padding[3];o.scale[0]<0&&(I=-I,k=-k),o.scale[1]<0&&(y=-y,S=-S),_=[y,I,S,k]}const w=this.pixelRatio;this.instructions.push([ie.DRAW_IMAGE,l,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,_==_s?_s:_.map(function(y){return y*w}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const T=1/w,v=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=Qt,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([ie.DRAW_IMAGE,l,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[T,T],NaN,this.declutterMode_,this.declutterImageWithText_,_,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Qt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),o.backgroundFill&&(this.state.fillStyle=v,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Wl,justify:t.justify,textBaseline:t.textBaseline||Ih,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=Dh[r.textBaseline],h=this.textOffsetY_*l,d=this.text_,f=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([ie.DRAW_CHARS,e,t,c,r.overflow,a,r.maxAngle,l,h,s,f*l,d,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([ie.DRAW_CHARS,e,t,c,r.overflow,a&&Qt,r.maxAngle,l,h,s,f*l,d,o,1/l,this.declutterMode_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=hi(o.getColor()||Qt)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const _=a.getLineDash(),w=a.getLineDashOffset(),T=a.getWidth(),v=a.getMiterLimit();s.lineCap=a.getLineCap()||Yo,s.lineDash=_?_.slice():zi,s.lineDashOffset=w===void 0?Ui:w,s.lineJoin=a.getLineJoin()||Zo,s.lineWidth=T===void 0?$l:T,s.miterLimit=v===void 0?jl:v,s.strokeStyle=hi(a.getColor()||Gl)}i=this.textState_;const l=e.getFont()||wI;C4(l);const c=e.getScaleArray();i.overflow=e.getOverflow(),i.font=l,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Ih,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||_s,i.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),d=e.getOffsetY(),f=e.getRotateWithView(),p=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=d===void 0?0:d,this.textRotateWithView_=f===void 0?!1:f,this.textRotation_=p===void 0?0:p,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:xe(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+xe(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const nk={Circle:Qv,Default:wu,Image:ZD,LineString:QD,Polygon:Qv,Text:tk};class ik{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=nk[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}const rk=5;class sk extends gu{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=rk}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Te()}getData(e){return null}prepareFrame(e){return Te()}renderFrame(e,t){return Te()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===de.LOADED||t.getState()===de.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=de.LOADED&&t!=de.ERROR&&e.addEventListener(ue.CHANGE,this.boundHandleImageChange_),t==de.IDLE&&(e.load(),t=e.getState()),t==de.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class BI{constructor(){$u(this,"pushMethodArgs_",(...e)=>(this.instructions_[this.zIndex+this.offset_].push(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Th(),{get:(e,t)=>{if(typeof Th()[t]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t),this.pushMethodArgs_},set:(e,t,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t,i),!0)})}pushFunction(e){this.instructions_[this.zIndex+this.offset_].push(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Jv=[];let so=null;function ok(){so=et(1,1,void 0,{willReadFrequently:!0})}class jI extends sk{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Hn(),this.pixelTransform=Hn(),this.inversePixelTransform=Hn(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){so||ok(),so.clearRect(0,0,1,1);let r;try{so.drawImage(e,t,i,1,1,0,0,1,1),r=so.getImageData(0,0,1,1).data}catch{return so=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&Qr(Bl(e.style.backgroundColor),Bl(i)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=et();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Ns(i),s=fd(i),o=dd(i),a=hd(i);Tt(t.coordinateToPixelTransform,r),Tt(t.coordinateToPixelTransform,s),Tt(t.coordinateToPixelTransform,o),Tt(t.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Tt(l,r),Tt(l,s),Tt(l,o),Tt(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(Re(i)/r*o),l=Math.round(Ut(i)/r*o);Xi(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),rI(this.inversePixelTransform,this.pixelTransform);const c=DP(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new LI(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Sn.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Sn.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new BI),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Sn.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Sn.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,a){const l=s/2,c=o/2,h=r/t,d=-h,f=-e[0]+a,p=-e[1];return Xi(this.tempTransform,l,c,h,d,-i,f,p)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function ak(n,e,t,i,r,s,o,a,l,c,h,d){let f=n[e],p=n[e+1],_=0,w=0,T=0,v=0;function y(){_=f,w=p,e+=i,f=n[e],p=n[e+1],v+=T,T=Math.sqrt((f-_)*(f-_)+(p-w)*(p-w))}do y();while(e<t-i&&v+T<s);let I=T===0?0:(s-v)/T;const S=dn(_,f,I),k=dn(w,p,I),O=e-i,C=v,E=s+a*l(c,r,h);for(;e<t-i&&v+T<E;)y();I=T===0?0:(E-v)/T;const R=dn(_,f,I),P=dn(w,p,I);let D;if(d){const $=[S,k,R,P];sI($,0,4,2,d,$,$),D=$[0]>$[2]}else D=S>R;const L=Math.PI,A=[],W=O+i===e;e=O,T=0,v=C,f=n[e],p=n[e+1];let te;if(W){y(),te=Math.atan2(p-w,f-_),D&&(te+=te>0?-L:L);const $=(R+S)/2,re=(P+k)/2;return A[0]=[$,re,(E-s)/2,te,r],A}r=r.replace(/\n/g," ");for(let $=0,re=r.length;$<re;){y();let U=Math.atan2(p-w,f-_);if(D&&(U+=U>0?-L:L),te!==void 0){let B=U-te;if(B+=B>L?-2*L:B<-L?2*L:0,Math.abs(B)>o)return null}te=U;const X=$;let G=0;for(;$<re;++$){const B=D?re-$-1:$,Be=a*l(c,r[B],h);if(e+i<t&&v+T<s+G+Be/2)break;G+=Be}if($===X)continue;const J=D?r.substring(re-X,re-$):r.substring(X,$);I=T===0?0:(s+G/2-v)/T;const ee=dn(_,f,I),he=dn(w,p,I);A.push([ee,he,G/2,U,J]),s+=G}return A}const Zs=kn(),ur=[],Ai=[],Pi=[],cr=[];function e1(n){return n[3].declutterBox}const t1=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function Bf(n,e){return e==="start"?e=t1.test(n)?"right":"left":e==="end"&&(e=t1.test(n)?"left":"right"),Dh[e]}function lk(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}class uk{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Hn(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new BI:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],d=l.justify?Dh[l.justify]:Bf(Array.isArray(e)?e[0]:e,l.textAlign||Wl),f=r&&o.lineWidth?o.lineWidth:0,p=Array.isArray(e)?e:String(e).split(`
`).reduce(lk,[]),{width:_,height:w,widths:T,heights:v,lineWidths:y}=x4(l,p),I=_+f,S=[],k=(I+2)*h[0],O=(w+f)*h[1],C={width:k<0?Math.floor(k):Math.ceil(k),height:O<0?Math.floor(O):Math.ceil(O),contextInstructions:S};(h[0]!=1||h[1]!=1)&&S.push("scale",h),r&&(S.push("strokeStyle",o.strokeStyle),S.push("lineWidth",f),S.push("lineCap",o.lineCap),S.push("lineJoin",o.lineJoin),S.push("miterLimit",o.miterLimit),S.push("setLineDash",[o.lineDash]),S.push("lineDashOffset",o.lineDashOffset)),i&&S.push("fillStyle",a.fillStyle),S.push("textBaseline","middle"),S.push("textAlign","center");const E=.5-d;let R=d*I+E*f;const P=[],D=[];let L=0,A=0,W=0,te=0,$;for(let re=0,U=p.length;re<U;re+=2){const X=p[re];if(X===`
`){A+=L,L=0,R=d*I+E*f,++te;continue}const G=p[re+1]||l.font;G!==$&&(r&&P.push("font",G),i&&D.push("font",G),$=G),L=Math.max(L,v[W]);const J=[X,R+E*T[W]+d*(T[W]-y[te]),.5*(f+L)+A];R+=T[W],r&&P.push("strokeText",J),i&&D.push("fillText",J),++W}return Array.prototype.push.apply(S,P),Array.prototype.push.apply(S,D),this.labels_[s]=C,C}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,l,c,h,d,f,p,_,w,T){a*=f[0],l*=f[1];let v=i-a,y=r-l;const I=s+c>e?e-c:s,S=o+h>t?t-h:o,k=_[3]+I*f[0]+_[1],O=_[0]+S*f[1]+_[2],C=v-_[3],E=y-_[0];(w||d!==0)&&(ur[0]=C,cr[0]=C,ur[1]=E,Ai[1]=E,Ai[0]=C+k,Pi[0]=Ai[0],Pi[1]=E+O,cr[1]=Pi[1]);let R;return d!==0?(R=Xi(Hn(),i,r,1,1,d,-i,-r),Tt(R,ur),Tt(R,Ai),Tt(R,Pi),Tt(R,cr),jr(Math.min(ur[0],Ai[0],Pi[0],cr[0]),Math.min(ur[1],Ai[1],Pi[1],cr[1]),Math.max(ur[0],Ai[0],Pi[0],cr[0]),Math.max(ur[1],Ai[1],Pi[1],cr[1]),Zs)):jr(Math.min(C,C+k),Math.min(E,E+O),Math.max(C,C+k),Math.max(E,E+O),Zs),p&&(v=Math.round(v),y=Math.round(y)),{drawImageX:v,drawImageY:y,drawImageW:I,drawImageH:S,originX:c,originY:h,declutterBox:{minX:Zs[0],minY:Zs[1],maxX:Zs[2],maxY:Zs[3],value:T},canvasTransform:R,scale:f}}replayImageOrLabel_(e,t,i,r,s,o,a){const l=!!(o||a),c=r.declutterBox,h=a?a[2]*r.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,ur,Ai,Pi,cr,o,a),S4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=Tt(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],l=this.pixelRatio,c=Bf(Array.isArray(e)?e[0]:e,s.textAlign||Wl),h=Dh[s.textBaseline||Ih],d=a&&a.lineWidth?a.lineWidth:0,f=o.width/l-2*s.scale[0],p=c*f+2*(.5-c)*d,_=h*o.height/l+2*(.5-h)*d;return{label:o,anchorX:p,anchorY:_}}execute_(e,t,i,r,s,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&Qr(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Or(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),AP(this.renderedTransform_,i));let d=0;const f=r.length;let p=0,_,w,T,v,y,I,S,k,O,C,E,R,P,D=0,L=0,A=null,W=null;const te=this.coordinateCache_,$=this.viewRotation_,re=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,U={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:$},X=this.instructions!=r||this.overlaps?0:200;let G,J,ee,he;for(;d<f;){const B=r[d];switch(B[0]){case ie.BEGIN_GEOMETRY:G=B[1],he=B[3],G.getGeometry()?a!==void 0&&!en(a,he.getExtent())?d=B[2]+1:++d:d=B[2],c&&(c.zIndex=B[4]);break;case ie.BEGIN_PATH:D>X&&(this.fill_(e),D=0),L>X&&(e.stroke(),L=0),!D&&!L&&(e.beginPath(),y=NaN,I=NaN),++d;break;case ie.CIRCLE:p=B[1];const Me=h[p],De=h[p+1],vn=h[p+2],Mn=h[p+3],_t=vn-Me,ln=Mn-De,vi=Math.sqrt(_t*_t+ln*ln);e.moveTo(Me+vi,De),e.arc(Me,De,vi,0,2*Math.PI,!0),++d;break;case ie.CLOSE_PATH:e.closePath(),++d;break;case ie.CUSTOM:p=B[1],_=B[2];const er=B[3],es=B[4],Ei=B[5];U.geometry=er,U.feature=G,d in te||(te[d]=[]);const Qn=te[d];Ei?Ei(h,p,_,2,Qn):(Qn[0]=h[p],Qn[1]=h[p+1],Qn.length=2),c&&(c.zIndex=B[6]),es(Qn,U),++d;break;case ie.DRAW_IMAGE:p=B[1],_=B[2],O=B[3],w=B[4],T=B[5];let Ht=B[6];const En=B[7],wi=B[8],Jn=B[9],tr=B[10];let Ti=B[11];const ei=B[12];let ti=B[13];v=B[14]||"declutter";const Ze=B[15];if(!O&&B.length>=20){C=B[19],E=B[20],R=B[21],P=B[22];const yt=this.drawLabelWithPointPlacement_(C,E,R,P);O=yt.label,B[3]=O;const ii=B[23];w=(yt.anchorX-ii)*this.pixelRatio,B[4]=w;const dt=B[24];T=(yt.anchorY-dt)*this.pixelRatio,B[5]=T,Ht=O.height,B[6]=Ht,ti=O.width,B[13]=ti}let tt;B.length>25&&(tt=B[25]);let st,Ii,ts;B.length>17?(st=B[16],Ii=B[17],ts=B[18]):(st=_s,Ii=!1,ts=!1),tr&&re?Ti+=$:!tr&&!re&&(Ti-=$);let xu=0;for(;p<_;p+=2){if(tt&&tt[xu++]<ti/this.pixelRatio)continue;const yt=this.calculateImageOrLabelDimensions_(O.width,O.height,h[p],h[p+1],ti,Ht,w,T,wi,Jn,Ti,ei,s,st,Ii||ts,G),ii=[e,t,O,yt,En,Ii?A:null,ts?W:null];if(l){let dt,un,ke;if(Ze){const Le=_-p;if(!Ze[Le]){Ze[Le]={args:ii,declutterMode:v};continue}const vt=Ze[Le];dt=vt.args,un=vt.declutterMode,delete Ze[Le],ke=e1(dt)}let wn,jt;if(dt&&(un!=="declutter"||!l.collides(ke))&&(wn=!0),(v!=="declutter"||!l.collides(yt.declutterBox))&&(jt=!0),un==="declutter"&&v==="declutter"){const Le=wn&&jt;wn=Le,jt=Le}wn&&(un!=="none"&&l.insert(ke),this.replayImageOrLabel_.apply(this,dt)),jt&&(v!=="none"&&l.insert(yt.declutterBox),this.replayImageOrLabel_.apply(this,ii))}else this.replayImageOrLabel_.apply(this,ii)}++d;break;case ie.DRAW_CHARS:const Su=B[1],nr=B[2],Bs=B[3],Au=B[4];P=B[5];const va=B[6],Pu=B[7],Du=B[8];R=B[9];const ns=B[10];C=B[11],E=B[12];const Ea=[B[13],B[13]];v=B[14]||"declutter";const js=this.textStates[E],On=js.font,Ci=[js.scale[0]*Pu,js.scale[1]*Pu];let Ri;On in this.widths_?Ri=this.widths_[On]:(Ri={},this.widths_[On]=Ri);const ni=zI(h,Su,nr,2),wa=Math.abs(Ci[0])*zv(On,C,Ri);if(Au||wa<=ni){const yt=this.textStates[E].textAlign,ii=(ni-wa)*Bf(C,yt),dt=ak(h,Su,nr,2,C,ii,va,Math.abs(Ci[0]),zv,On,Ri,re?0:this.viewRotation_);e:if(dt){const un=[];let ke,wn,jt,Le,vt;if(R)for(ke=0,wn=dt.length;ke<wn;++ke){vt=dt[ke],jt=vt[4],Le=this.createLabel(jt,E,"",R),w=vt[2]+(Ci[0]<0?-ns:ns),T=Bs*Le.height+(.5-Bs)*2*ns*Ci[1]/Ci[0]-Du;const Nn=this.calculateImageOrLabelDimensions_(Le.width,Le.height,vt[0],vt[1],Le.width,Le.height,w,T,0,0,vt[3],Ea,!1,_s,!1,G);if(l&&v==="declutter"&&l.collides(Nn.declutterBox))break e;un.push([e,t,Le,Nn,1,null,null])}if(P)for(ke=0,wn=dt.length;ke<wn;++ke){vt=dt[ke],jt=vt[4],Le=this.createLabel(jt,E,P,""),w=vt[2],T=Bs*Le.height-Du;const Nn=this.calculateImageOrLabelDimensions_(Le.width,Le.height,vt[0],vt[1],Le.width,Le.height,w,T,0,0,vt[3],Ea,!1,_s,!1,G);if(l&&v==="declutter"&&l.collides(Nn.declutterBox))break e;un.push([e,t,Le,Nn,1,null,null])}l&&v!=="none"&&l.load(un.map(e1));for(let Nn=0,ir=un.length;Nn<ir;++Nn)this.replayImageOrLabel_.apply(this,un[Nn])}}++d;break;case ie.END_GEOMETRY:if(o!==void 0){G=B[1];const yt=o(G,he,v);if(yt)return yt}++d;break;case ie.FILL:X?D++:this.fill_(e),++d;break;case ie.MOVE_TO_LINE_TO:for(p=B[1],_=B[2],J=h[p],ee=h[p+1],e.moveTo(J,ee),y=J+.5|0,I=ee+.5|0,p+=2;p<_;p+=2)J=h[p],ee=h[p+1],S=J+.5|0,k=ee+.5|0,(p==_-2||S!==y||k!==I)&&(e.lineTo(J,ee),y=S,I=k);++d;break;case ie.SET_FILL_STYLE:A=B,this.alignAndScaleFill_=B[2],D&&(this.fill_(e),D=0,L&&(e.stroke(),L=0)),e.fillStyle=B[1],++d;break;case ie.SET_STROKE_STYLE:W=B,L&&(e.stroke(),L=0),this.setStrokeStyle_(e,B),++d;break;case ie.STROKE:X?L++:e.stroke(),++d;break;default:++d;break}}D&&this.fill_(e),L&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ro=["Polygon","Circle","LineString","Image","Text","Default"],GI=["Image","Text"],ck=Ro.filter(n=>!GI.includes(n));class hk{constructor(e,t,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Hn(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new uk(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,l=Xi(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=et(a,a,void 0,{willReadFrequently:!0}));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let d;this.renderBuffer_!==void 0&&(d=kn(),hl(d,e),Am(d,t*(this.renderBuffer_+r),d));const f=dk(r);let p;function _(k,O,C){const E=h.getImageData(0,0,a,a).data;for(let R=0,P=f.length;R<P;R++)if(E[f[R]]>0){if(!o||C==="none"||p!=="Image"&&p!=="Text"||o.includes(k)){const D=(f[R]-3)/4,L=r-D%a,A=r-(D/a|0),W=s(k,O,L*L+A*A);if(W)return W}h.clearRect(0,0,a,a);break}}const w=Object.keys(this.executorsByZIndex_).map(Number);w.sort(Vi);let T,v,y,I,S;for(T=w.length-1;T>=0;--T){const k=w[T].toString();for(y=this.executorsByZIndex_[k],v=Ro.length-1;v>=0;--v)if(p=Ro[v],I=y[p],I!==void 0&&(S=I.executeHitDetection(h,l,i,_,d),S))return S}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return Or(a,0,8,2,e,a),a}isEmpty(){return $o(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(Vi),o=o||Ro;const c=Ro.length;let h,d,f,p,_;for(a&&l.reverse(),h=0,d=l.length;h<d;++h){const w=l[h].toString();for(_=this.executorsByZIndex_[w],f=0,p=o.length;f<p;++f){const T=o[f],v=_[T];if(v!==void 0){const y=a===null?void 0:v.getZIndexContext(),I=y?y.getContext():e,S=this.maxExtent_&&T!=="Image"&&T!=="Text";if(S&&(I.save(),this.clip(I,i)),!y||T==="Text"||T==="Image"?v.execute(I,t,i,r,s,a):y.pushFunction(k=>v.execute(k,t,i,r,s,a)),S&&I.restore(),y){y.offset();const k=l[h]*c+f;this.deferredZIndexContexts_[k]||(this.deferredZIndexContexts_[k]=[]),this.deferredZIndexContexts_[k].push(y)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Vi);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const jf={};function dk(n){if(jf[n]!==void 0)return jf[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let l=i[a];l||(l=[],i[a]=l),l.push(((n+s)*e+(n+o))*4+3),s>0&&l.push(((n-s)*e+(n+o))*4+3),o>0&&(l.push(((n+s)*e+(n-o))*4+3),s>0&&l.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return jf[n]=r,r}class fk extends UI{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Lm(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Hn()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Or(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,d=s.length;h<d;h+=2){const f=s[h]-this.imageAnchorX_,p=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const _=f+this.imageAnchorX_,w=p+this.imageAnchorY_;Xi(a,_,w,1,1,c,-_,-w),o.save(),o.transform.apply(o,a),o.translate(_,w),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,p,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Or(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=Or(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=NP(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(en(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];r=this.drawRings_(i,r,c,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),Qr(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Wl;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:hi(i||Qt)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||zi;this.strokeState_={lineCap:r!==void 0?r:Yo,lineDash:this.pixelRatio_===1?h:h.map(d=>d*this.pixelRatio_),lineDashOffset:(o||Ui)*this.pixelRatio_,lineJoin:a!==void 0?a:Zo,lineWidth:(l!==void 0?l:$l)*this.pixelRatio_,miterLimit:c!==void 0?c:jl,strokeStyle:hi(i||Gl)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const p=t.getColor();this.textFillState_={fillStyle:hi(p||Qt)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const p=i.getColor(),_=i.getLineCap(),w=i.getLineDash(),T=i.getLineDashOffset(),v=i.getLineJoin(),y=i.getWidth(),I=i.getMiterLimit();this.textStrokeState_={lineCap:_!==void 0?_:Yo,lineDash:w||zi,lineDashOffset:T||Ui,lineJoin:v!==void 0?v:Zo,lineWidth:y!==void 0?y:$l,miterLimit:I!==void 0?I:jl,strokeStyle:hi(p||Gl)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),d=e.getTextAlign(),f=e.getTextBaseline();this.textState_={font:r!==void 0?r:wI,textAlign:d!==void 0?d:Wl,textBaseline:f!==void 0?f:Ih},this.text_=h!==void 0?Array.isArray(h)?h.reduce((p,_,w)=>p+=w%2?" ":_,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const li=.5;function gk(n,e,t,i,r,s,o,a,l){const c=r,h=n[0]*li,d=n[1]*li,f=et(h,d);f.imageSmoothingEnabled=!1;const p=f.canvas,_=new fk(f,li,r,null,o,a,null),w=t.length,T=Math.floor((256*256*256-1)/w),v={};for(let I=1;I<=w;++I){const S=t[I-1],k=S.getStyleFunction()||i;if(!k)continue;let O=k(S,s);if(!O)continue;Array.isArray(O)||(O=[O]);const E=(I*T).toString(16).padStart(7,"#00000");for(let R=0,P=O.length;R<P;++R){const D=O[R],L=D.getGeometryFunction()(S);if(!L||!en(c,L.getExtent()))continue;const A=D.clone(),W=A.getFill();W&&W.setColor(E);const te=A.getStroke();te&&(te.setColor(E),te.setLineDash(null)),A.setText(void 0);const $=D.getImage();if($){const G=$.getImageSize();if(!G)continue;const J=et(G[0],G[1],void 0,{alpha:!1}),ee=J.canvas;J.fillStyle=E,J.fillRect(0,0,ee.width,ee.height),A.setImage(new _u({img:ee,anchor:$.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:$.getOrigin(),opacity:1,size:$.getSize(),scale:$.getScale(),rotation:$.getRotation(),rotateWithView:$.getRotateWithView()}))}const re=A.getZIndex()||0;let U=v[re];U||(U={},v[re]=U,U.Polygon=[],U.Circle=[],U.LineString=[],U.Point=[]);const X=L.getType();if(X==="GeometryCollection"){const G=L.getGeometriesArrayRecursive();for(let J=0,ee=G.length;J<ee;++J){const he=G[J];U[he.getType().replace("Multi","")].push(he,A)}}else U[X.replace("Multi","")].push(L,A)}}const y=Object.keys(v).map(Number).sort(Vi);for(let I=0,S=y.length;I<S;++I){const k=v[y[I]];for(const O in k){const C=k[O];for(let E=0,R=C.length;E<R;E+=2){_.setStyle(C[E+1]);for(let P=0,D=e.length;P<D;++P)_.setTransform(e[P]),_.drawGeometry(C[E])}}}return f.getImageData(0,0,p.width,p.height)}function pk(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*li),s=Math.floor(Math.round(n[1])*li),o=(Ye(r,0,t.width-1)+Ye(s,0,t.height-1)*t.width)*4,a=t.data[o],l=t.data[o+1],h=t.data[o+2]+256*(l+256*a),d=Math.floor((256*256*256-1)/e.length);h&&h%d===0&&i.push(e[h/d-1])}return i}const mk=.5,WI={Point:Ck,LineString:wk,Polygon:xk,MultiPoint:Rk,MultiLineString:Tk,MultiPolygon:Ik,GeometryCollection:Ek,Circle:yk};function _k(n,e){return parseInt(xe(n),10)-parseInt(xe(e),10)}function n1(n,e){const t=$I(n,e);return t*t}function $I(n,e){return mk*n/e}function yk(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,i,r)}const a=t.getText();if(a&&a.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function i1(n,e,t,i,r,s,o,a){const l=[],c=t.getImage();if(c){let f=!0;const p=c.getImageState();p==de.LOADED||p==de.ERROR?f=!1:p==de.IDLE&&c.load(),f&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const d=l.length>0;return d&&Promise.all(l).then(()=>r(null)),vk(n,e,t,i,s,o,a),d}function vk(n,e,t,i,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(i,r);if(t.getRenderer())KI(n,l,t,e,o);else{const h=WI[l.getType()];h(n,l,t,e,o,s)}}function KI(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)KI(n,o[a],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function Ek(n,e,t,i,r,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=WI[o[a].getType()];c(n,o[a],t,i,r,s)}}function wk(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function Tk(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function Ik(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,r)}}function Ck(n,e,t,i,r,s){const o=t.getImage(),a=t.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=de.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(e,i,r)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(e,i,r)}}function Rk(n,e,t,i,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=de.LOADED)return;const d=n.getBuilder(t.getZIndex(),"Image");d.setImageStyle(o,h),d.drawMultiPoint(e,i,r)}if(c){const d=n.getBuilder(t.getZIndex(),"Text");d.setTextStyle(l,h),d.drawText(e,i,r)}}function xk(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,r)}}class Sk extends jI{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=kn(),this.wrappedRenderedExtent_=kn(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),d=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),p=t.pixelRatio,_=t.viewHints,w=!(_[Ft.ANIMATING]||_[Ft.INTERACTING]),T=this.context,v=Math.round(Re(r)/a*p),y=Math.round(Ut(r)/a*p),I=d.getWrapX()&&l.canWrapX(),S=I?Re(h):null,k=I?Math.ceil((r[2]-h[2])/S)+1:1;let O=I?Math.floor((r[0]-h[0])/S):0;do{let C=this.getRenderTransform(o,a,0,p,v,y,O*S);t.declutter&&(C=C.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],C,c,w,i===void 0?Ro:i?GI:ck,i?f&&t.declutter[f]:void 0)}while(++O<k)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=et(this.context.canvas.width,this.context.canvas.height,Jv))}resetDrawContext_(){if(this.opacity_!==1){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,qo(this.context),Jv.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Sn.PRERENDER)||this.getLayer().hasListener(Sn.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=Ir(i.extent);a=en(l,e.extent),this.clipped_=a&&!Co(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],d=i[0]*li,f=i[1]*li;h.push(this.getRenderTransform(r,s,o,li,d,f,0).slice());const p=c.getSource(),_=a.getExtent();if(p.getWrapX()&&a.canWrapX()&&!Co(_,l)){let w=l[0];const T=Re(_);let v=0,y;for(;w<_[0];)--v,y=T*v,h.push(this.getRenderTransform(r,s,o,li,d,f,y).slice()),w+=T;for(v=0,w=l[2];w>_[2];)++v,y=T*v,h.push(this.getRenderTransform(r,s,o,li,d,f,y).slice()),w-=T}this.hitDetectionImageData_=gk(i,h,this.renderedFeatures_,c.getStyleFunction(),l,s,o,n1(s,this.renderedPixelRatio_))}t(pk(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),c={},h=function(_,w,T){const v=xe(_),y=c[v];if(y){if(y!==!0&&T<y.distanceSq){if(T===0)return c[v]=!0,s.splice(s.lastIndexOf(y),1),r(_,l,w);y.geometry=w,y.distanceSq=T}}else{if(T===0)return c[v]=!0,r(_,l,w);s.push(c[v]={feature:_,layer:l,geometry:w,distanceSq:T,callback:r})}};let d;const f=[this.replayGroup_],p=this.getLayer().getDeclutter();return f.some(_=>d=_.forEachFeatureAtCoordinate(e,o,a,i,h,p&&t.declutter[p]?t.declutter[p].all().map(w=>w.value):null)),d}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Ft.ANIMATING],s=e.viewHints[Ft.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,d=c.resolution,f=e.pixelRatio,p=t.getRevision(),_=t.getRenderBuffer();let w=t.getRenderOrder();w===void 0&&(w=_k);const T=c.center.slice(),v=Am(l,_*d),y=v.slice(),I=[v.slice()],S=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!Co(S,e.extent)){const W=Re(S),te=Math.max(Re(v)/2,W);v[0]=S[0]-te,v[2]=S[2]+te,qT(T,h);const $=HT(I[0],h);$[0]<S[0]&&$[2]<S[2]?I.push([$[0]+W,$[1],$[2]+W,$[3]]):$[0]>S[0]&&$[2]>S[2]&&I.push([$[0]-W,$[1],$[2]-W,$[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==p&&this.renderedRenderOrder_==w&&this.renderedFrameDeclutter_===!!e.declutter&&Co(this.wrappedRenderedExtent_,v))return Qr(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const k=new ik($I(d,f),v,d,f);let O;for(let W=0,te=I.length;W<te;++W)i.loadFeatures(I[W],d,h);const C=n1(d,f);let E=!0;const R=(W,te)=>{let $;const re=W.getStyleFunction()||t.getStyleFunction();if(re&&($=re(W,d)),$){const U=this.renderFeature(W,C,$,k,O,this.getLayer().getDeclutter(),te);E=E&&!U}},P=eI(v),D=i.getFeaturesInExtent(P);w&&D.sort(w);for(let W=0,te=D.length;W<te;++W)R(D[W],W);this.renderedFeatures_=D,this.ready=E;const L=k.finish(),A=new hk(v,d,f,i.getOverlaps(),L,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=d,this.renderedRevision_=p,this.renderedRenderOrder_=w,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=y,this.wrappedRenderedExtent_=v,this.renderedCenter_=T,this.renderedProjection_=h,this.renderedPixelRatio_=f,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=i1(r,e,i[c],t,this.boundHandleStyleImageChange_,s,o,a)||l;else l=i1(r,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return l}}class r1 extends kI{constructor(e){super(e)}createRenderer(){return new Sk(this)}}class s1{constructor(e){this.rbush_=new dI(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[xe(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[xe(a)]=l}this.rbush_.load(i)}remove(e){const t=xe(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[xe(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Nl(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return $o(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return jr(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}function Ak(n,e,t,i){const r=[];let s=kn();for(let o=0,a=t.length;o<a;++o){const l=t[o];s=Dm(n,e,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return r}const o1=Hn();class jn{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?$T(this.flatCoordinates_):Dm(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Ps(this.getExtent());this.flatInteriorPoints_=$m(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=HP(this.flatCoordinates_,this.ends_),t=Ak(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=WP(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ap(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=ap(e,t,o,2,.5);md(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Ln(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Ut(i)/Ut(t);Xi(o1,i[0],i[3],r,-r,0,0,0),Or(this.flatCoordinates_,0,this.flatCoordinates_.length,2,o1,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new jn(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=tI((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=Ed(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=UP(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=oI(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new jn(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}jn.prototype.getFlatCoordinates=jn.prototype.getOrientedFlatCoordinates;class XI extends yi{constructor(e){super(),this.projection=Ln(e.projection),this.attributions_=a1(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=a1(e),this.changed()}setState(e){this.state_=e,this.changed()}}function a1(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Tn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Pk(n,e){return[[-1/0,-1/0,1/0,1/0]]}let Dk=!1;function kk(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=Dk,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?s(e.readFeatures(h,{extent:t,featureProjection:r}),e.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function l1(n,e){return function(t,i,r,s,o){const a=this;kk(n,e,t,i,r,function(l,c){a.addFeatures(l),s!==void 0&&s(l)},o||Ho)}}class hr extends Qi{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class u1 extends XI{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ho,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Ie(this.format_,"`format` must be set when `url` is set"),this.loader_=l1(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:Pk;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new s1:null,this.loadedExtentsRtree_=new s1,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new ui(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=xe(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new hr(Tn.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof jn||(this.featureChangeKeys_[e]=[ve(t,ue.CHANGE,this.handleFeatureChange_,this),ve(t,Xo.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof jn){const s=this.idIndex_[r];s instanceof jn?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(Ie(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=xe(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=xe(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();t.push(h),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Tn.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new hr(Tn.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Tn.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Tn.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Zt.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Zt.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Fe);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=r=>{this.removeFeatureInternal(r)};this.featuresRtree_.forEach(i);for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new hr(Tn.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof jn||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof jn||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),$o(this.nullGeometryFeatures_)||md(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=km(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||bl,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),d=a;if(a=h instanceof jn?0:h.closestPointXY(i,r,o,a),a<d){s=c;const f=Math.sqrt(a);l[0]=i-f,l[1]=r-f,l[2]=i+f,l[3]=r+f}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=xe(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new hr(Tn.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:xe(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&$o(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return Co(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new hr(Tn.FEATURESLOADSTART)),this.loader_.call(this,l,t,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new hr(Tn.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new hr(Tn.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_;let i;t.forEachInExtent(e,function(r){if(Nl(r.extent,e))return i=r,!0}),i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=xe(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e);const i=this.featureChangeKeys_[t];i==null||i.forEach(Fe),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Tn.REMOVEFEATURE)&&this.dispatchEvent(new hr(Tn.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Ie(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(l1(e,this.format_))}}class a_ extends yd{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(ue.CHANGE)}release(){this.state===H.ERROR&&this.setState(H.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==H.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}load(){Te()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:iI(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}class HI extends a_{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=H.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=H.ERROR,this.unlistenImage_(),this.image_=Lk(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=H.LOADED:this.state=H.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==H.ERROR&&(this.state=H.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==H.IDLE&&(this.state=H.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=_4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function Lk(){const n=et(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}class Mk{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();){const t=this.pop();t instanceof pd&&t.dispose()}}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return Ie(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return Ie(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var t;return(t=this.entries_[e])==null?void 0:t.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Ie(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function kh(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function Ok(n,e,t){return n+"/"+e+"/"+t}function Nk(n){return Fk(n[0],n[1],n[2])}function Fk(n,e,t){return(e<<n)+t}function bk(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}class l_{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Qs(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new l_(n,e,t,i)}const wc={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class Vk extends Td{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(wc.PRELOAD)}setPreload(e){this.set(wc.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(wc.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(wc.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}function Lh(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}function zk(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Float32Array||n instanceof DataView?n:null}const Uk=new Error("disposed");let Js=null;function Bk(n){Js||(Js=et(n.width,n.height,void 0,{willReadFrequently:!0}));const e=Js.canvas,t=n.width;e.width!==t&&(e.width=t);const i=n.height;return e.height!==i&&(e.height=i),Js.clearRect(0,0,t,i),Js.drawImage(n,0,0),Js.getImageData(0,0,t,i).data}const jk=[256,256];class lp extends a_{constructor(e){const t=H.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Lh(this.data_);return e?[e.width,e.height]:jk}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==H.IDLE&&this.state!==H.ERROR)return;this.state=H.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=H.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=H.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Uk),this.controller_=null),super.disposeInternal()}}const qI=.5,Gk=10,c1=.25;class YI{constructor(e,t,i,r,s,o){this.sourceProj_=e,this.targetProj_=t;let a={};const l=vh(this.targetProj_,this.sourceProj_);this.transformInv_=function(y){const I=y[0]+"/"+y[1];return a[I]||(a[I]=l(y)),a[I]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&Re(r)>=Re(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Re(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Re(this.targetProj_.getExtent()):null;const c=Ns(i),h=fd(i),d=dd(i),f=hd(i),p=this.transformInv_(c),_=this.transformInv_(h),w=this.transformInv_(d),T=this.transformInv_(f),v=Gk+(o?Math.max(0,Math.ceil(Math.log2(Fl(i)/(o*o*256*256)))):0);if(this.addQuad_(c,h,d,f,p,_,w,T,v),this.wrapsXInSource_){let y=1/0;this.triangles_.forEach(function(I,S,k){y=Math.min(y,I.source[0][0],I.source[1][0],I.source[2][0])}),this.triangles_.forEach(I=>{if(Math.max(I.source[0][0],I.source[1][0],I.source[2][0])-y>this.sourceWorldWidth_/2){const S=[[I.source[0][0],I.source[0][1]],[I.source[1][0],I.source[1][1]],[I.source[2][0],I.source[2][1]]];S[0][0]-y>this.sourceWorldWidth_/2&&(S[0][0]-=this.sourceWorldWidth_),S[1][0]-y>this.sourceWorldWidth_/2&&(S[1][0]-=this.sourceWorldWidth_),S[2][0]-y>this.sourceWorldWidth_/2&&(S[2][0]-=this.sourceWorldWidth_);const k=Math.min(S[0][0],S[1][0],S[2][0]);Math.max(S[0][0],S[1][0],S[2][0])-k<this.sourceWorldWidth_/2&&(I.source=S)}})}a={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,l,c){const h=pv([s,o,a,l]),d=this.sourceWorldWidth_?Re(h)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&d>.5&&d<1;let _=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=pv([e,t,i,r]);_=Re(T)/this.targetWorldWidth_>c1||_}!p&&this.sourceProj_.isGlobal()&&d&&(_=d>c1||_)}if(!_&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!en(h,this.maxSourceExtent_))return;let w=0;if(!_&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)_=!0;else if(w=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),w!=1&&w!=2&&w!=4&&w!=8)return}if(c>0){if(!_){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],v=this.transformInv_(T);let y;p?y=(Oo(s[0],f)+Oo(a[0],f))/2-Oo(v[0],f):y=(s[0]+a[0])/2-v[0];const I=(s[1]+a[1])/2-v[1];_=y*y+I*I>this.errorThresholdSquared_}if(_){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],v=this.transformInv_(T),y=[(r[0]+e[0])/2,(r[1]+e[1])/2],I=this.transformInv_(y);this.addQuad_(e,t,T,y,s,o,v,I,c-1),this.addQuad_(y,T,i,r,I,v,a,l,c-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],v=this.transformInv_(T),y=[(i[0]+r[0])/2,(i[1]+r[1])/2],I=this.transformInv_(y);this.addQuad_(e,T,y,r,s,v,I,l,c-1),this.addQuad_(T,t,i,y,v,o,a,I,c-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}w&11||this.addTriangle_(e,i,r,s,a,l),w&14||this.addTriangle_(e,i,t,s,a,o),w&&(w&13||this.addTriangle_(t,r,e,o,l,s),w&7||this.addTriangle_(t,r,i,o,l,a))}calculateSourceExtent(){const e=kn();return this.triangles_.forEach(function(t,i,r){const s=t.source;hl(e,s[0]),hl(e,s[1]),hl(e,s[2])}),e}getTriangles(){return this.triangles_}}let Gf;const ji=[];function h1(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function Wf(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function Wk(){if(Gf===void 0){const n=et(6,6,ji);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",h1(n,4,5,4,0),h1(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;Gf=Wf(e,0)||Wf(e,4)||Wf(e,8),qo(n),ji.push(n.canvas)}return Gf}function d1(n,e,t,i){const r=JT(t,e,n);let s=_v(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const l=n.getExtent();if(!l||Ko(l,r)){const c=_v(n,s,r)/s;isFinite(c)&&c>0&&(s/=c)}return s}function ZI(n,e,t,i){const r=Ps(t);let s=d1(n,e,r,i);return(!isFinite(s)||s<=0)&&XT(t,function(o){return s=d1(n,e,o,i),isFinite(s)&&s>0}),s}function QI(n,e,t,i,r,s,o,a,l,c,h,d,f,p){const _=et(Math.round(t*n),Math.round(t*e),ji);if(d||(_.imageSmoothingEnabled=!1),l.length===0)return _.canvas;_.scale(t,t);function w(k){return Math.round(k*t)/t}_.globalCompositeOperation="lighter";const T=kn();l.forEach(function(k,O,C){YA(T,k.extent)});let v;const y=t/i,I=(d?1:1+Math.pow(2,-24))/y;if(!f||l.length!==1||c!==0){if(v=et(Math.round(Re(T)*y),Math.round(Ut(T)*y),ji),d||(v.imageSmoothingEnabled=!1),r&&p){const k=(r[0]-T[0])*y,O=-(r[3]-T[3])*y,C=Re(r)*y,E=Ut(r)*y;v.rect(k,O,C,E),v.clip()}l.forEach(function(k,O,C){if(k.image.width>0&&k.image.height>0){if(k.clipExtent){v.save();const L=(k.clipExtent[0]-T[0])*y,A=-(k.clipExtent[3]-T[3])*y,W=Re(k.clipExtent)*y,te=Ut(k.clipExtent)*y;v.rect(d?L:Math.round(L),d?A:Math.round(A),d?W:Math.round(L+W)-Math.round(L),d?te:Math.round(A+te)-Math.round(A)),v.clip()}const E=(k.extent[0]-T[0])*y,R=-(k.extent[3]-T[3])*y,P=Re(k.extent)*y,D=Ut(k.extent)*y;v.drawImage(k.image,c,c,k.image.width-2*c,k.image.height-2*c,d?E:Math.round(E),d?R:Math.round(R),d?P:Math.round(E+P)-Math.round(E),d?D:Math.round(R+D)-Math.round(R)),k.clipExtent&&v.restore()}})}const S=Ns(o);return a.getTriangles().forEach(function(k,O,C){const E=k.source,R=k.target;let P=E[0][0],D=E[0][1],L=E[1][0],A=E[1][1],W=E[2][0],te=E[2][1];const $=w((R[0][0]-S[0])/s),re=w(-(R[0][1]-S[1])/s),U=w((R[1][0]-S[0])/s),X=w(-(R[1][1]-S[1])/s),G=w((R[2][0]-S[0])/s),J=w(-(R[2][1]-S[1])/s),ee=P,he=D;P=0,D=0,L-=ee,A-=he,W-=ee,te-=he;const B=[[L,A,0,0,U-$],[W,te,0,0,G-$],[0,0,L,A,X-re],[0,0,W,te,J-re]],Be=iP(B);if(!Be)return;if(_.save(),_.beginPath(),Wk()||!d){_.moveTo(U,X);const De=4,vn=$-U,Mn=re-X;for(let _t=0;_t<De;_t++)_.lineTo(U+w((_t+1)*vn/De),X+w(_t*Mn/(De-1))),_t!=De-1&&_.lineTo(U+w((_t+1)*vn/De),X+w((_t+1)*Mn/(De-1)));_.lineTo(G,J)}else _.moveTo(U,X),_.lineTo($,re),_.lineTo(G,J);_.clip(),_.transform(Be[0],Be[2],Be[1],Be[3],$,re),_.translate(T[0]-ee,T[3]-he);let Me;if(v)Me=v.canvas,_.scale(I,-I);else{const De=l[0],vn=De.extent;Me=De.image,_.scale(Re(vn)/Me.width,-Ut(vn)/Me.height)}_.drawImage(Me,0,0),_.restore()}),v&&(qo(v),ji.push(v.canvas)),h&&(_.save(),_.globalCompositeOperation="source-over",_.strokeStyle="black",_.lineWidth=1,a.getTriangles().forEach(function(k,O,C){const E=k.target,R=(E[0][0]-S[0])/s,P=-(E[0][1]-S[1])/s,D=(E[1][0]-S[0])/s,L=-(E[1][1]-S[1])/s,A=(E[2][0]-S[0])/s,W=-(E[2][1]-S[1])/s;_.beginPath(),_.moveTo(D,L),_.lineTo(R,P),_.lineTo(A,W),_.closePath(),_.stroke()}),_.restore()),_.canvas}class $k extends lp{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:e.interpolate,transition:e.transition}),this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const t=e.sourceProj,i=t.getExtent(),r=e.sourceTileGrid.getExtent();this.clipExtent_=t.canWrapX()?r?Wn(i,r):i:r;const s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),o=this.targetTileGrid_.getExtent();let a=this.sourceTileGrid_.getExtent();const l=o?Wn(s,o):s;if(Fl(l)===0){this.state=H.EMPTY;return}i&&(a?a=Wn(a,i):a=i);const c=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),h=e.targetProj,d=ZI(t,h,l,c);if(!isFinite(d)||d<=0){this.state=H.EMPTY;return}const f=e.errorThreshold!==void 0?e.errorThreshold:qI;if(this.triangulation_=new YI(t,h,l,a,d*f,c),this.triangulation_.getTriangles().length===0){this.state=H.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(d);let p=this.triangulation_.calculateSourceExtent();if(a&&(t.canWrapX()?(p[1]=Ye(p[1],a[1],a[3]),p[3]=Ye(p[3],a[1],a[3])):p=Wn(p,a)),!Fl(p))this.state=H.EMPTY;else{let _=0,w=0;t.canWrapX()&&(_=Re(i),w=Math.floor((p[0]-i[0])/_)),km(p.slice(),t,!0).forEach(v=>{const y=this.sourceTileGrid_.getTileRangeForExtentAndZ(v,this.sourceZ_),I=e.getTileFunction;for(let S=y.minX;S<=y.maxX;S++)for(let k=y.minY;k<=y.maxY;k++){const O=I(this.sourceZ_,S,k,this.pixelRatio_);if(O){const C=w*_;this.sourceTiles_.push({tile:O,offset:C})}}++w}),this.sourceTiles_.length===0&&(this.state=H.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];let t=!1;if(this.sourceTiles_.forEach(_=>{var re;const w=_.tile;if(!w||w.getState()!==H.LOADED)return;const T=w.getSize(),v=this.gutter_;let y;const I=zk(w.getData());I?y=I:(t=!0,y=Bk(Lh(w.getData())));const S=[T[0]+2*v,T[1]+2*v],k=y instanceof Float32Array,O=S[0]*S[1],C=k?Float32Array:Uint8ClampedArray,E=new C(y.buffer),R=C.BYTES_PER_ELEMENT,P=R*E.length/O,D=E.byteLength/S[1],L=Math.floor(D/R/S[0]),A=O*L;let W=E;if(E.length!==A){W=new C(A);let U=0,X=0;const G=S[0]*L;for(let J=0;J<S[1];++J){for(let ee=0;ee<G;++ee)W[U++]=E[X+ee];X+=D/R}}const te=this.sourceTileGrid_.getTileCoordExtent(w.tileCoord);te[0]+=_.offset,te[2]+=_.offset;const $=(re=this.clipExtent_)==null?void 0:re.slice();$&&($[0]+=_.offset,$[2]+=_.offset),e.push({extent:te,clipExtent:$,data:new Uint8ClampedArray(W.buffer),dataType:C,bytesPerPixel:P,pixelSize:S})}),this.sourceTiles_.length=0,e.length===0){this.state=H.ERROR,this.changed();return}const i=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(i),s=typeof r=="number"?r:r[0],o=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(i),l=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let h,d;const f=e[0].bytesPerPixel,p=Math.ceil(f/3);for(let _=p-1;_>=0;--_){const w=[];for(let k=0,O=e.length;k<O;++k){const C=e[k],E=C.data,R=C.pixelSize,P=R[0],D=R[1],L=et(P,D,ji),A=L.createImageData(P,D),W=A.data;let te=_*3;for(let $=0,re=W.length;$<re;$+=4)W[$]=E[te],W[$+1]=E[te+1],W[$+2]=E[te+2],W[$+3]=255,te+=f;L.putImageData(A,0,0),w.push({extent:C.extent,clipExtent:C.clipExtent,image:L.canvas})}const T=QI(s,o,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),a,c,this.triangulation_,w,this.gutter_,!1,!1,!1);for(let k=0,O=w.length;k<O;++k){const E=w[k].image.getContext("2d");qo(E),ji.push(E.canvas)}const v=T.getContext("2d"),y=v.getImageData(0,0,T.width,T.height);qo(v),ji.push(T),h||(d=new Uint8ClampedArray(f*y.width*y.height),h=new e[0].dataType(d.buffer));const I=y.data;let S=_*3;for(let k=0,O=I.length;k<O;k+=4)I[k+3]===255?(d[S]=I[k],d[S+1]=I[k+1],d[S+2]=I[k+2]):(d[S]=0,d[S+1]=0,d[S+2]=0),S+=f}if(t){const _=et(s,o),w=new ImageData(h,s);_.putImageData(w,0,0),this.reprojData_=_.canvas}else this.reprojData_=h;this.reprojSize_=[Math.round(s*this.pixelRatio_),Math.round(o*this.pixelRatio_)],this.state=H.LOADED,this.changed()}load(){if(this.state!==H.IDLE&&this.state!==H.ERROR)return;this.state=H.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i!==H.IDLE&&i!==H.LOADING)return;e++;const r=ve(t,ue.CHANGE,()=>{const s=t.getState();(s==H.LOADED||s==H.ERROR||s==H.EMPTY)&&(Fe(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t}){t.getState()==H.IDLE&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(Fe),this.sourcesListenerKeys_=null}}class up extends a_{constructor(e,t,i,r,s,o,a,l,c,h,d,f){super(s,H.IDLE,f),this.renderEdges_=d!==void 0?d:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const p=r.getTileCoordExtent(this.wrappedTileCoord_),_=this.targetTileGrid_.getExtent();let w=this.sourceTileGrid_.getExtent();const T=_?Wn(p,_):p;if(Fl(T)===0){this.state=H.EMPTY;return}const v=e.getExtent();v&&(w?w=Wn(w,v):w=v);const y=r.getResolution(this.wrappedTileCoord_[0]),I=ZI(e,i,T,y);if(!isFinite(I)||I<=0){this.state=H.EMPTY;return}const S=h!==void 0?h:qI;if(this.triangulation_=new YI(e,i,T,w,I*S,y),this.triangulation_.getTriangles().length===0){this.state=H.EMPTY;return}this.sourceZ_=t.getZForResolution(I);let k=this.triangulation_.calculateSourceExtent();if(w&&(e.canWrapX()?(k[1]=Ye(k[1],w[1],w[3]),k[3]=Ye(k[3],w[1],w[3])):k=Wn(k,w)),!Fl(k))this.state=H.EMPTY;else{let O=0,C=0;e.canWrapX()&&(O=Re(v),C=Math.floor((k[0]-v[0])/O)),km(k.slice(),e,!0).forEach(R=>{const P=t.getTileRangeForExtentAndZ(R,this.sourceZ_);for(let D=P.minX;D<=P.maxX;D++)for(let L=P.minY;L<=P.maxY;L++){const A=c(this.sourceZ_,D,L,a);if(A){const W=C*O;this.sourceTiles_.push({tile:A,offset:W})}}++C}),this.sourceTiles_.length===0&&(this.state=H.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{var r;const i=t.tile;if(i&&i.getState()==H.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=t.offset,s[2]+=t.offset;const o=(r=this.clipExtent_)==null?void 0:r.slice();o&&(o[0]+=t.offset,o[2]+=t.offset),e.push({extent:s,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=H.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=QI(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=H.LOADED}this.changed()}load(){if(this.state==H.IDLE){this.state=H.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==H.IDLE||i==H.LOADING){e++;const r=ve(t,ue.CHANGE,s=>{const o=t.getState();(o==H.LOADED||o==H.ERROR||o==H.EMPTY)&&(Fe(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==H.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Fe),this.sourcesListenerKeys_=null}release(){this.canvas_&&(qo(this.canvas_.getContext("2d")),ji.push(this.canvas_),this.canvas_=null),super.release()}}function $f(n,e,t,i){return`${n},${Ok(e,t,i)}`}function Kf(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function Kk(n,e,t){const i=n[t];return i?i.delete(e):!1}function f1(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Wn(e,Ir(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=Wn(e,r))}return e}class Xk extends jI{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=kn(),this.tempTileRange_=new l_(0,0,0,0),this.tempTileCoord_=kh(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new Mk(i),this.renderedProjection_=void 0,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=$f(a.getKey(),e,t,i);let c;if(s.containsKey(l))c=s.get(l);else{if(c=a.getTile(e,t,i,r.pixelRatio,r.viewState.projection),!c)return null;s.set(l,c)}return c}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Tt(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!Ko(s,r))return null;const o=t.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const d=l.getTileCoordForCoordAndZ(r,h),f=this.getTile(h,d[1],d[2],t);if(!f||f.getState()!==H.LOADED)continue;const p=l.getOrigin(h),_=rn(l.getTileSize(h)),w=l.getResolution(h);let T;if(f instanceof HI||f instanceof up)T=f.getImage();else if(f instanceof lp){if(T=Lh(f.getData()),!T)continue}else continue;const v=Math.floor(c*((r[0]-p[0])/w-d[1]*_[0])),y=Math.floor(c*((p[1]-r[1])/w-d[2]*_[1])),I=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(T,v+I,y+I)}return null}prepareFrame(e){this.renderedProjection_?e.viewState.projection!==this.renderedProjection_&&(this.tileCache_.clear(),this.renderedProjection_=e.viewState.projection):this.renderedProjection_=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedRevision_?this.renderedRevision_!==i&&(this.renderedRevision_=i,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedRevision_=i,!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=xe(l);h in e.wantedTiles||(e.wantedTiles[h]={});const d=e.wantedTiles[h],f=a.getMapInternal(),p=Math.max(i-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection));for(let _=i;_>=p;--_){const w=c.getTileRangeForExtentAndZ(t,_,this.tempTileRange_),T=c.getResolution(_);for(let v=w.minX;v<=w.maxX;++v)for(let y=w.minY;y<=w.maxY;++y){const I=this.getTile(_,v,y,e);if(!I||!Kf(r,I,_))continue;const k=I.getKey();if(d[k]=!0,I.getState()===H.IDLE&&!e.tileQueue.isKeyQueued(k)){const O=kh(_,v,y,this.tempTileCoord_);e.tileQueue.enqueue([I,h,c.getTileCoordCenter(O),T])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=$f(a[l],r,s,o);if(i.containsKey(c)){const h=i.get(c);if(h.getState()===H.LOADED)return h.endTransition(xe(this)),Kf(t,h,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,c=this.getLayer().getRenderSource().getKey();for(let h=s.minX;h<=s.maxX;++h)for(let d=s.minY;d<=s.maxY;++d){const f=$f(c,i,h,d);let p=!1;if(a.containsKey(f)){const _=a.get(f);_.getState()===H.LOADED&&(Kf(r,_,i),p=!0)}p||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),d=h.getRevision(),f=h.getTileGridForProjection(s),p=f.getZForResolution(o,h.zDirection),_=f.getResolution(p),w=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==w&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=w):this.renderedSourceKey_=w;let T=e.extent;const v=h.getTilePixelRatio(l);this.prepareContainer(e,t);const y=this.context.canvas.width,I=this.context.canvas.height,S=i.extent&&Ir(i.extent);S&&(T=Wn(T,Ir(i.extent)));const k=_*y/2/v,O=_*I/2/v,C=[a[0]-k,a[1]-O,a[0]+k,a[1]+O],E={};this.renderedTiles.length=0;const R=c.getPreload();if(e.nextExtent){const G=f.getZForResolution(r.nextResolution,h.zDirection),J=f1(e,e.nextExtent);this.enqueueTiles(e,J,G,E,R)}const P=f1(e,T);if(this.enqueueTiles(e,P,p,E,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,P,p-1,E,R-1)},0),!(p in E))return this.container;const D=xe(this),L=e.time;for(const G of E[p]){const J=G.getState();if((G instanceof up||G instanceof $k)&&J===H.EMPTY)continue;const ee=G.tileCoord;if(J===H.LOADED&&G.getAlpha(D,L)===1){G.endTransition(D);continue}if(this.renderComplete=!1,this.findStaleTile_(ee,E)){Kk(E,G,p),e.animate=!0;continue}if(this.findAltTiles_(f,ee,p+1,E))continue;const Be=f.getMinZoom();for(let Me=p-1;Me>=Be&&!this.findAltTiles_(f,ee,Me,E);--Me);}const A=_/o*l/v,W=this.getRenderContext(e);Xi(this.tempTransform,y/2,I/2,A,A,0,-y/2,-I/2),i.extent&&this.clipUnrotated(W,e,S),h.getInterpolate()||(W.imageSmoothingEnabled=!1),this.preRender(W,e);const te=Object.keys(E).map(Number);te.sort(Vi);let $;const re=[],U=[];for(let G=te.length-1;G>=0;--G){const J=te[G],ee=h.getTilePixelSize(J,l,s),B=f.getResolution(J)/_,Be=ee[0]*B*A,Me=ee[1]*B*A,De=f.getTileCoordForCoordAndZ(Ns(C),J),vn=f.getTileCoordExtent(De),Mn=Tt(this.tempTransform,[v*(vn[0]-C[0])/_,v*(C[3]-vn[3])/_]),_t=v*h.getGutterForProjection(s);for(const ln of E[J]){if(ln.getState()!==H.LOADED)continue;const vi=ln.tileCoord,er=De[1]-vi[1],es=Math.round(Mn[0]-(er-1)*Be),Ei=De[2]-vi[2],Qn=Math.round(Mn[1]-(Ei-1)*Me),Ht=Math.round(Mn[0]-er*Be),En=Math.round(Mn[1]-Ei*Me),wi=es-Ht,Jn=Qn-En,tr=te.length===1;let Ti=!1;$=[Ht,En,Ht+wi,En,Ht+wi,En+Jn,Ht,En+Jn];for(let ei=0,ti=re.length;ei<ti;++ei)if(!tr&&J<U[ei]){const Ze=re[ei];en([Ht,En,Ht+wi,En+Jn],[Ze[0],Ze[3],Ze[4],Ze[7]])&&(Ti||(W.save(),Ti=!0),W.beginPath(),W.moveTo($[0],$[1]),W.lineTo($[2],$[3]),W.lineTo($[4],$[5]),W.lineTo($[6],$[7]),W.moveTo(Ze[6],Ze[7]),W.lineTo(Ze[4],Ze[5]),W.lineTo(Ze[2],Ze[3]),W.lineTo(Ze[0],Ze[1]),W.clip())}re.push($),U.push(J),this.drawTile(ln,e,Ht,En,wi,Jn,_t,tr),Ti&&W.restore(),this.renderedTiles.unshift(ln),this.updateUsedTiles(e.usedTiles,h,ln)}}this.renderedRevision=d,this.renderedResolution=_,this.extentChanged=!this.renderedExtent_||!Nl(this.renderedExtent_,C),this.renderedExtent_=C,this.renderedPixelRatio=l,this.renderedProjection=s,this.postRender(this.context,e),i.extent&&W.restore(),W.imageSmoothingEnabled=!0;const X=(G,J)=>{const ee=xe(h),he=J.wantedTiles[ee],B=he?Object.keys(he).length:0;this.updateCacheSize(B),this.tileCache_.expireCache()};return e.postRenderFunctions.push(X),this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,a,l){let c;if(e instanceof lp){if(c=Lh(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),d=xe(this),f=t.layerStatesArray[t.layerIndex],p=f.opacity*(l?e.getAlpha(d,t.time):1),_=p!==h.globalAlpha;_&&(h.save(),h.globalAlpha=p),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,r,s,o),_&&h.restore(),p!==f.opacity?t.animate=!0:l&&e.endTransition(d)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=xe(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}class Hk extends Vk{constructor(e){super(e)}createRenderer(){return new Xk(this,{cacheSize:this.getCacheSize()})}}const Xf={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},eo=[0,0,0],dr=5;class JI{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Ie(mP(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Ie(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Ns(i)),Ie(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Ie(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Vm,Ie(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new l_(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,r);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Qs(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,c,i),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Qs(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Qs(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-r),c=Math.floor(s*l),h=Math.floor(o*l);if(t<r)return Qs(c,c,h,h,i);const d=Math.floor(l*(s+1))-1,f=Math.floor(l*(o+1))-1;return Qs(c,d,h,f,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,eo);const r=eo[1],s=eo[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,eo);const o=eo[1],a=eo[2];return Qs(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=rn(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=rn(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,l=o+s[0]*r,c=a+s[1]*r;return jr(o,a,l,c,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),c=rn(this.getTileSize(o),this.tmpSize_);let h=a*(e-l[0])/i/c[0],d=a*(l[1]-t)/i/c[1];return r?(h=fc(h,dr)-1,d=fc(d,dr)-1):(h=dc(h,dr),d=dc(d,dr)),kh(o,h,d,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=rn(this.getTileSize(i),this.tmpSize_);let c=(e-o[0])/a/l[0],h=(o[1]-t)/a/l[1];return r?(c=fc(c,dr)-1,h=fc(h,dr)-1):(c=dc(c,dr),h=dc(h,dr)),kh(i,c,h,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=bm(this.resolutions_,e,t||0);return Ye(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return cI(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function e2(n){let e=n.getDefaultTileGrid();return e||(e=Qk(n),n.setDefaultTileGrid(e)),e}function qk(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=u_(t);if(!Ko(s,r)){const o=Re(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function Yk(n,e,t,i){i=i!==void 0?i:"top-left";const r=t2(n,e,t);return new JI({extent:n,origin:QA(n,i),resolutions:r,tileSize:t})}function Zk(n){const e=n||{},t=e.extent||Ln("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:t2(t,e.maxZoom,e.tileSize,e.maxResolution)};return new JI(i)}function t2(n,e,t,i){e=e!==void 0?e:EP,t=rn(t!==void 0?t:Vm);const r=Ut(n),s=Re(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function Qk(n,e,t,i){const r=u_(n);return Yk(r,e,t,i)}function u_(n){n=Ln(n);let e=n.getExtent();if(!e){const t=180*Sm.degrees/n.getMetersPerUnit();e=jr(-t,-t,t,t)}return e}class Jk extends XI{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&rn(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||xe(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s){return Te()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:e2(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=rn(r.getTileSize(e),this.tmpSize);return s==1?o:s4(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){t=t!==void 0?t:this.getProjection();const i=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=qk(i,e,t)),bk(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class eL extends Qi{constructor(e,t){super(e),this.tile=t}}const tL=/\{z\}/g,nL=/\{x\}/g,iL=/\{y\}/g,rL=/\{-y\}/g;function sL(n,e,t,i,r){return n.replace(tL,e.toString()).replace(nL,t.toString()).replace(iL,i.toString()).replace(rL,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function oL(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function aL(n,e){return function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return sL(n,o,t[1],t[2],s)}}function lL(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=aL(n[r],e);return uL(i)}function uL(n){return n.length===1?n[0]:function(e,t,i){if(!e)return;const r=Nk(e),s=Oo(r,n.length);return n[s](e,t,i)}}class c_ extends Jk{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===c_.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=xe(t),r=t.getState();let s;r==H.LOADING?(this.tileLoadingKeys_[i]=!0,s=Xf.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==H.ERROR?Xf.TILELOADERROR:r==H.LOADED?Xf.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new eL(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=oL(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(lL(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class cL extends c_{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:hL,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:HI,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Pf(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Pf(t,e)))return this.tileGrid;const i=xe(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=e2(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,r,s):void 0,h=new this.tileClass(a,c!==void 0?H.IDLE:H.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(ue.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,i,r,s){const o=this.getProjection();if(!o||!s||Pf(o,s))return this.getTileInternal(e,t,i,r,o||s);const a=[e,t,i],l=this.getKey(),c=this.getTileGridForProjection(o),h=this.getTileGridForProjection(s),d=this.getTileCoordForTileUrlFunction(a,s),f=new up(o,c,s,h,a,d,this.getTilePixelRatio(r),this.getGutter(),(p,_,w,T)=>this.getTileInternal(p,_,w,T,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=l,f}getTileInternal(e,t,i,r,s){const o=this.getKey();return this.createTile_(e,t,i,r,s,o)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=Ln(e);if(i){const r=xe(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function hL(n,e){n.getImage().src=e}class dL extends cL{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:Zk({extent:u_(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const fL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAqCAQAAABFevB/AAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAACYktHRAD/h4/MvwAAAAd0SU1FB+gMAgICOECKGLcAAATlSURBVFjD7ZZZbFVVFIa/vc9we4G2tGWyLVWx1Yg0asFEEE1EI0GhCAmGBwUSoqIkPFiKBOIDiZQhYiKDBDWCE/JAxKkSYi0RGRTb0AcQNIymVuaheLnDuWcvH4rlFnubc5vrm+vt/Gud/9//XmeftRWBYxFJNDHcweZpplAlhcB5mtmmv0ieczDMpDIwmwpaKMxH0UdHqqllFG5KKsF+VubUJ4xmRWBhK2hhAkG5Xg1vUn7TWxZlPJmMuz+LGcuegHw6WNkqLOZiXpIl5HVbkM/r8RebsViTXcf34tH0sKxNIwvgUFW8J9l6mX3ZdOzSJyTzGNhj0RCZF3LdYITBhL8hQbxSxqVAUbWZ2cxmC7EboDzuDff4KnvCE/AwYyjsBBIscWfJ+/K+O5OleJ34QBntMyl7wus4DRUpwH693vM0Cj9hr6P5RkJVXGJj9oSFWYr8FOCQ357HG6wixPlLHLmRMPmbOBNI2A5UxXhp8FIe83N1zNRh006JFUlZkvKmBKQM5HgwL6PaUoCxkfuiXOQc14iO4sGUTFspI7InbAgjB1I+olJZqx8lX/L1Y2Y1t3TicQ64mEDCAbfagn1yJGUGjJbPOApUdOn9Yf2T8Ff2HE8nj8ifanMXsD+jGNVFFj5OnA3zTPaEIUZf9Ee09FjUpDfbxIMRBv1X7+IJRl61PZ5Ku9SEWuzvOcW7AYUDOlbUEcbaSmPakga9zWZ4QNkM5vF3VEFcX6CaUDfpK7rGHDEZXAQCOgYoxcVtYFu3ya3OTpuC4GSZCL+KT8LTazj9r9Qfam086fPafyMM5dhMbGLTzbja2NjSj4cyoQp+2euIWgR1u6nn7hTwoDWRUw5LM2LKyDGMYyjRE2p9yn/RV2/HTt2VwcW2V8ITOEsYtZm9ndBuvSXEcaZnKBz4OP0TP1CJHdVXmYQDXFO1yZY4qzKlydQxQDEWup7tAOpre4eTMp6CR4YfV0fUAOoR+Ryjqs1en7d6wdELxzAEh/BuPuWToh/DjOkNRe8cw3x8dCmGNofl3eTrUNfJF6ZhCHgRuDlCRCk6Z/s+ud3mBdEqhzh+xo6XcYxCDBZR+uADDgZNmAgQw2h3qXU49mEIg0USGx9wsbkGaChmpVrOwXRjI22PT5IP/bmTXAdbcysldZBPEZrB9HGxlNxjhhooopwcha0po7RAtcIQym1bcvyRfm5aw+m3Og9d7q8Qx484C2KTmYaZv9obZpXIEn+D2mC2W4hPMlzl16l+/iFrUWwaz6LPrBlw3tRgJ5r0B/hI+malcSwI3EGl3sH3lMlcdnGcOQyVQVhSIn0hCaDNHPW79Twj5Tlm6zXWSj3Q8vVO3cxkM6jn62barbbQLeodGSvV/hD6yW20q0YMokyHDw8R0VLAyam/ctkUK8ccC3/r1Hv3+6OVC6J78tvDViexRsgDNKuZOmL2qxyi0qoumvHtCylFwCOkVJJGmbF1gBTqL6WMVyK2Okqh6msscZUluqfDmlZYwz6KVIUssBv8w0zBkWZ9BkdgsWoRlFHvcZpfuCLD1Lzfdle0qql4bCVHTZV21ayOs4wT6YXTrqkWRRIPlxBxfAQbjdfRBAwXKMACfAwOxbSRpOPIJbFQKAwK0o6PHjZjEyB0tNTu6Op1qRc6azYCQhjNFWwUPv2JoIAZ/B9d42+lZK/xMVKthQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyNC0xMi0wMlQwMjowMjo0NSswMDowMHSVqQ0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjQtMTItMDJUMDI6MDI6NDUrMDA6MDAFyBGxAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDI0LTEyLTAyVDAyOjAyOjU2KzAwOjAwr58qbQAAAABJRU5ErkJggg==";function gL({rota:n}){const e=Y.useRef(null),t=Y.useRef(null);function i(s,o){var a=new r1({source:new u1,style:new Bi({image:new _u({anchor:[.5,1],src:fL})})});s.addLayer(a);var l=new Ah(new wd(o));const c=a.getSource();return c&&c.addFeature(l),window.setTimeout(()=>{c.clear(),i(s,No.PosAtual)},500),l}function r(s,o){const a=new Ph(o),l=new Ah({geometry:a}),c=new Bi({stroke:new mu({color:"blue",width:4})});l.setStyle(c);const h=new r1({source:new u1({features:[l]})});s.addLayer(h),t.current=h}return Y.useEffect(()=>{const s=new XD({target:"map",layers:[new Hk({source:new dL({url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png"})})],view:new ai({center:No.PosAtual,zoom:16.4})});return e.current=s,()=>{s.setTarget(void 0)}},[]),Y.useEffect(()=>{e.current&&n&&(t.current&&e.current.removeLayer(t.current),r(e.current,n),i(e.current,No.PosAtual)),console.log(n)},[n]),b.jsx("div",{className:"map",id:"map",style:{width:"100%",height:"500px"}})}function pL(){const[n,e]=Y.useState(No.getRotaByName("")),t=No.RotasNome;function i(r){const s=r.target,o=s.options[s.selectedIndex].value;e(No.getRotaByName(o))}return b.jsxs("div",{className:"Rotas",children:[b.jsx(hu,{titulo:"Rotas",children:b.jsx(BT,{onchangeHandler:i,options:t,nomeInput:"Selecione uma Rota"})}),b.jsx("main",{children:b.jsx("div",{className:"Pontos",children:b.jsx(gL,{rota:n})})})]})}function mL(){const n=NT();function e(t){n(t)}return b.jsxs("div",{className:"termos",children:[b.jsx(hu,{titulo:"Termos de Uso",children:null}),b.jsx("main",{children:b.jsxs("div",{className:"Container",children:[b.jsx("p",{children:"Bem-vindo à Circular UFJF. Ao utilizar nossos serviços, você concorda com os seguintes termos e condições:"}),b.jsxs("ul",{children:[b.jsx("li",{children:"Uso Apropriado: O aplicativo deve ser utilizado apenas para fins lícitos. Você deve cumprir todas as leis, regulamentos e normas locais aplicáveis ao usar nosso serviço."}),b.jsx("li",{children:"Alterações nos Serviços: Reservamo-nos o direito de modificar, suspender ou descontinuar, temporária ou permanentemente, qualquer funcionalidade do aplicativo sem aviso prévio."}),b.jsx("li",{children:"Isenção de Responsabilidade: As informações disponibilizadas têm caráter informativo e não garantimos sua total precisão ou atualidade. Não somos responsáveis por danos diretos ou indiretos resultantes do uso do aplicativo ou das informações fornecidas."}),b.jsx("li",{children:"Segurança de Dados: Estamos comprometidos em proteger sua privacidade e seus dados. No entanto, o uso da internet pode implicar riscos, e você é responsável por garantir a segurança do seu dispositivo."}),b.jsx("li",{children:"Contato para Suporte: Para quaisquer dúvidas, problemas técnicos ou esclarecimentos sobre o uso do aplicativo, entre em contato com nossa equipe de suporte por meio dos canais fornecidos."})]}),b.jsx("p",{children:"O uso contínuo do Cade Circular UFJF implica na aceitação integral desses termos. É sua responsabilidade revisá-los regularmente, pois eles podem ser atualizados periodicamente."}),b.jsx("button",{onClick:()=>{e("/CadeCircularUfjf/rotas")},className:"aceitar-button",children:"Aceitar"})]})})]})}function _L(){return b.jsxs("div",{className:"Home",children:[b.jsx(hu,{titulo:"Home",children:null}),b.jsx("main",{children:b.jsxs("div",{className:"Container",children:[b.jsx("h1",{children:"Bem-vindo!"}),b.jsxs("ol",{children:[b.jsx("li",{children:b.jsx("p",{children:"Este projeto foi desenvolvido  para simplificar e interpretar informações sobre o Circular da UFJF, promovendo mais praticidade e bem-estar para a comunidade acadêmica como um todo."})}),b.jsxs("li",{className:"Tutorial",children:[b.jsx("img",{src:zT,alt:"Previsão Icon"}),b.jsxs("p",{children:["Na aba ",b.jsx("strong",{children:"Rotas"}),", você encontrará uma lista das rotas atuais, além de sua visualização em um mapa dinâmico e interativo."]})]}),b.jsxs("li",{className:"Tutorial",children:[b.jsx("img",{src:VT,alt:"Previsão Icon"}),b.jsxs("p",{children:["Na aba ",b.jsx("strong",{children:"Previsões"}),", você pode consultar os horários previstos dos ônibus, organizados de acordo com o ponto de sua escolha."]})]}),b.jsxs("li",{className:"Tutorial",children:[b.jsx("img",{src:UT,alt:"Previsão Icon"}),b.jsxs("p",{children:["Na aba ",b.jsx("strong",{children:"Chat"}),", você tem um chat em tempo real para tirar dúvidas e compartilhar informações com outros usuários."]})]}),b.jsx("li",{className:"Tutorial",children:b.jsxs("p",{children:["Este é um projeto de código aberto,  sem fins lucrativos, desenvolvido por alunos sem vÍnculo oficial com a UFJF, baseado exclusivamente em informações públicas fornecidas pela UFJF, disponíveis no site oficial:",b.jsx("a",{href:"https://www2.ufjf.br/transporte/veiculos/onibus-circular/",target:"_blank",children:"https://www2.ufjf.br/transporte/veiculos/onibus-circular/"}),"."]})})]}),b.jsxs("p",{className:"Creditos",children:["Idealizado por",b.jsx("a",{href:"https://github.com/Miguel-Dias-112/",children:"Miguel Dias"}),b.jsx("a",{href:"https://github.com/TheDevCaio",children:"Caio Machado"})]})]})})]})}var g1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},yL=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},i2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,h=s>>2,d=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(f=64)),i.push(t[h],t[d],t[f],t[p])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(n2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yL(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const c=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||c==null||d==null)throw new vL;const f=s<<2|a>>4;if(i.push(f),c!==64){const p=a<<4&240|c>>2;if(i.push(p),d!==64){const _=c<<6&192|d;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class vL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const EL=function(n){const e=n2(n);return i2.encodeByteArray(e,!0)},Mh=function(n){return EL(n).replace(/\./g,"")},wL=function(n){try{return i2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL=()=>TL().__FIREBASE_DEFAULTS__,CL=()=>{if(typeof process>"u"||typeof g1>"u")return;const n=g1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},RL=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wL(n[1]);return e&&JSON.parse(e)},h_=()=>{try{return IL()||CL()||RL()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},xL=n=>{var e,t;return(t=(e=h_())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},SL=n=>{const e=xL(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},r2=()=>{var n;return(n=h_())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Mh(JSON.stringify(t)),Mh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kL(){var n;const e=(n=h_())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function LL(){return!kL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ML(){try{return typeof indexedDB=="object"}catch{return!1}}function OL(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL="FirebaseError";class fa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=NL,Object.setPrototypeOf(this,fa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,s2.prototype.create)}}class s2{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?FL(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new fa(r,a,i)}}function FL(n,e){return n.replace(bL,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const bL=/\{\$([^}]+)}/g;function cp(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(p1(s)&&p1(o)){if(!cp(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function p1(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(n){return n&&n._delegate?n._delegate:n}class ql{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new AL;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(UL(e))try{this.getOrInitializeService({instanceIdentifier:hs})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=hs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=hs){return this.instances.has(e)}getOptions(e=hs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:zL(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=hs){return this.component?this.component.multipleInstances?e:hs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zL(n){return n===hs?void 0:n}function UL(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VL(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ye||(ye={}));const jL={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},GL=ye.INFO,WL={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},$L=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=WL[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class o2{constructor(e){this.name=e,this._logLevel=GL,this._logHandler=$L,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const KL=(n,e)=>e.some(t=>n instanceof t);let m1,_1;function XL(){return m1||(m1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HL(){return _1||(_1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const a2=new WeakMap,hp=new WeakMap,l2=new WeakMap,Hf=new WeakMap,d_=new WeakMap;function qL(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Nr(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&a2.set(t,n)}).catch(()=>{}),d_.set(e,n),e}function YL(n){if(hp.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});hp.set(n,e)}let dp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return hp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||l2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Nr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ZL(n){dp=n(dp)}function QL(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(qf(this),e,...t);return l2.set(i,e.sort?e.sort():[e]),Nr(i)}:HL().includes(n)?function(...e){return n.apply(qf(this),e),Nr(a2.get(this))}:function(...e){return Nr(n.apply(qf(this),e))}}function JL(n){return typeof n=="function"?QL(n):(n instanceof IDBTransaction&&YL(n),KL(n,XL())?new Proxy(n,dp):n)}function Nr(n){if(n instanceof IDBRequest)return qL(n);if(Hf.has(n))return Hf.get(n);const e=JL(n);return e!==n&&(Hf.set(n,e),d_.set(e,n)),e}const qf=n=>d_.get(n);function eM(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Nr(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Nr(o.result),l.oldVersion,l.newVersion,Nr(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const tM=["get","getKey","getAll","getAllKeys","count"],nM=["put","add","delete","clear"],Yf=new Map;function y1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Yf.get(e))return Yf.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=nM.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||tM.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return Yf.set(e,s),s}ZL(n=>({...n,get:(e,t,i)=>y1(e,t)||n.get(e,t,i),has:(e,t)=>!!y1(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(rM(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function rM(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const fp="@firebase/app",v1="0.10.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=new o2("@firebase/app"),sM="@firebase/app-compat",oM="@firebase/analytics-compat",aM="@firebase/analytics",lM="@firebase/app-check-compat",uM="@firebase/app-check",cM="@firebase/auth",hM="@firebase/auth-compat",dM="@firebase/database",fM="@firebase/data-connect",gM="@firebase/database-compat",pM="@firebase/functions",mM="@firebase/functions-compat",_M="@firebase/installations",yM="@firebase/installations-compat",vM="@firebase/messaging",EM="@firebase/messaging-compat",wM="@firebase/performance",TM="@firebase/performance-compat",IM="@firebase/remote-config",CM="@firebase/remote-config-compat",RM="@firebase/storage",xM="@firebase/storage-compat",SM="@firebase/firestore",AM="@firebase/vertexai",PM="@firebase/firestore-compat",DM="firebase",kM="11.0.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="[DEFAULT]",LM={[fp]:"fire-core",[sM]:"fire-core-compat",[aM]:"fire-analytics",[oM]:"fire-analytics-compat",[uM]:"fire-app-check",[lM]:"fire-app-check-compat",[cM]:"fire-auth",[hM]:"fire-auth-compat",[dM]:"fire-rtdb",[fM]:"fire-data-connect",[gM]:"fire-rtdb-compat",[pM]:"fire-fn",[mM]:"fire-fn-compat",[_M]:"fire-iid",[yM]:"fire-iid-compat",[vM]:"fire-fcm",[EM]:"fire-fcm-compat",[wM]:"fire-perf",[TM]:"fire-perf-compat",[IM]:"fire-rc",[CM]:"fire-rc-compat",[RM]:"fire-gcs",[xM]:"fire-gcs-compat",[SM]:"fire-fst",[PM]:"fire-fst-compat",[AM]:"fire-vertex","fire-js":"fire-js",[DM]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=new Map,MM=new Map,pp=new Map;function E1(n,e){try{n.container.addComponent(e)}catch(t){Hi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Nh(n){const e=n.name;if(pp.has(e))return Hi.debug(`There were multiple attempts to register component ${e}.`),!1;pp.set(e,n);for(const t of Oh.values())E1(t,n);for(const t of MM.values())E1(t,n);return!0}function OM(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fr=new s2("app","Firebase",NM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ql("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bM=kM;function u2(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:gp,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Fr.create("bad-app-name",{appName:String(r)});if(t||(t=r2()),!t)throw Fr.create("no-options");const s=Oh.get(r);if(s){if(cp(t,s.options)&&cp(i,s.config))return s;throw Fr.create("duplicate-app",{appName:r})}const o=new BL(r);for(const l of pp.values())o.addComponent(l);const a=new FM(t,i,o);return Oh.set(r,a),a}function VM(n=gp){const e=Oh.get(n);if(!e&&n===gp&&r2())return u2();if(!e)throw Fr.create("no-app",{appName:n});return e}function Fo(n,e,t){var i;let r=(i=LM[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hi.warn(a.join(" "));return}Nh(new ql(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM="firebase-heartbeat-database",UM=1,Yl="firebase-heartbeat-store";let Zf=null;function c2(){return Zf||(Zf=eM(zM,UM,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Yl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Fr.create("idb-open",{originalErrorMessage:n.message})})),Zf}async function BM(n){try{const t=(await c2()).transaction(Yl),i=await t.objectStore(Yl).get(h2(n));return await t.done,i}catch(e){if(e instanceof fa)Hi.warn(e.message);else{const t=Fr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Hi.warn(t.message)}}}async function w1(n,e){try{const i=(await c2()).transaction(Yl,"readwrite");await i.objectStore(Yl).put(e,h2(n)),await i.done}catch(t){if(t instanceof fa)Hi.warn(t.message);else{const i=Fr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Hi.warn(i.message)}}}function h2(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM=1024,GM=30*24*60*60*1e3;class WM{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new KM(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=T1();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=GM}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Hi.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=T1(),{heartbeatsToSend:i,unsentEntries:r}=$M(this._heartbeatsCache.heartbeats),s=Mh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Hi.warn(t),""}}}function T1(){return new Date().toISOString().substring(0,10)}function $M(n,e=jM){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),I1(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),I1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class KM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ML()?OL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await BM(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return w1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return w1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function I1(n){return Mh(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(n){Nh(new ql("platform-logger",e=>new iM(e),"PRIVATE")),Nh(new ql("heartbeat",e=>new WM(e),"PRIVATE")),Fo(fp,v1,n),Fo(fp,v1,"esm2017"),Fo("fire-js","")}XM("");var C1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Is,d2;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,E){function R(){}R.prototype=E.prototype,C.D=E.prototype,C.prototype=new R,C.prototype.constructor=C,C.C=function(P,D,L){for(var A=Array(arguments.length-2),W=2;W<arguments.length;W++)A[W-2]=arguments[W];return E.prototype[D].apply(P,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,E,R){R||(R=0);var P=Array(16);if(typeof E=="string")for(var D=0;16>D;++D)P[D]=E.charCodeAt(R++)|E.charCodeAt(R++)<<8|E.charCodeAt(R++)<<16|E.charCodeAt(R++)<<24;else for(D=0;16>D;++D)P[D]=E[R++]|E[R++]<<8|E[R++]<<16|E[R++]<<24;E=C.g[0],R=C.g[1],D=C.g[2];var L=C.g[3],A=E+(L^R&(D^L))+P[0]+3614090360&4294967295;E=R+(A<<7&4294967295|A>>>25),A=L+(D^E&(R^D))+P[1]+3905402710&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(R^L&(E^R))+P[2]+606105819&4294967295,D=L+(A<<17&4294967295|A>>>15),A=R+(E^D&(L^E))+P[3]+3250441966&4294967295,R=D+(A<<22&4294967295|A>>>10),A=E+(L^R&(D^L))+P[4]+4118548399&4294967295,E=R+(A<<7&4294967295|A>>>25),A=L+(D^E&(R^D))+P[5]+1200080426&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(R^L&(E^R))+P[6]+2821735955&4294967295,D=L+(A<<17&4294967295|A>>>15),A=R+(E^D&(L^E))+P[7]+4249261313&4294967295,R=D+(A<<22&4294967295|A>>>10),A=E+(L^R&(D^L))+P[8]+1770035416&4294967295,E=R+(A<<7&4294967295|A>>>25),A=L+(D^E&(R^D))+P[9]+2336552879&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(R^L&(E^R))+P[10]+4294925233&4294967295,D=L+(A<<17&4294967295|A>>>15),A=R+(E^D&(L^E))+P[11]+2304563134&4294967295,R=D+(A<<22&4294967295|A>>>10),A=E+(L^R&(D^L))+P[12]+1804603682&4294967295,E=R+(A<<7&4294967295|A>>>25),A=L+(D^E&(R^D))+P[13]+4254626195&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(R^L&(E^R))+P[14]+2792965006&4294967295,D=L+(A<<17&4294967295|A>>>15),A=R+(E^D&(L^E))+P[15]+1236535329&4294967295,R=D+(A<<22&4294967295|A>>>10),A=E+(D^L&(R^D))+P[1]+4129170786&4294967295,E=R+(A<<5&4294967295|A>>>27),A=L+(R^D&(E^R))+P[6]+3225465664&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^R&(L^E))+P[11]+643717713&4294967295,D=L+(A<<14&4294967295|A>>>18),A=R+(L^E&(D^L))+P[0]+3921069994&4294967295,R=D+(A<<20&4294967295|A>>>12),A=E+(D^L&(R^D))+P[5]+3593408605&4294967295,E=R+(A<<5&4294967295|A>>>27),A=L+(R^D&(E^R))+P[10]+38016083&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^R&(L^E))+P[15]+3634488961&4294967295,D=L+(A<<14&4294967295|A>>>18),A=R+(L^E&(D^L))+P[4]+3889429448&4294967295,R=D+(A<<20&4294967295|A>>>12),A=E+(D^L&(R^D))+P[9]+568446438&4294967295,E=R+(A<<5&4294967295|A>>>27),A=L+(R^D&(E^R))+P[14]+3275163606&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^R&(L^E))+P[3]+4107603335&4294967295,D=L+(A<<14&4294967295|A>>>18),A=R+(L^E&(D^L))+P[8]+1163531501&4294967295,R=D+(A<<20&4294967295|A>>>12),A=E+(D^L&(R^D))+P[13]+2850285829&4294967295,E=R+(A<<5&4294967295|A>>>27),A=L+(R^D&(E^R))+P[2]+4243563512&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^R&(L^E))+P[7]+1735328473&4294967295,D=L+(A<<14&4294967295|A>>>18),A=R+(L^E&(D^L))+P[12]+2368359562&4294967295,R=D+(A<<20&4294967295|A>>>12),A=E+(R^D^L)+P[5]+4294588738&4294967295,E=R+(A<<4&4294967295|A>>>28),A=L+(E^R^D)+P[8]+2272392833&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^R)+P[11]+1839030562&4294967295,D=L+(A<<16&4294967295|A>>>16),A=R+(D^L^E)+P[14]+4259657740&4294967295,R=D+(A<<23&4294967295|A>>>9),A=E+(R^D^L)+P[1]+2763975236&4294967295,E=R+(A<<4&4294967295|A>>>28),A=L+(E^R^D)+P[4]+1272893353&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^R)+P[7]+4139469664&4294967295,D=L+(A<<16&4294967295|A>>>16),A=R+(D^L^E)+P[10]+3200236656&4294967295,R=D+(A<<23&4294967295|A>>>9),A=E+(R^D^L)+P[13]+681279174&4294967295,E=R+(A<<4&4294967295|A>>>28),A=L+(E^R^D)+P[0]+3936430074&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^R)+P[3]+3572445317&4294967295,D=L+(A<<16&4294967295|A>>>16),A=R+(D^L^E)+P[6]+76029189&4294967295,R=D+(A<<23&4294967295|A>>>9),A=E+(R^D^L)+P[9]+3654602809&4294967295,E=R+(A<<4&4294967295|A>>>28),A=L+(E^R^D)+P[12]+3873151461&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^R)+P[15]+530742520&4294967295,D=L+(A<<16&4294967295|A>>>16),A=R+(D^L^E)+P[2]+3299628645&4294967295,R=D+(A<<23&4294967295|A>>>9),A=E+(D^(R|~L))+P[0]+4096336452&4294967295,E=R+(A<<6&4294967295|A>>>26),A=L+(R^(E|~D))+P[7]+1126891415&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~R))+P[14]+2878612391&4294967295,D=L+(A<<15&4294967295|A>>>17),A=R+(L^(D|~E))+P[5]+4237533241&4294967295,R=D+(A<<21&4294967295|A>>>11),A=E+(D^(R|~L))+P[12]+1700485571&4294967295,E=R+(A<<6&4294967295|A>>>26),A=L+(R^(E|~D))+P[3]+2399980690&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~R))+P[10]+4293915773&4294967295,D=L+(A<<15&4294967295|A>>>17),A=R+(L^(D|~E))+P[1]+2240044497&4294967295,R=D+(A<<21&4294967295|A>>>11),A=E+(D^(R|~L))+P[8]+1873313359&4294967295,E=R+(A<<6&4294967295|A>>>26),A=L+(R^(E|~D))+P[15]+4264355552&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~R))+P[6]+2734768916&4294967295,D=L+(A<<15&4294967295|A>>>17),A=R+(L^(D|~E))+P[13]+1309151649&4294967295,R=D+(A<<21&4294967295|A>>>11),A=E+(D^(R|~L))+P[4]+4149444226&4294967295,E=R+(A<<6&4294967295|A>>>26),A=L+(R^(E|~D))+P[11]+3174756917&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~R))+P[2]+718787259&4294967295,D=L+(A<<15&4294967295|A>>>17),A=R+(L^(D|~E))+P[9]+3951481745&4294967295,C.g[0]=C.g[0]+E&4294967295,C.g[1]=C.g[1]+(D+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+L&4294967295}i.prototype.u=function(C,E){E===void 0&&(E=C.length);for(var R=E-this.blockSize,P=this.B,D=this.h,L=0;L<E;){if(D==0)for(;L<=R;)r(this,C,L),L+=this.blockSize;if(typeof C=="string"){for(;L<E;)if(P[D++]=C.charCodeAt(L++),D==this.blockSize){r(this,P),D=0;break}}else for(;L<E;)if(P[D++]=C[L++],D==this.blockSize){r(this,P),D=0;break}}this.h=D,this.o+=E},i.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var E=1;E<C.length-8;++E)C[E]=0;var R=8*this.o;for(E=C.length-8;E<C.length;++E)C[E]=R&255,R/=256;for(this.u(C),C=Array(16),E=R=0;4>E;++E)for(var P=0;32>P;P+=8)C[R++]=this.g[E]>>>P&255;return C};function s(C,E){var R=a;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=E(C)}function o(C,E){this.h=E;for(var R=[],P=!0,D=C.length-1;0<=D;D--){var L=C[D]|0;P&&L==E||(R[D]=L,P=!1)}this.g=R}var a={};function l(C){return-128<=C&&128>C?s(C,function(E){return new o([E|0],0>E?-1:0)}):new o([C|0],0>C?-1:0)}function c(C){if(isNaN(C)||!isFinite(C))return d;if(0>C)return T(c(-C));for(var E=[],R=1,P=0;C>=R;P++)E[P]=C/R|0,R*=4294967296;return new o(E,0)}function h(C,E){if(C.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(C.charAt(0)=="-")return T(h(C.substring(1),E));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=c(Math.pow(E,8)),P=d,D=0;D<C.length;D+=8){var L=Math.min(8,C.length-D),A=parseInt(C.substring(D,D+L),E);8>L?(L=c(Math.pow(E,L)),P=P.j(L).add(c(A))):(P=P.j(R),P=P.add(c(A)))}return P}var d=l(0),f=l(1),p=l(16777216);n=o.prototype,n.m=function(){if(w(this))return-T(this).m();for(var C=0,E=1,R=0;R<this.g.length;R++){var P=this.i(R);C+=(0<=P?P:4294967296+P)*E,E*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(_(this))return"0";if(w(this))return"-"+T(this).toString(C);for(var E=c(Math.pow(C,6)),R=this,P="";;){var D=S(R,E).g;R=v(R,D.j(E));var L=((0<R.g.length?R.g[0]:R.h)>>>0).toString(C);if(R=D,_(R))return L+P;for(;6>L.length;)L="0"+L;P=L+P}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function _(C){if(C.h!=0)return!1;for(var E=0;E<C.g.length;E++)if(C.g[E]!=0)return!1;return!0}function w(C){return C.h==-1}n.l=function(C){return C=v(this,C),w(C)?-1:_(C)?0:1};function T(C){for(var E=C.g.length,R=[],P=0;P<E;P++)R[P]=~C.g[P];return new o(R,~C.h).add(f)}n.abs=function(){return w(this)?T(this):this},n.add=function(C){for(var E=Math.max(this.g.length,C.g.length),R=[],P=0,D=0;D<=E;D++){var L=P+(this.i(D)&65535)+(C.i(D)&65535),A=(L>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);P=A>>>16,L&=65535,A&=65535,R[D]=A<<16|L}return new o(R,R[R.length-1]&-2147483648?-1:0)};function v(C,E){return C.add(T(E))}n.j=function(C){if(_(this)||_(C))return d;if(w(this))return w(C)?T(this).j(T(C)):T(T(this).j(C));if(w(C))return T(this.j(T(C)));if(0>this.l(p)&&0>C.l(p))return c(this.m()*C.m());for(var E=this.g.length+C.g.length,R=[],P=0;P<2*E;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(var D=0;D<C.g.length;D++){var L=this.i(P)>>>16,A=this.i(P)&65535,W=C.i(D)>>>16,te=C.i(D)&65535;R[2*P+2*D]+=A*te,y(R,2*P+2*D),R[2*P+2*D+1]+=L*te,y(R,2*P+2*D+1),R[2*P+2*D+1]+=A*W,y(R,2*P+2*D+1),R[2*P+2*D+2]+=L*W,y(R,2*P+2*D+2)}for(P=0;P<E;P++)R[P]=R[2*P+1]<<16|R[2*P];for(P=E;P<2*E;P++)R[P]=0;return new o(R,0)};function y(C,E){for(;(C[E]&65535)!=C[E];)C[E+1]+=C[E]>>>16,C[E]&=65535,E++}function I(C,E){this.g=C,this.h=E}function S(C,E){if(_(E))throw Error("division by zero");if(_(C))return new I(d,d);if(w(C))return E=S(T(C),E),new I(T(E.g),T(E.h));if(w(E))return E=S(C,T(E)),new I(T(E.g),E.h);if(30<C.g.length){if(w(C)||w(E))throw Error("slowDivide_ only works with positive integers.");for(var R=f,P=E;0>=P.l(C);)R=k(R),P=k(P);var D=O(R,1),L=O(P,1);for(P=O(P,2),R=O(R,2);!_(P);){var A=L.add(P);0>=A.l(C)&&(D=D.add(R),L=A),P=O(P,1),R=O(R,1)}return E=v(C,D.j(E)),new I(D,E)}for(D=d;0<=C.l(E);){for(R=Math.max(1,Math.floor(C.m()/E.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),L=c(R),A=L.j(E);w(A)||0<A.l(C);)R-=P,L=c(R),A=L.j(E);_(L)&&(L=f),D=D.add(L),C=v(C,A)}return new I(D,C)}n.A=function(C){return S(this,C).h},n.and=function(C){for(var E=Math.max(this.g.length,C.g.length),R=[],P=0;P<E;P++)R[P]=this.i(P)&C.i(P);return new o(R,this.h&C.h)},n.or=function(C){for(var E=Math.max(this.g.length,C.g.length),R=[],P=0;P<E;P++)R[P]=this.i(P)|C.i(P);return new o(R,this.h|C.h)},n.xor=function(C){for(var E=Math.max(this.g.length,C.g.length),R=[],P=0;P<E;P++)R[P]=this.i(P)^C.i(P);return new o(R,this.h^C.h)};function k(C){for(var E=C.g.length+1,R=[],P=0;P<E;P++)R[P]=C.i(P)<<1|C.i(P-1)>>>31;return new o(R,C.h)}function O(C,E){var R=E>>5;E%=32;for(var P=C.g.length-R,D=[],L=0;L<P;L++)D[L]=0<E?C.i(L+R)>>>E|C.i(L+R+1)<<32-E:C.i(L+R);return new o(D,C.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,d2=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Is=o}).apply(typeof C1<"u"?C1:typeof self<"u"?self:typeof window<"u"?window:{});var Tc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var f2,Qa,g2,Uc,mp,p2,m2,_2;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,m){return u==Array.prototype||u==Object.prototype||(u[g]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Tc=="object"&&Tc];for(var g=0;g<u.length;++g){var m=u[g];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var i=t(this);function r(u,g){if(g)e:{var m=i;u=u.split(".");for(var x=0;x<u.length-1;x++){var M=u[x];if(!(M in m))break e;m=m[M]}u=u[u.length-1],x=m[u],g=g(x),g!=x&&g!=null&&e(m,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var m=0,x=!1,M={next:function(){if(!x&&m<u.length){var N=m++;return{value:g(N,u[N]),done:!1}}return x=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}r("Array.prototype.values",function(u){return u||function(){return s(this,function(g,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function c(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function h(u,g,m){return u.call.apply(u.bind,arguments)}function d(u,g,m){if(!u)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,x),u.apply(g,M)}}return function(){return u.apply(g,arguments)}}function f(u,g,m){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function p(u,g){var m=Array.prototype.slice.call(arguments,1);return function(){var x=m.slice();return x.push.apply(x,arguments),u.apply(this,x)}}function _(u,g){function m(){}m.prototype=g.prototype,u.aa=g.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(x,M,N){for(var K=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)K[Oe-2]=arguments[Oe];return g.prototype[M].apply(x,K)}}function w(u){const g=u.length;if(0<g){const m=Array(g);for(let x=0;x<g;x++)m[x]=u[x];return m}return[]}function T(u,g){for(let m=1;m<arguments.length;m++){const x=arguments[m];if(l(x)){const M=u.length||0,N=x.length||0;u.length=M+N;for(let K=0;K<N;K++)u[M+K]=x[K]}else u.push(x)}}class v{constructor(g,m){this.i=g,this.j=m,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function y(u){return/^[\s\xa0]*$/.test(u)}function I(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function S(u){return S[" "](u),u}S[" "]=function(){};var k=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function O(u,g,m){for(const x in u)g.call(m,u[x],x,u)}function C(u,g){for(const m in u)g.call(void 0,u[m],m,u)}function E(u){const g={};for(const m in u)g[m]=u[m];return g}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(u,g){let m,x;for(let M=1;M<arguments.length;M++){x=arguments[M];for(m in x)u[m]=x[m];for(let N=0;N<R.length;N++)m=R[N],Object.prototype.hasOwnProperty.call(x,m)&&(u[m]=x[m])}}function D(u){var g=1;u=u.split(":");const m=[];for(;0<g&&u.length;)m.push(u.shift()),g--;return u.length&&m.push(u.join(":")),m}function L(u){a.setTimeout(()=>{throw u},0)}function A(){var u=X;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class W{constructor(){this.h=this.g=null}add(g,m){const x=te.get();x.set(g,m),this.h?this.h.next=x:this.g=x,this.h=x}}var te=new v(()=>new $,u=>u.reset());class ${constructor(){this.next=this.g=this.h=null}set(g,m){this.h=g,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let re,U=!1,X=new W,G=()=>{const u=a.Promise.resolve(void 0);re=()=>{u.then(J)}};var J=()=>{for(var u;u=A();){try{u.h.call(u.g)}catch(m){L(m)}var g=te;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}U=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function he(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}he.prototype.h=function(){this.defaultPrevented=!0};var B=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const m=()=>{};a.addEventListener("test",m,g),a.removeEventListener("test",m,g)}catch{}return u}();function Be(u,g){if(he.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,x=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(k){e:{try{S(g.nodeName);var M=!0;break e}catch{}M=!1}M||(g=null)}}else m=="mouseover"?g=u.fromElement:m=="mouseout"&&(g=u.toElement);this.relatedTarget=g,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Me[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Be.aa.h.call(this)}}_(Be,he);var Me={2:"touch",3:"pen",4:"mouse"};Be.prototype.h=function(){Be.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),vn=0;function Mn(u,g,m,x,M){this.listener=u,this.proxy=null,this.src=g,this.type=m,this.capture=!!x,this.ha=M,this.key=++vn,this.da=this.fa=!1}function _t(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ln(u){this.src=u,this.g={},this.h=0}ln.prototype.add=function(u,g,m,x,M){var N=u.toString();u=this.g[N],u||(u=this.g[N]=[],this.h++);var K=er(u,g,x,M);return-1<K?(g=u[K],m||(g.fa=!1)):(g=new Mn(g,this.src,N,!!x,M),g.fa=m,u.push(g)),g};function vi(u,g){var m=g.type;if(m in u.g){var x=u.g[m],M=Array.prototype.indexOf.call(x,g,void 0),N;(N=0<=M)&&Array.prototype.splice.call(x,M,1),N&&(_t(g),u.g[m].length==0&&(delete u.g[m],u.h--))}}function er(u,g,m,x){for(var M=0;M<u.length;++M){var N=u[M];if(!N.da&&N.listener==g&&N.capture==!!m&&N.ha==x)return M}return-1}var es="closure_lm_"+(1e6*Math.random()|0),Ei={};function Qn(u,g,m,x,M){if(Array.isArray(g)){for(var N=0;N<g.length;N++)Qn(u,g[N],m,x,M);return null}return m=Ze(m),u&&u[De]?u.K(g,m,c(x)?!!x.capture:!!x,M):Ht(u,g,m,!1,x,M)}function Ht(u,g,m,x,M,N){if(!g)throw Error("Invalid event type");var K=c(M)?!!M.capture:!!M,Oe=ei(u);if(Oe||(u[es]=Oe=new ln(u)),m=Oe.add(g,m,x,K,N),m.proxy)return m;if(x=En(),m.proxy=x,x.src=u,x.listener=m,u.addEventListener)B||(M=K),M===void 0&&(M=!1),u.addEventListener(g.toString(),x,M);else if(u.attachEvent)u.attachEvent(tr(g.toString()),x);else if(u.addListener&&u.removeListener)u.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return m}function En(){function u(m){return g.call(u.src,u.listener,m)}const g=Ti;return u}function wi(u,g,m,x,M){if(Array.isArray(g))for(var N=0;N<g.length;N++)wi(u,g[N],m,x,M);else x=c(x)?!!x.capture:!!x,m=Ze(m),u&&u[De]?(u=u.i,g=String(g).toString(),g in u.g&&(N=u.g[g],m=er(N,m,x,M),-1<m&&(_t(N[m]),Array.prototype.splice.call(N,m,1),N.length==0&&(delete u.g[g],u.h--)))):u&&(u=ei(u))&&(g=u.g[g.toString()],u=-1,g&&(u=er(g,m,x,M)),(m=-1<u?g[u]:null)&&Jn(m))}function Jn(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[De])vi(g.i,u);else{var m=u.type,x=u.proxy;g.removeEventListener?g.removeEventListener(m,x,u.capture):g.detachEvent?g.detachEvent(tr(m),x):g.addListener&&g.removeListener&&g.removeListener(x),(m=ei(g))?(vi(m,u),m.h==0&&(m.src=null,g[es]=null)):_t(u)}}}function tr(u){return u in Ei?Ei[u]:Ei[u]="on"+u}function Ti(u,g){if(u.da)u=!0;else{g=new Be(g,this);var m=u.listener,x=u.ha||u.src;u.fa&&Jn(u),u=m.call(x,g)}return u}function ei(u){return u=u[es],u instanceof ln?u:null}var ti="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ze(u){return typeof u=="function"?u:(u[ti]||(u[ti]=function(g){return u.handleEvent(g)}),u[ti])}function tt(){ee.call(this),this.i=new ln(this),this.M=this,this.F=null}_(tt,ee),tt.prototype[De]=!0,tt.prototype.removeEventListener=function(u,g,m,x){wi(this,u,g,m,x)};function st(u,g){var m,x=u.F;if(x)for(m=[];x;x=x.F)m.push(x);if(u=u.M,x=g.type||g,typeof g=="string")g=new he(g,u);else if(g instanceof he)g.target=g.target||u;else{var M=g;g=new he(x,u),P(g,M)}if(M=!0,m)for(var N=m.length-1;0<=N;N--){var K=g.g=m[N];M=Ii(K,x,!0,g)&&M}if(K=g.g=u,M=Ii(K,x,!0,g)&&M,M=Ii(K,x,!1,g)&&M,m)for(N=0;N<m.length;N++)K=g.g=m[N],M=Ii(K,x,!1,g)&&M}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var m=u.g[g],x=0;x<m.length;x++)_t(m[x]);delete u.g[g],u.h--}}this.F=null},tt.prototype.K=function(u,g,m,x){return this.i.add(String(u),g,!1,m,x)},tt.prototype.L=function(u,g,m,x){return this.i.add(String(u),g,!0,m,x)};function Ii(u,g,m,x){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var M=!0,N=0;N<g.length;++N){var K=g[N];if(K&&!K.da&&K.capture==m){var Oe=K.listener,Et=K.ha||K.src;K.fa&&vi(u.i,K),M=Oe.call(Et,x)!==!1&&M}}return M&&!x.defaultPrevented}function ts(u,g,m){if(typeof u=="function")m&&(u=f(u,m));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(u,g||0)}function xu(u){u.g=ts(()=>{u.g=null,u.i&&(u.i=!1,xu(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Su extends ee{constructor(g,m){super(),this.m=g,this.l=m,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:xu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nr(u){ee.call(this),this.h=u,this.g={}}_(nr,ee);var Bs=[];function Au(u){O(u.g,function(g,m){this.g.hasOwnProperty(m)&&Jn(g)},u),u.g={}}nr.prototype.N=function(){nr.aa.N.call(this),Au(this)},nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var va=a.JSON.stringify,Pu=a.JSON.parse,Du=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ns(){}ns.prototype.h=null;function Ea(u){return u.h||(u.h=u.i())}function js(){}var On={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ci(){he.call(this,"d")}_(Ci,he);function Ri(){he.call(this,"c")}_(Ri,he);var ni={},wa=null;function yt(){return wa=wa||new tt}ni.La="serverreachability";function ii(u){he.call(this,ni.La,u)}_(ii,he);function dt(u){const g=yt();st(g,new ii(g))}ni.STAT_EVENT="statevent";function un(u,g){he.call(this,ni.STAT_EVENT,u),this.stat=g}_(un,he);function ke(u){const g=yt();st(g,new un(g,u))}ni.Ma="timingevent";function wn(u,g){he.call(this,ni.Ma,u),this.size=g}_(wn,he);function jt(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},g)}function Le(){this.g=!0}Le.prototype.xa=function(){this.g=!1};function vt(u,g,m,x,M,N){u.info(function(){if(u.g)if(N)for(var K="",Oe=N.split("&"),Et=0;Et<Oe.length;Et++){var we=Oe[Et].split("=");if(1<we.length){var Dt=we[0];we=we[1];var kt=Dt.split("_");K=2<=kt.length&&kt[1]=="type"?K+(Dt+"="+we+"&"):K+(Dt+"=redacted&")}}else K=null;else K=N;return"XMLHTTP REQ ("+x+") [attempt "+M+"]: "+g+`
`+m+`
`+K})}function Nn(u,g,m,x,M,N,K){u.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+M+"]: "+g+`
`+m+`
`+N+" "+K})}function ir(u,g,m,x){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+zC(u,m)+(x?" "+x:"")})}function VC(u,g){u.info(function(){return"TIMEOUT: "+g})}Le.prototype.info=function(){};function zC(u,g){if(!u.g)return g;if(!g)return null;try{var m=JSON.parse(g);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var x=m[u];if(!(2>x.length)){var M=x[1];if(Array.isArray(M)&&!(1>M.length)){var N=M[0];if(N!="noop"&&N!="stop"&&N!="close")for(var K=1;K<M.length;K++)M[K]=""}}}}return va(m)}catch{return g}}var ku={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Y_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},jd;function Lu(){}_(Lu,ns),Lu.prototype.g=function(){return new XMLHttpRequest},Lu.prototype.i=function(){return{}},jd=new Lu;function rr(u,g,m,x){this.j=u,this.i=g,this.l=m,this.R=x||1,this.U=new nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Z_}function Z_(){this.i=null,this.g="",this.h=!1}var Q_={},Gd={};function Wd(u,g,m){u.L=1,u.v=Fu(xi(g)),u.m=m,u.P=!0,J_(u,null)}function J_(u,g){u.F=Date.now(),Mu(u),u.A=xi(u.v);var m=u.A,x=u.R;Array.isArray(x)||(x=[String(x)]),fy(m.i,"t",x),u.C=0,m=u.j.J,u.h=new Z_,u.g=ky(u.j,m?g:null,!u.m),0<u.O&&(u.M=new Su(f(u.Y,u,u.g),u.O)),g=u.U,m=u.g,x=u.ca;var M="readystatechange";Array.isArray(M)||(M&&(Bs[0]=M.toString()),M=Bs);for(var N=0;N<M.length;N++){var K=Qn(m,M[N],x||g.handleEvent,!1,g.h||g);if(!K)break;g.g[K.key]=K}g=u.H?E(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),dt(),vt(u.i,u.u,u.A,u.l,u.R,u.m)}rr.prototype.ca=function(u){u=u.target;const g=this.M;g&&Si(u)==3?g.j():this.Y(u)},rr.prototype.Y=function(u){try{if(u==this.g)e:{const kt=Si(this.g);var g=this.g.Ba();const $s=this.g.Z();if(!(3>kt)&&(kt!=3||this.g&&(this.h.h||this.g.oa()||Ey(this.g)))){this.J||kt!=4||g==7||(g==8||0>=$s?dt(3):dt(2)),$d(this);var m=this.g.Z();this.X=m;t:if(ey(this)){var x=Ey(this.g);u="";var M=x.length,N=Si(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){is(this),Ta(this);var K="";break t}this.h.i=new a.TextDecoder}for(g=0;g<M;g++)this.h.h=!0,u+=this.h.i.decode(x[g],{stream:!(N&&g==M-1)});x.length=0,this.h.g+=u,this.C=0,K=this.h.g}else K=this.g.oa();if(this.o=m==200,Nn(this.i,this.u,this.A,this.l,this.R,kt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Oe,Et=this.g;if((Oe=Et.g?Et.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Oe)){var we=Oe;break t}}we=null}if(m=we)ir(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Kd(this,m);else{this.o=!1,this.s=3,ke(12),is(this),Ta(this);break e}}if(this.P){m=!0;let Fn;for(;!this.J&&this.C<K.length;)if(Fn=UC(this,K),Fn==Gd){kt==4&&(this.s=4,ke(14),m=!1),ir(this.i,this.l,null,"[Incomplete Response]");break}else if(Fn==Q_){this.s=4,ke(15),ir(this.i,this.l,K,"[Invalid Chunk]"),m=!1;break}else ir(this.i,this.l,Fn,null),Kd(this,Fn);if(ey(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),kt!=4||K.length!=0||this.h.h||(this.s=1,ke(16),m=!1),this.o=this.o&&m,!m)ir(this.i,this.l,K,"[Invalid Chunked Response]"),is(this),Ta(this);else if(0<K.length&&!this.W){this.W=!0;var Dt=this.j;Dt.g==this&&Dt.ba&&!Dt.M&&(Dt.j.info("Great, no buffering proxy detected. Bytes received: "+K.length),Qd(Dt),Dt.M=!0,ke(11))}}else ir(this.i,this.l,K,null),Kd(this,K);kt==4&&is(this),this.o&&!this.J&&(kt==4?Sy(this.j,this):(this.o=!1,Mu(this)))}else iR(this.g),m==400&&0<K.indexOf("Unknown SID")?(this.s=3,ke(12)):(this.s=0,ke(13)),is(this),Ta(this)}}}catch{}finally{}};function ey(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function UC(u,g){var m=u.C,x=g.indexOf(`
`,m);return x==-1?Gd:(m=Number(g.substring(m,x)),isNaN(m)?Q_:(x+=1,x+m>g.length?Gd:(g=g.slice(x,x+m),u.C=x+m,g)))}rr.prototype.cancel=function(){this.J=!0,is(this)};function Mu(u){u.S=Date.now()+u.I,ty(u,u.I)}function ty(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=jt(f(u.ba,u),g)}function $d(u){u.B&&(a.clearTimeout(u.B),u.B=null)}rr.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(VC(this.i,this.A),this.L!=2&&(dt(),ke(17)),is(this),this.s=2,Ta(this)):ty(this,this.S-u)};function Ta(u){u.j.G==0||u.J||Sy(u.j,u)}function is(u){$d(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Au(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Kd(u,g){try{var m=u.j;if(m.G!=0&&(m.g==u||Xd(m.h,u))){if(!u.K&&Xd(m.h,u)&&m.G==3){try{var x=m.Da.g.parse(g)}catch{x=null}if(Array.isArray(x)&&x.length==3){var M=x;if(M[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)ju(m),Uu(m);else break e;Zd(m),ke(18)}}else m.za=M[1],0<m.za-m.T&&37500>M[2]&&m.F&&m.v==0&&!m.C&&(m.C=jt(f(m.Za,m),6e3));if(1>=ry(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else ss(m,11)}else if((u.K||m.g==u)&&ju(m),!y(g))for(M=m.Da.g.parse(g),g=0;g<M.length;g++){let we=M[g];if(m.T=we[0],we=we[1],m.G==2)if(we[0]=="c"){m.K=we[1],m.ia=we[2];const Dt=we[3];Dt!=null&&(m.la=Dt,m.j.info("VER="+m.la));const kt=we[4];kt!=null&&(m.Aa=kt,m.j.info("SVER="+m.Aa));const $s=we[5];$s!=null&&typeof $s=="number"&&0<$s&&(x=1.5*$s,m.L=x,m.j.info("backChannelRequestTimeoutMs_="+x)),x=m;const Fn=u.g;if(Fn){const Wu=Fn.g?Fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wu){var N=x.h;N.g||Wu.indexOf("spdy")==-1&&Wu.indexOf("quic")==-1&&Wu.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Hd(N,N.h),N.h=null))}if(x.D){const Jd=Fn.g?Fn.g.getResponseHeader("X-HTTP-Session-Id"):null;Jd&&(x.ya=Jd,be(x.I,x.D,Jd))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),x=m;var K=u;if(x.qa=Dy(x,x.J?x.ia:null,x.W),K.K){sy(x.h,K);var Oe=K,Et=x.L;Et&&(Oe.I=Et),Oe.B&&($d(Oe),Mu(Oe)),x.g=K}else Ry(x);0<m.i.length&&Bu(m)}else we[0]!="stop"&&we[0]!="close"||ss(m,7);else m.G==3&&(we[0]=="stop"||we[0]=="close"?we[0]=="stop"?ss(m,7):Yd(m):we[0]!="noop"&&m.l&&m.l.ta(we),m.v=0)}}dt(4)}catch{}}var BC=class{constructor(u,g){this.g=u,this.map=g}};function ny(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function iy(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function ry(u){return u.h?1:u.g?u.g.size:0}function Xd(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Hd(u,g){u.g?u.g.add(g):u.h=g}function sy(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}ny.prototype.cancel=function(){if(this.i=oy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function oy(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const m of u.g.values())g=g.concat(m.D);return g}return w(u.i)}function jC(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var g=[],m=u.length,x=0;x<m;x++)g.push(u[x]);return g}g=[],m=0;for(x in u)g[m++]=u[x];return g}function GC(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var g=[];u=u.length;for(var m=0;m<u;m++)g.push(m);return g}g=[],m=0;for(const x in u)g[m++]=x;return g}}}function ay(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var m=GC(u),x=jC(u),M=x.length,N=0;N<M;N++)g.call(void 0,x[N],m&&m[N],u)}var ly=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function WC(u,g){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var x=u[m].indexOf("="),M=null;if(0<=x){var N=u[m].substring(0,x);M=u[m].substring(x+1)}else N=u[m];g(N,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function rs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof rs){this.h=u.h,Ou(this,u.j),this.o=u.o,this.g=u.g,Nu(this,u.s),this.l=u.l;var g=u.i,m=new Ra;m.i=g.i,g.g&&(m.g=new Map(g.g),m.h=g.h),uy(this,m),this.m=u.m}else u&&(g=String(u).match(ly))?(this.h=!1,Ou(this,g[1]||"",!0),this.o=Ia(g[2]||""),this.g=Ia(g[3]||"",!0),Nu(this,g[4]),this.l=Ia(g[5]||"",!0),uy(this,g[6]||"",!0),this.m=Ia(g[7]||"")):(this.h=!1,this.i=new Ra(null,this.h))}rs.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Ca(g,cy,!0),":");var m=this.g;return(m||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Ca(g,cy,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Ca(m,m.charAt(0)=="/"?XC:KC,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Ca(m,qC)),u.join("")};function xi(u){return new rs(u)}function Ou(u,g,m){u.j=m?Ia(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Nu(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function uy(u,g,m){g instanceof Ra?(u.i=g,YC(u.i,u.h)):(m||(g=Ca(g,HC)),u.i=new Ra(g,u.h))}function be(u,g,m){u.i.set(g,m)}function Fu(u){return be(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Ia(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ca(u,g,m){return typeof u=="string"?(u=encodeURI(u).replace(g,$C),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function $C(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var cy=/[#\/\?@]/g,KC=/[#\?:]/g,XC=/[#\?]/g,HC=/[#\?@]/g,qC=/#/g;function Ra(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function sr(u){u.g||(u.g=new Map,u.h=0,u.i&&WC(u.i,function(g,m){u.add(decodeURIComponent(g.replace(/\+/g," ")),m)}))}n=Ra.prototype,n.add=function(u,g){sr(this),this.i=null,u=Gs(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(g),this.h+=1,this};function hy(u,g){sr(u),g=Gs(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function dy(u,g){return sr(u),g=Gs(u,g),u.g.has(g)}n.forEach=function(u,g){sr(this),this.g.forEach(function(m,x){m.forEach(function(M){u.call(g,M,x,this)},this)},this)},n.na=function(){sr(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),m=[];for(let x=0;x<g.length;x++){const M=u[x];for(let N=0;N<M.length;N++)m.push(g[x])}return m},n.V=function(u){sr(this);let g=[];if(typeof u=="string")dy(this,u)&&(g=g.concat(this.g.get(Gs(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)g=g.concat(u[m])}return g},n.set=function(u,g){return sr(this),this.i=null,u=Gs(this,u),dy(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function fy(u,g,m){hy(u,g),0<m.length&&(u.i=null,u.g.set(Gs(u,g),w(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var m=0;m<g.length;m++){var x=g[m];const N=encodeURIComponent(String(x)),K=this.V(x);for(x=0;x<K.length;x++){var M=N;K[x]!==""&&(M+="="+encodeURIComponent(String(K[x]))),u.push(M)}}return this.i=u.join("&")};function Gs(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function YC(u,g){g&&!u.j&&(sr(u),u.i=null,u.g.forEach(function(m,x){var M=x.toLowerCase();x!=M&&(hy(this,x),fy(this,M,m))},u)),u.j=g}function ZC(u,g){const m=new Le;if(a.Image){const x=new Image;x.onload=p(or,m,"TestLoadImage: loaded",!0,g,x),x.onerror=p(or,m,"TestLoadImage: error",!1,g,x),x.onabort=p(or,m,"TestLoadImage: abort",!1,g,x),x.ontimeout=p(or,m,"TestLoadImage: timeout",!1,g,x),a.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=u}else g(!1)}function QC(u,g){const m=new Le,x=new AbortController,M=setTimeout(()=>{x.abort(),or(m,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:x.signal}).then(N=>{clearTimeout(M),N.ok?or(m,"TestPingServer: ok",!0,g):or(m,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(M),or(m,"TestPingServer: error",!1,g)})}function or(u,g,m,x,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),x(m)}catch{}}function JC(){this.g=new Du}function eR(u,g,m){const x=m||"";try{ay(u,function(M,N){let K=M;c(M)&&(K=va(M)),g.push(x+N+"="+encodeURIComponent(K))})}catch(M){throw g.push(x+"type="+encodeURIComponent("_badmap")),M}}function bu(u){this.l=u.Ub||null,this.j=u.eb||!1}_(bu,ns),bu.prototype.g=function(){return new Vu(this.l,this.j)},bu.prototype.i=function(u){return function(){return u}}({});function Vu(u,g){tt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Vu,tt),n=Vu.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Sa(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xa(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Sa(this)),this.g&&(this.readyState=3,Sa(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gy(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function gy(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?xa(this):Sa(this),this.readyState==3&&gy(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,xa(this))},n.Qa=function(u){this.g&&(this.response=u,xa(this))},n.ga=function(){this.g&&xa(this)};function xa(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Sa(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var m=g.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=g.next();return u.join(`\r
`)};function Sa(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Vu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function py(u){let g="";return O(u,function(m,x){g+=x,g+=":",g+=m,g+=`\r
`}),g}function qd(u,g,m){e:{for(x in m){var x=!1;break e}x=!0}x||(m=py(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):be(u,g,m))}function Xe(u){tt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Xe,tt);var tR=/^https?$/i,nR=["POST","PUT"];n=Xe.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,m,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jd.g(),this.v=this.o?Ea(this.o):Ea(jd),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(N){my(this,N);return}if(u=m||"",m=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var M in x)m.set(M,x[M]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const N of x.keys())m.set(N,x.get(N));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(m.keys()).find(N=>N.toLowerCase()=="content-type"),M=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(nR,g,void 0))||x||M||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[N,K]of m)this.g.setRequestHeader(N,K);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vy(this),this.u=!0,this.g.send(u),this.u=!1}catch(N){my(this,N)}};function my(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,_y(u),zu(u)}function _y(u){u.A||(u.A=!0,st(u,"complete"),st(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,st(this,"complete"),st(this,"abort"),zu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zu(this,!0)),Xe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?yy(this):this.bb())},n.bb=function(){yy(this)};function yy(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Si(u)!=4||u.Z()!=2)){if(u.u&&Si(u)==4)ts(u.Ea,0,u);else if(st(u,"readystatechange"),Si(u)==4){u.h=!1;try{const K=u.Z();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var m;if(!(m=g)){var x;if(x=K===0){var M=String(u.D).match(ly)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),x=!tR.test(M?M.toLowerCase():"")}m=x}if(m)st(u,"complete"),st(u,"success");else{u.m=6;try{var N=2<Si(u)?u.g.statusText:""}catch{N=""}u.l=N+" ["+u.Z()+"]",_y(u)}}finally{zu(u)}}}}function zu(u,g){if(u.g){vy(u);const m=u.g,x=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||st(u,"ready");try{m.onreadystatechange=x}catch{}}}function vy(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Si(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Si(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),Pu(g)}};function Ey(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function iR(u){const g={};u=(u.g&&2<=Si(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<u.length;x++){if(y(u[x]))continue;var m=D(u[x]);const M=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const N=g[M]||[];g[M]=N,N.push(m)}C(g,function(x){return x.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Aa(u,g,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||g}function wy(u){this.Aa=0,this.i=[],this.j=new Le,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Aa("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Aa("baseRetryDelayMs",5e3,u),this.cb=Aa("retryDelaySeedMs",1e4,u),this.Wa=Aa("forwardChannelMaxRetries",2,u),this.wa=Aa("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ny(u&&u.concurrentRequestLimit),this.Da=new JC,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=wy.prototype,n.la=8,n.G=1,n.connect=function(u,g,m,x){ke(0),this.W=u,this.H=g||{},m&&x!==void 0&&(this.H.OSID=m,this.H.OAID=x),this.F=this.X,this.I=Dy(this,null,this.W),Bu(this)};function Yd(u){if(Ty(u),u.G==3){var g=u.U++,m=xi(u.I);if(be(m,"SID",u.K),be(m,"RID",g),be(m,"TYPE","terminate"),Pa(u,m),g=new rr(u,u.j,g),g.L=2,g.v=Fu(xi(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=g.v,m=!0),m||(g.g=ky(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Mu(g)}Py(u)}function Uu(u){u.g&&(Qd(u),u.g.cancel(),u.g=null)}function Ty(u){Uu(u),u.u&&(a.clearTimeout(u.u),u.u=null),ju(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Bu(u){if(!iy(u.h)&&!u.s){u.s=!0;var g=u.Ga;re||G(),U||(re(),U=!0),X.add(g,u),u.B=0}}function rR(u,g){return ry(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=jt(f(u.Ga,u,g),Ay(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const M=new rr(this,this.j,u);let N=this.o;if(this.S&&(N?(N=E(N),P(N,this.S)):N=this.S),this.m!==null||this.O||(M.H=N,N=null),this.P)e:{for(var g=0,m=0;m<this.i.length;m++){t:{var x=this.i[m];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(g+=x,4096<g){g=m;break e}if(g===4096||m===this.i.length-1){g=m+1;break e}}g=1e3}else g=1e3;g=Cy(this,M,g),m=xi(this.I),be(m,"RID",u),be(m,"CVER",22),this.D&&be(m,"X-HTTP-Session-Id",this.D),Pa(this,m),N&&(this.O?g="headers="+encodeURIComponent(String(py(N)))+"&"+g:this.m&&qd(m,this.m,N)),Hd(this.h,M),this.Ua&&be(m,"TYPE","init"),this.P?(be(m,"$req",g),be(m,"SID","null"),M.T=!0,Wd(M,m,null)):Wd(M,m,g),this.G=2}}else this.G==3&&(u?Iy(this,u):this.i.length==0||iy(this.h)||Iy(this))};function Iy(u,g){var m;g?m=g.l:m=u.U++;const x=xi(u.I);be(x,"SID",u.K),be(x,"RID",m),be(x,"AID",u.T),Pa(u,x),u.m&&u.o&&qd(x,u.m,u.o),m=new rr(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Cy(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Hd(u.h,m),Wd(m,x,g)}function Pa(u,g){u.H&&O(u.H,function(m,x){be(g,x,m)}),u.l&&ay({},function(m,x){be(g,x,m)})}function Cy(u,g,m){m=Math.min(u.i.length,m);var x=u.l?f(u.l.Na,u.l,u):null;e:{var M=u.i;let N=-1;for(;;){const K=["count="+m];N==-1?0<m?(N=M[0].g,K.push("ofs="+N)):N=0:K.push("ofs="+N);let Oe=!0;for(let Et=0;Et<m;Et++){let we=M[Et].g;const Dt=M[Et].map;if(we-=N,0>we)N=Math.max(0,M[Et].g-100),Oe=!1;else try{eR(Dt,K,"req"+we+"_")}catch{x&&x(Dt)}}if(Oe){x=K.join("&");break e}}}return u=u.i.splice(0,m),g.D=u,x}function Ry(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;re||G(),U||(re(),U=!0),X.add(g,u),u.v=0}}function Zd(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=jt(f(u.Fa,u),Ay(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,xy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=jt(f(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ke(10),Uu(this),xy(this))};function Qd(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function xy(u){u.g=new rr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=xi(u.qa);be(g,"RID","rpc"),be(g,"SID",u.K),be(g,"AID",u.T),be(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&be(g,"TO",u.ja),be(g,"TYPE","xmlhttp"),Pa(u,g),u.m&&u.o&&qd(g,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Fu(xi(g)),m.m=null,m.P=!0,J_(m,u)}n.Za=function(){this.C!=null&&(this.C=null,Uu(this),Zd(this),ke(19))};function ju(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Sy(u,g){var m=null;if(u.g==g){ju(u),Qd(u),u.g=null;var x=2}else if(Xd(u.h,g))m=g.D,sy(u.h,g),x=1;else return;if(u.G!=0){if(g.o)if(x==1){m=g.m?g.m.length:0,g=Date.now()-g.F;var M=u.B;x=yt(),st(x,new wn(x,m)),Bu(u)}else Ry(u);else if(M=g.s,M==3||M==0&&0<g.X||!(x==1&&rR(u,g)||x==2&&Zd(u)))switch(m&&0<m.length&&(g=u.h,g.i=g.i.concat(m)),M){case 1:ss(u,5);break;case 4:ss(u,10);break;case 3:ss(u,6);break;default:ss(u,2)}}}function Ay(u,g){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*g}function ss(u,g){if(u.j.info("Error code "+g),g==2){var m=f(u.fb,u),x=u.Xa;const M=!x;x=new rs(x||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ou(x,"https"),Fu(x),M?ZC(x.toString(),m):QC(x.toString(),m)}else ke(2);u.G=0,u.l&&u.l.sa(g),Py(u),Ty(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ke(2)):(this.j.info("Failed to ping google.com"),ke(1))};function Py(u){if(u.G=0,u.ka=[],u.l){const g=oy(u.h);(g.length!=0||u.i.length!=0)&&(T(u.ka,g),T(u.ka,u.i),u.h.i.length=0,w(u.i),u.i.length=0),u.l.ra()}}function Dy(u,g,m){var x=m instanceof rs?xi(m):new rs(m);if(x.g!="")g&&(x.g=g+"."+x.g),Nu(x,x.s);else{var M=a.location;x=M.protocol,g=g?g+"."+M.hostname:M.hostname,M=+M.port;var N=new rs(null);x&&Ou(N,x),g&&(N.g=g),M&&Nu(N,M),m&&(N.l=m),x=N}return m=u.D,g=u.ya,m&&g&&be(x,m,g),be(x,"VER",u.la),Pa(u,x),x}function ky(u,g,m){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Xe(new bu({eb:m})):new Xe(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ly(){}n=Ly.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Gu(){}Gu.prototype.g=function(u,g){return new cn(u,g)};function cn(u,g){tt.call(this),this.g=new wy(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!y(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!y(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Ws(this)}_(cn,tt),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Yd(this.g)},cn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=va(u),u=m);g.i.push(new BC(g.Ya++,u)),g.G==3&&Bu(g)},cn.prototype.N=function(){this.g.l=null,delete this.j,Yd(this.g),delete this.g,cn.aa.N.call(this)};function My(u){Ci.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const m in g){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}_(My,Ci);function Oy(){Ri.call(this),this.status=1}_(Oy,Ri);function Ws(u){this.g=u}_(Ws,Ly),Ws.prototype.ua=function(){st(this.g,"a")},Ws.prototype.ta=function(u){st(this.g,new My(u))},Ws.prototype.sa=function(u){st(this.g,new Oy)},Ws.prototype.ra=function(){st(this.g,"b")},Gu.prototype.createWebChannel=Gu.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,_2=function(){return new Gu},m2=function(){return yt()},p2=ni,mp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ku.NO_ERROR=0,ku.TIMEOUT=8,ku.HTTP_ERROR=6,Uc=ku,Y_.COMPLETE="complete",g2=Y_,js.EventType=On,On.OPEN="a",On.CLOSE="b",On.ERROR="c",On.MESSAGE="d",tt.prototype.listen=tt.prototype.K,Qa=js,Xe.prototype.listenOnce=Xe.prototype.L,Xe.prototype.getLastError=Xe.prototype.Ka,Xe.prototype.getLastErrorCode=Xe.prototype.Ba,Xe.prototype.getStatus=Xe.prototype.Z,Xe.prototype.getResponseJson=Xe.prototype.Oa,Xe.prototype.getResponseText=Xe.prototype.oa,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Ha,f2=Xe}).apply(typeof Tc<"u"?Tc:typeof self<"u"?self:typeof window<"u"?window:{});const R1="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bt.UNAUTHENTICATED=new bt(null),bt.GOOGLE_CREDENTIALS=new bt("google-credentials-uid"),bt.FIRST_PARTY=new bt("first-party-uid"),bt.MOCK_USER=new bt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ga="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=new o2("@firebase/firestore");function oo(){return Ls.logLevel}function q(n,...e){if(Ls.logLevel<=ye.DEBUG){const t=e.map(f_);Ls.debug(`Firestore (${ga}): ${n}`,...t)}}function qi(n,...e){if(Ls.logLevel<=ye.ERROR){const t=e.map(f_);Ls.error(`Firestore (${ga}): ${n}`,...t)}}function Qo(n,...e){if(Ls.logLevel<=ye.WARN){const t=e.map(f_);Ls.warn(`Firestore (${ga}): ${n}`,...t)}}function f_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(n="Unexpected state"){const e=`FIRESTORE (${ga}) INTERNAL ASSERTION FAILED: `+n;throw qi(e),new Error(e)}function Se(n,e){n||oe()}function le(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends fa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(bt.UNAUTHENTICATED))}shutdown(){}}class qM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class YM{constructor(e){this.t=e,this.currentUser=bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Se(this.o===void 0);let i=this.i;const r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new br;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new br,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new br)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Se(typeof i.accessToken=="string"),new y2(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Se(e===null||typeof e=="string"),new bt(e)}}class ZM{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=bt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class QM{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new ZM(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(bt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class JM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Se(this.o===void 0);const i=s=>{s.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Se(typeof t.token=="string"),this.R=t.token,new JM(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=tO(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}}function me(n,e){return n<e?-1:n>e?1:0}function Jo(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{static now(){return ct.fromMillis(Date.now())}static fromDate(e){return ct.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new ct(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?me(this.nanoseconds,e.nanoseconds):me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{static fromTimestamp(e){return new ae(e)}static min(){return new ae(new ct(0,0))}static max(){return new ae(new ct(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,t,i){t===void 0?t=0:t>e.length&&oe(),i===void 0?i=e.length-t:i>e.length-t&&oe(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Zl.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Zl?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ze extends Zl{construct(e,t,i){return new ze(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Q(z.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new ze(t)}static emptyPath(){return new ze([])}}const nO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ct extends Zl{construct(e,t,i){return new Ct(e,t,i)}static isValidIdentifier(e){return nO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ct(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Q(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Q(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Q(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ct(t)}static emptyPath(){return new Ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.path=e}static fromPath(e){return new ne(ze.fromString(e))}static fromName(e){return new ne(ze.fromString(e).popFirst(5))}static empty(){return new ne(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new ze(e.slice()))}}function iO(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=ae.fromTimestamp(i===1e9?new ct(t+1,0):new ct(t,i));return new Wr(r,ne.empty(),e)}function rO(n){return new Wr(n.readTime,n.key,-1)}class Wr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Wr(ae.min(),ne.empty(),-1)}static max(){return new Wr(ae.max(),ne.empty(),-1)}}function sO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ne.comparator(n.documentKey,e.documentKey),t!==0?t:me(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class aO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pa(n){if(n.code!==z.FAILED_PRECONDITION||n.message!==oO)throw n;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,i)=>{t(e)})}static reject(e){return new V((t,i)=>{i(e)})}static waitFor(e){return new V((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=V.resolve(!1);for(const i of e)t=t.next(r=>r?V.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new V((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next(h=>{o[c]=h,++a,a===s&&i(o)},h=>r(h))}})}static doWhile(e,t){return new V((i,r)=>{const s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}}function lO(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ma(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Pd.oe=-1;function Dd(n){return n==null}function Fh(n){return n===0&&1/n==-1/0}function uO(n){return typeof n=="number"&&Number.isInteger(n)&&!Fh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cO(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=x1(e)),e=hO(n.get(t),e);return x1(e)}function hO(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function x1(n){return n+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bs(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function E2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,t){this.comparator=e,this.root=t||It.EMPTY}insert(e,t){return new Ke(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,It.BLACK,null,null))}remove(e){return new Ke(this.comparator,this.root.remove(e,this.comparator).copy(null,null,It.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ic(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ic(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ic(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ic(this.root,e,this.comparator,!0)}}class Ic{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class It{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??It.RED,this.left=r??It.EMPTY,this.right=s??It.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new It(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return It.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return It.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw oe();const e=this.left.check();if(e!==this.right.check())throw oe();return e+(this.isRed()?0:1)}}It.EMPTY=null,It.RED=!0,It.BLACK=!1;It.EMPTY=new class{constructor(){this.size=0}get key(){throw oe()}get value(){throw oe()}get color(){throw oe()}get left(){throw oe()}get right(){throw oe()}copy(e,t,i,r,s){return this}insert(e,t,i){return new It(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new A1(this.data.getIterator())}getIteratorFrom(e){return new A1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof ht)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ht(this.comparator);return t.data=e,t}}class A1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.fields=e,e.sort(Ct.comparator)}static empty(){return new $n([])}unionWith(e){let t=new ht(Ct.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new $n(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jo(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new w2("Invalid base64 string: "+s):s}}(e);return new Pt(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Pt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const dO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $r(n){if(Se(!!n),typeof n=="string"){let e=0;const t=dO.exec(n);if(Se(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Qe(n.seconds),nanos:Qe(n.nanos)}}function Qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Kr(n){return typeof n=="string"?Pt.fromBase64String(n):Pt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function kd(n){const e=n.mapValue.fields.__previous_value__;return g_(e)?kd(e):e}function Ql(n){const e=$r(n.mapValue.fields.__local_write_time__.timestampValue);return new ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e,t,i,r,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Jl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Jl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Jl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Xr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?g_(n)?4:pO(n)?9007199254740991:gO(n)?10:11:oe()}function _i(n,e){if(n===e)return!0;const t=Xr(n);if(t!==Xr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ql(n).isEqual(Ql(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=$r(r.timestampValue),a=$r(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return Kr(r.bytesValue).isEqual(Kr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return Qe(r.geoPointValue.latitude)===Qe(s.geoPointValue.latitude)&&Qe(r.geoPointValue.longitude)===Qe(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Qe(r.integerValue)===Qe(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Qe(r.doubleValue),a=Qe(s.doubleValue);return o===a?Fh(o)===Fh(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Jo(n.arrayValue.values||[],e.arrayValue.values||[],_i);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(S1(o)!==S1(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!_i(o[l],a[l])))return!1;return!0}(n,e);default:return oe()}}function eu(n,e){return(n.values||[]).find(t=>_i(t,e))!==void 0}function ea(n,e){if(n===e)return 0;const t=Xr(n),i=Xr(e);if(t!==i)return me(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return me(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Qe(s.integerValue||s.doubleValue),l=Qe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return P1(n.timestampValue,e.timestampValue);case 4:return P1(Ql(n),Ql(e));case 5:return me(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Kr(s),l=Kr(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=me(a[c],l[c]);if(h!==0)return h}return me(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=me(Qe(s.latitude),Qe(o.latitude));return a!==0?a:me(Qe(s.longitude),Qe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return D1(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,h;const d=s.fields||{},f=o.fields||{},p=(a=d.value)===null||a===void 0?void 0:a.arrayValue,_=(l=f.value)===null||l===void 0?void 0:l.arrayValue,w=me(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return w!==0?w:D1(p,_)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Cc.mapValue&&o===Cc.mapValue)return 0;if(s===Cc.mapValue)return 1;if(o===Cc.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const f=me(l[d],h[d]);if(f!==0)return f;const p=ea(a[l[d]],c[h[d]]);if(p!==0)return p}return me(l.length,h.length)}(n.mapValue,e.mapValue);default:throw oe()}}function P1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return me(n,e);const t=$r(n),i=$r(e),r=me(t.seconds,i.seconds);return r!==0?r:me(t.nanos,i.nanos)}function D1(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=ea(t[r],i[r]);if(s)return s}return me(t.length,i.length)}function ta(n){return _p(n)}function _p(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=$r(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Kr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ne.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=_p(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${_p(t.fields[o])}`;return r+"}"}(n.mapValue):oe()}function Bc(n){switch(Xr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=kd(n);return e?16+Bc(e):16;case 5:return 2*n.stringValue.length;case 6:return Kr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,s)=>r+Bc(s),0)}(n.arrayValue);case 10:case 11:return function(i){let r=0;return bs(i.fields,(s,o)=>{r+=s.length+Bc(o)}),r}(n.mapValue);default:throw oe()}}function k1(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yp(n){return!!n&&"integerValue"in n}function p_(n){return!!n&&"arrayValue"in n}function L1(n){return!!n&&"nullValue"in n}function M1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jc(n){return!!n&&"mapValue"in n}function gO(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function dl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return bs(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=dl(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=dl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function pO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.value=e}static empty(){return new Rn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!jc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=dl(t)}setAll(e){let t=Ct.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=dl(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());jc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return _i(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];jc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){bs(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Rn(dl(this.value))}}function T2(n){const e=[];return bs(n.fields,(t,i)=>{const r=new Ct([t]);if(jc(i)){const s=T2(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new $n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new zt(e,0,ae.min(),ae.min(),ae.min(),Rn.empty(),0)}static newFoundDocument(e,t,i,r){return new zt(e,1,t,ae.min(),i,r,0)}static newNoDocument(e,t){return new zt(e,2,t,ae.min(),ae.min(),Rn.empty(),0)}static newUnknownDocument(e,t){return new zt(e,3,t,ae.min(),ae.min(),Rn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof zt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,t){this.position=e,this.inclusive=t}}function O1(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=ne.comparator(ne.fromName(o.referenceValue),t.key):i=ea(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function N1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!_i(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,t="asc"){this.field=e,this.dir=t}}function mO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{}class rt extends I2{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new yO(e,t,i):t==="array-contains"?new wO(e,i):t==="in"?new TO(e,i):t==="not-in"?new IO(e,i):t==="array-contains-any"?new CO(e,i):new rt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new vO(e,i):new EO(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ea(t,this.value)):t!==null&&Xr(this.value)===Xr(t)&&this.matchesComparison(ea(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zn extends I2{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Zn(e,t)}matches(e){return C2(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function C2(n){return n.op==="and"}function R2(n){return _O(n)&&C2(n)}function _O(n){for(const e of n.filters)if(e instanceof Zn)return!1;return!0}function vp(n){if(n instanceof rt)return n.field.canonicalString()+n.op.toString()+ta(n.value);if(R2(n))return n.filters.map(e=>vp(e)).join(",");{const e=n.filters.map(t=>vp(t)).join(",");return`${n.op}(${e})`}}function x2(n,e){return n instanceof rt?function(i,r){return r instanceof rt&&i.op===r.op&&i.field.isEqual(r.field)&&_i(i.value,r.value)}(n,e):n instanceof Zn?function(i,r){return r instanceof Zn&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&x2(o,r.filters[a]),!0):!1}(n,e):void oe()}function S2(n){return n instanceof rt?function(t){return`${t.field.canonicalString()} ${t.op} ${ta(t.value)}`}(n):n instanceof Zn?function(t){return t.op.toString()+" {"+t.getFilters().map(S2).join(" ,")+"}"}(n):"Filter"}class yO extends rt{constructor(e,t,i){super(e,t,i),this.key=ne.fromName(i.referenceValue)}matches(e){const t=ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class vO extends rt{constructor(e,t){super(e,"in",t),this.keys=A2("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class EO extends rt{constructor(e,t){super(e,"not-in",t),this.keys=A2("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function A2(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>ne.fromName(i.referenceValue))}class wO extends rt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return p_(t)&&eu(t.arrayValue,this.value)}}class TO extends rt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&eu(this.value.arrayValue,t)}}class IO extends rt{constructor(e,t){super(e,"not-in",t)}matches(e){if(eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!eu(this.value.arrayValue,t)}}class CO extends rt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!p_(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>eu(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function F1(n,e=null,t=[],i=[],r=null,s=null,o=null){return new RO(n,e,t,i,r,s,o)}function m_(n){const e=le(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>vp(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Dd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ta(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ta(i)).join(",")),e.ue=t}return e.ue}function __(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!mO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!x2(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!N1(n.startAt,e.startAt)&&N1(n.endAt,e.endAt)}function Ep(n){return ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function xO(n,e,t,i,r,s,o,a){return new _a(n,e,t,i,r,s,o,a)}function y_(n){return new _a(n)}function b1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function P2(n){return n.collectionGroup!==null}function fl(n){const e=le(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ht(Ct.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new tu(s,i))}),t.has(Ct.keyField().canonicalString())||e.ce.push(new tu(Ct.keyField(),i))}return e.ce}function gi(n){const e=le(n);return e.le||(e.le=SO(e,fl(n))),e.le}function SO(n,e){if(n.limitType==="F")return F1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new tu(r.field,s)});const t=n.endAt?new bh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new bh(n.startAt.position,n.startAt.inclusive):null;return F1(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function wp(n,e){const t=n.filters.concat([e]);return new _a(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Tp(n,e,t){return new _a(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ld(n,e){return __(gi(n),gi(e))&&n.limitType===e.limitType}function D2(n){return`${m_(gi(n))}|lt:${n.limitType}`}function ao(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>S2(r)).join(", ")}]`),Dd(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>ta(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>ta(r)).join(",")),`Target(${i})`}(gi(n))}; limitType=${n.limitType})`}function Md(n,e){return e.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ne.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(const s of fl(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(o,a,l){const c=O1(o,a,l);return o.inclusive?c<=0:c<0}(i.startAt,fl(i),r)||i.endAt&&!function(o,a,l){const c=O1(o,a,l);return o.inclusive?c>=0:c>0}(i.endAt,fl(i),r))}(n,e)}function AO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function k2(n){return(e,t)=>{let i=!1;for(const r of fl(n)){const s=PO(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function PO(n,e,t){const i=n.field.isKeyField()?ne.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ea(l,c):oe()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){bs(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return E2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO=new Ke(ne.comparator);function Yi(){return DO}const L2=new Ke(ne.comparator);function Ja(...n){let e=L2;for(const t of n)e=e.insert(t.key,t);return e}function M2(n){let e=L2;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function vs(){return gl()}function O2(){return gl()}function gl(){return new Vs(n=>n.toString(),(n,e)=>n.isEqual(e))}const kO=new Ke(ne.comparator),LO=new ht(ne.comparator);function ge(...n){let e=LO;for(const t of n)e=e.add(t);return e}const MO=new ht(me);function OO(){return MO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fh(e)?"-0":e}}function N2(n){return{integerValue:""+n}}function NO(n,e){return uO(e)?N2(e):v_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(){this._=void 0}}function FO(n,e,t){return n instanceof nu?function(r,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&g_(s)&&(s=kd(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof iu?b2(n,e):n instanceof ru?V2(n,e):function(r,s){const o=F2(r,s),a=V1(o)+V1(r.Pe);return yp(o)&&yp(r.Pe)?N2(a):v_(r.serializer,a)}(n,e)}function bO(n,e,t){return n instanceof iu?b2(n,e):n instanceof ru?V2(n,e):t}function F2(n,e){return n instanceof Vh?function(i){return yp(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}class nu extends Od{}class iu extends Od{constructor(e){super(),this.elements=e}}function b2(n,e){const t=z2(e);for(const i of n.elements)t.some(r=>_i(r,i))||t.push(i);return{arrayValue:{values:t}}}class ru extends Od{constructor(e){super(),this.elements=e}}function V2(n,e){let t=z2(e);for(const i of n.elements)t=t.filter(r=>!_i(r,i));return{arrayValue:{values:t}}}class Vh extends Od{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function V1(n){return Qe(n.integerValue||n.doubleValue)}function z2(n){return p_(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e,t){this.field=e,this.transform=t}}function zO(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof iu&&r instanceof iu||i instanceof ru&&r instanceof ru?Jo(i.elements,r.elements,_i):i instanceof Vh&&r instanceof Vh?_i(i.Pe,r.Pe):i instanceof nu&&r instanceof nu}(n.transform,e.transform)}class UO{constructor(e,t){this.version=e,this.transformResults=t}}class pi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new pi}static exists(e){return new pi(void 0,e)}static updateTime(e){return new pi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Nd{}function U2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new E_(n.key,pi.none()):new Tu(n.key,n.data,pi.none());{const t=n.data,i=Rn.empty();let r=new ht(Ct.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new zs(n.key,i,new $n(r.toArray()),pi.none())}}function BO(n,e,t){n instanceof Tu?function(r,s,o){const a=r.value.clone(),l=U1(r.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof zs?function(r,s,o){if(!Gc(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=U1(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(B2(r)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function pl(n,e,t,i){return n instanceof Tu?function(s,o,a,l){if(!Gc(s.precondition,o))return a;const c=s.value.clone(),h=B1(s.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,i):n instanceof zs?function(s,o,a,l){if(!Gc(s.precondition,o))return a;const c=B1(s.fieldTransforms,l,o),h=o.data;return h.setAll(B2(s)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(n,e,t,i):function(s,o,a){return Gc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function jO(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=F2(i.transform,r||null);s!=null&&(t===null&&(t=Rn.empty()),t.set(i.field,s))}return t||null}function z1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Jo(i,r,(s,o)=>zO(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Tu extends Nd{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class zs extends Nd{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function B2(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function U1(n,e,t){const i=new Map;Se(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,bO(o,a,t[r]))}return i}function B1(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,FO(s,o,e))}return i}class E_ extends Nd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GO extends Nd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&BO(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=pl(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=pl(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=O2();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=U2(o,a);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(ae.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ge())}isEqual(e){return this.batchId===e.batchId&&Jo(this.mutations,e.mutations,(t,i)=>z1(t,i))&&Jo(this.baseMutations,e.baseMutations,(t,i)=>z1(t,i))}}class w_{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Se(e.mutations.length===i.length);let r=function(){return kO}();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new w_(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt,_e;function XO(n){switch(n){default:return oe();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function j2(n){if(n===void 0)return qi("GRPC error has no .code"),z.UNKNOWN;switch(n){case nt.OK:return z.OK;case nt.CANCELLED:return z.CANCELLED;case nt.UNKNOWN:return z.UNKNOWN;case nt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case nt.INTERNAL:return z.INTERNAL;case nt.UNAVAILABLE:return z.UNAVAILABLE;case nt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case nt.NOT_FOUND:return z.NOT_FOUND;case nt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case nt.ABORTED:return z.ABORTED;case nt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case nt.DATA_LOSS:return z.DATA_LOSS;default:return oe()}}(_e=nt||(nt={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO=new Is([4294967295,4294967295],0);function j1(n){const e=HO().encode(n),t=new d2;return t.update(e),new Uint8Array(t.digest())}function G1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Is([t,i],0),new Is([r,s],0)]}class T_{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new el(`Invalid padding: ${t}`);if(i<0)throw new el(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new el(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new el(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Is.fromNumber(this.Te)}Ee(e,t,i){let r=e.add(t.multiply(Is.fromNumber(i)));return r.compare(qO)===1&&(r=new Is([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=j1(e),[i,r]=G1(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new T_(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const t=j1(e),[i,r]=G1(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class el extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Iu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Fd(ae.min(),r,new Ke(me),Yi(),ge())}}class Iu{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Iu(i,t,ge(),ge(),ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}}class G2{constructor(e,t){this.targetId=e,this.me=t}}class W2{constructor(e,t,i=Pt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class W1{constructor(){this.fe=0,this.ge=$1(),this.pe=Pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ge(),t=ge(),i=ge();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:oe()}}),new Iu(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=$1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Se(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class YO{constructor(e){this.Le=e,this.Be=new Map,this.ke=Yi(),this.qe=Rc(),this.Qe=Rc(),this.Ke=new Ke(me)}$e(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{const i=this.ze(t);switch(e.state){case 0:this.je(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.je(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),i.De(e.resumeToken));break;default:oe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.je(r)&&t(r)})}Je(e){const t=e.targetId,i=e.me.count,r=this.Ye(t);if(r){const s=r.target;if(Ep(s))if(i===0){const o=new ne(s.path);this.We(t,o,zt.newNoDocument(o,ae.min()))}else Se(i===1);else{const o=this.Ze(t);if(o!==i){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}}}}}Xe(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=Kr(i).toUint8Array()}catch(l){if(l instanceof w2)return Qo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new T_(o,r,s)}catch(l){return Qo(l instanceof el?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,t,i){return t.me.count===i-this.rt(e,t.targetId)?0:2}rt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let r=0;return i.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(t,s,null),r++)}),r}it(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Ep(a.target)){const l=new ne(a.target.path);this.st(l).has(o)||this.ot(o,l)||this.We(o,l,zt.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let i=ge();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const r=new Fd(e,t,this.Ke,this.ke,i);return this.ke=Yi(),this.qe=Rc(),this.Qe=Rc(),this.Ke=new Ke(me),r}Ue(e,t){if(!this.je(e))return;const i=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,i){if(!this.je(e))return;const r=this.ze(e);this.ot(e,t)?r.Fe(t,1):r.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Be.get(e);return t||(t=new W1,this.Be.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new ht(me),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ht(me),this.qe=this.qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||q("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new W1),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Rc(){return new Ke(ne.comparator)}function $1(){return new Ke(ne.comparator)}const ZO={asc:"ASCENDING",desc:"DESCENDING"},QO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JO={and:"AND",or:"OR"};class eN{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ip(n,e){return n.useProto3Json||Dd(e)?e:{value:e}}function zh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function tN(n,e){return zh(n,e.toTimestamp())}function mi(n){return Se(!!n),ae.fromTimestamp(function(t){const i=$r(t);return new ct(i.seconds,i.nanos)}(n))}function I_(n,e){return Cp(n,e).canonicalString()}function Cp(n,e){const t=function(r){return new ze(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function K2(n){const e=ze.fromString(n);return Se(Z2(e)),e}function Rp(n,e){return I_(n.databaseId,e.path)}function Qf(n,e){const t=K2(e);if(t.get(1)!==n.databaseId.projectId)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ne(H2(t))}function X2(n,e){return I_(n.databaseId,e)}function nN(n){const e=K2(n);return e.length===4?ze.emptyPath():H2(e)}function xp(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function H2(n){return Se(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function K1(n,e,t){return{name:Rp(n,e),fields:t.value.mapValue.fields}}function iN(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:oe()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(c,h){return c.useProto3Json?(Se(h===void 0||typeof h=="string"),Pt.fromBase64String(h||"")):(Se(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Pt.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?z.UNKNOWN:j2(c.code);return new Q(h,c.message||"")}(o);t=new W2(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Qf(n,i.document.name),s=mi(i.document.updateTime),o=i.document.createTime?mi(i.document.createTime):ae.min(),a=new Rn({mapValue:{fields:i.document.fields}}),l=zt.newFoundDocument(r,s,o,a),c=i.targetIds||[],h=i.removedTargetIds||[];t=new Wc(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Qf(n,i.document),s=i.readTime?mi(i.readTime):ae.min(),o=zt.newNoDocument(r,s),a=i.removedTargetIds||[];t=new Wc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Qf(n,i.document),s=i.removedTargetIds||[];t=new Wc([],s,r,null)}else{if(!("filter"in e))return oe();{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new KO(r,s),a=i.targetId;t=new G2(a,o)}}return t}function rN(n,e){let t;if(e instanceof Tu)t={update:K1(n,e.key,e.value)};else if(e instanceof E_)t={delete:Rp(n,e.key)};else if(e instanceof zs)t={update:K1(n,e.key,e.data),updateMask:fN(e.fieldMask)};else{if(!(e instanceof GO))return oe();t={verify:Rp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof nu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof iu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ru)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Vh)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw oe()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:tN(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:oe()}(n,e.precondition)),t}function sN(n,e){return n&&n.length>0?(Se(e!==void 0),n.map(t=>function(r,s){let o=r.updateTime?mi(r.updateTime):mi(s);return o.isEqual(ae.min())&&(o=mi(s)),new UO(o,r.transformResults||[])}(t,e))):[]}function oN(n,e){return{documents:[X2(n,e.path)]}}function aN(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=X2(n,r);const s=function(c){if(c.length!==0)return Y2(Zn.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(h=>function(f){return{field:lo(f.field),direction:cN(f.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Ip(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ct:t,parent:r}}function lN(n){let e=nN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Se(i===1);const h=t.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(d){const f=q2(d);return f instanceof Zn&&R2(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(_){return new tu(uo(_.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Dd(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(d){const f=!!d.before,p=d.values||[];return new bh(p,f)}(t.startAt));let c=null;return t.endAt&&(c=function(d){const f=!d.before,p=d.values||[];return new bh(p,f)}(t.endAt)),xO(e,r,o,s,a,"F",l,c)}function uN(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function q2(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=uo(t.unaryFilter.field);return rt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=uo(t.unaryFilter.field);return rt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=uo(t.unaryFilter.field);return rt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=uo(t.unaryFilter.field);return rt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return oe()}}(n):n.fieldFilter!==void 0?function(t){return rt.create(uo(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return oe()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Zn.create(t.compositeFilter.filters.map(i=>q2(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return oe()}}(t.compositeFilter.op))}(n):oe()}function cN(n){return ZO[n]}function hN(n){return QO[n]}function dN(n){return JO[n]}function lo(n){return{fieldPath:n.canonicalString()}}function uo(n){return Ct.fromServerFormat(n.fieldPath)}function Y2(n){return n instanceof rt?function(t){if(t.op==="=="){if(M1(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NAN"}};if(L1(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(M1(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NOT_NAN"}};if(L1(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lo(t.field),op:hN(t.op),value:t.value}}}(n):n instanceof Zn?function(t){const i=t.getFilters().map(r=>Y2(r));return i.length===1?i[0]:{compositeFilter:{op:dN(t.op),filters:i}}}(n):oe()}function fN(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Z2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t,i,r,s=ae.min(),o=ae.min(),a=Pt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Rr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e){this.ht=e}}function pN(n){const e=lN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Tp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(){this.ln=new _N}addToCollectionParentIndex(e,t){return this.ln.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Wr.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Wr.min())}updateCollectionGroup(e,t,i){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class _N{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new ht(ze.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new ht(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class qt{static withCacheSize(e){return new qt(e,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qt.DEFAULT_COLLECTION_PERCENTILE=10,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qt.DEFAULT=new qt(41943040,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qt.DISABLED=new qt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new na(0)}static Qn(){return new na(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1([n,e],[t,i]){const r=me(n,t);return r===0?me(e,i):r}class yN{constructor(e){this.Gn=e,this.buffer=new ht(H1),this.zn=0}jn(){return++this.zn}Hn(e){const t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();H1(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class vN{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ma(t)?q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await pa(t)}await this.Yn(3e5)})}}class EN{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return V.resolve(Pd.oe);const i=new yN(t);return this.Zn.forEachTarget(e,r=>i.Hn(r.sequenceNumber)).next(()=>this.Zn.er(e,r=>i.Hn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Zn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(X1)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),X1):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let i,r,s,o,a,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r))).next(d=>(i=d,a=Date.now(),this.removeTargets(e,i,t))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(d=>(c=Date.now(),oo()<=ye.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d})))}}function wN(n,e){return new EN(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(){this.changes=new Vs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,zt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?V.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&pl(i.mutation,r,$n.empty(),ct.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ge()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ge()){const r=vs();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=Ja();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=vs();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ge()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=Yi();const o=gl(),a=function(){return gl()}();return t.forEach((l,c)=>{const h=i.get(c.key);r.has(c.key)&&(h===void 0||h.mutation instanceof zs)?s=s.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),pl(h.mutation,c,h.mutation.getFieldMask(),ct.now())):o.set(c.key,$n.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var d;return a.set(c,new IN(h,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const i=gl();let r=new Ke((o,a)=>o-a),s=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=i.get(l)||$n.empty();h=a.applyToLocalView(c,h),i.set(l,h);const d=(r.get(a.batchId)||ge()).add(l);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,d=O2();h.forEach(f=>{if(!s.has(f)){const p=U2(t.get(f),i.get(f));p!==null&&d.set(f,p),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return V.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(o){return ne.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):P2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):V.resolve(vs());let a=-1,l=s;return o.next(c=>V.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(h)?V.resolve():this.remoteDocumentCache.getEntry(e,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,ge())).next(h=>({batchId:a,changes:M2(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ne(t)).next(i=>{let r=Ja();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Ja();return this.indexManager.getCollectionParents(e,s).next(a=>V.forEach(a,l=>{const c=function(d,f){return new _a(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,i,r).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,zt.newInvalidDocument(h)))});let a=Ja();return o.forEach((l,c)=>{const h=s.get(l);h!==void 0&&pl(h.mutation,c,$n.empty(),ct.now()),Md(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return V.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:mi(r.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(r){return{name:r.name,query:pN(r.bundledQuery),readTime:mi(r.readTime)}}(t)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(){this.overlays=new Ke(ne.comparator),this.Er=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const i=vs();return V.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.Tt(e,t,s)}),V.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.Er.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Er.delete(i)),V.resolve()}getOverlaysForCollection(e,t,i){const r=vs(),s=t.length+1,o=new ne(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return V.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Ke((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let h=s.get(c.largestBatchId);h===null&&(h=vs(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=vs(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=r)););return V.resolve(a)}Tt(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.Er.get(r.largestBatchId).delete(i.key);this.Er.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new $O(t,i));let s=this.Er.get(t);s===void 0&&(s=ge(),this.Er.set(t,s)),this.Er.set(t,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(){this.dr=new ht(gt.Ar),this.Rr=new ht(gt.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,t){const i=new gt(e,t);this.dr=this.dr.add(i),this.Rr=this.Rr.add(i)}mr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.gr(new gt(e,t))}pr(e,t){e.forEach(i=>this.removeReference(i,t))}yr(e){const t=new ne(new ze([])),i=new gt(t,e),r=new gt(t,e+1),s=[];return this.Rr.forEachInRange([i,r],o=>{this.gr(o),s.push(o.key)}),s}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const t=new ne(new ze([])),i=new gt(t,e),r=new gt(t,e+1);let s=ge();return this.Rr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new gt(e,0),i=this.dr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class gt{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return ne.comparator(e.key,t.key)||me(e.br,t.br)}static Vr(e,t){return me(e.br,t.br)||ne.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new ht(gt.Ar)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new WO(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.vr=this.vr.add(new gt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.Fr(i),s=r<0?0:r;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new gt(t,0),r=new gt(t,Number.POSITIVE_INFINITY),s=[];return this.vr.forEachInRange([i,r],o=>{const a=this.Cr(o.br);s.push(a)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new ht(me);return t.forEach(r=>{const s=new gt(r,0),o=new gt(r,Number.POSITIVE_INFINITY);this.vr.forEachInRange([s,o],a=>{i=i.add(a.br)})}),V.resolve(this.Mr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;ne.isDocumentKey(s)||(s=s.child(""));const o=new gt(new ne(s),0);let a=new ht(me);return this.vr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.br)),!0)},o),V.resolve(this.Mr(a))}Mr(e){const t=[];return e.forEach(i=>{const r=this.Cr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Se(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.vr;return V.forEach(t.mutations,r=>{const s=new gt(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.vr=i})}Ln(e){}containsKey(e,t){const i=new gt(t,0),r=this.vr.firstAfterOrEqual(i);return V.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e){this.Nr=e,this.docs=function(){return new Ke(ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Nr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return V.resolve(i?i.document.mutableCopy():zt.newInvalidDocument(t))}getEntries(e,t){let i=Yi();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():zt.newInvalidDocument(r))}),V.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Yi();const o=t.path,a=new ne(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||sO(rO(h),i)<=0||(r.has(h.key)||Md(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,i,r){oe()}Lr(e,t){return V.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new DN(this)}getSize(e){return V.resolve(this.size)}}class DN extends TN{constructor(e){super(),this.hr=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.hr.addEntry(e,r)):this.hr.removeEntry(i)}),V.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.persistence=e,this.Br=new Vs(t=>m_(t),__),this.lastRemoteSnapshotVersion=ae.min(),this.highestTargetId=0,this.kr=0,this.qr=new C_,this.targetCount=0,this.Qr=na.qn()}forEachTarget(e,t){return this.Br.forEach((i,r)=>t(r)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.kr&&(this.kr=t),V.resolve()}Un(e){this.Br.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Qr=new na(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Un(t),V.resolve()}removeTargetData(e,t){return this.Br.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.Br.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.Br.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),V.waitFor(s).next(()=>r)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const i=this.Br.get(t)||null;return V.resolve(i)}addMatchingKeys(e,t,i){return this.qr.mr(t,i),V.resolve()}removeMatchingKeys(e,t,i){this.qr.pr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const i=this.qr.Sr(t);return V.resolve(i)}containsKey(e,t){return V.resolve(this.qr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,t){this.Kr={},this.overlays={},this.$r=new Pd(0),this.Ur=!1,this.Ur=!0,this.Wr=new SN,this.referenceDelegate=e(this),this.Gr=new kN(this),this.indexManager=new mN,this.remoteDocumentCache=function(r){return new PN(r)}(i=>this.referenceDelegate.zr(i)),this.serializer=new gN(t),this.jr=new RN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Kr[e.toKey()];return i||(i=new AN(t,this.referenceDelegate),this.Kr[e.toKey()]=i),i}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,i){q("MemoryPersistence","Starting transaction:",e);const r=new LN(this.$r.next());return this.referenceDelegate.Hr(),i(r).next(s=>this.referenceDelegate.Jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Yr(e,t){return V.or(Object.values(this.Kr).map(i=>()=>i.containsKey(e,t)))}}class LN extends aO{constructor(e){super(),this.currentSequenceNumber=e}}class R_{constructor(e){this.persistence=e,this.Zr=new C_,this.Xr=null}static ei(e){return new R_(e)}get ti(){if(this.Xr)return this.Xr;throw oe()}addReference(e,t,i){return this.Zr.addReference(i,t),this.ti.delete(i.toString()),V.resolve()}removeReference(e,t,i){return this.Zr.removeReference(i,t),this.ti.add(i.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),V.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(r=>this.ti.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.ti.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.ti,i=>{const r=ne.fromPath(i);return this.ni(e,r).next(s=>{s||t.removeEntry(r,ae.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(i=>{i?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return V.or([()=>V.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}}class Uh{constructor(e,t){this.persistence=e,this.ri=new Vs(i=>cO(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=wN(this,t)}static ei(e,t){return new Uh(e,t)}Hr(){}Jr(e){return V.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){const t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}nr(e){let t=0;return this.er(e,i=>{t++}).next(()=>t)}er(e,t){return V.forEach(this.ri,(i,r)=>this.ir(e,i,r).next(s=>s?V.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.Lr(e,o=>this.ir(e,o,t).next(a=>{a||(i++,s.removeEntry(o,ae.min()))})).next(()=>s.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),V.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),V.resolve()}removeReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),V.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Bc(e.data.value)),t}ir(e,t,i){return V.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.ri.get(t);return V.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Wi=i,this.Gi=r}static zi(e,t){let i=ge(),r=ge();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new x_(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return LL()?8:lO(DL())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.Xi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.es(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new MN;return this.ts(e,t,o).next(a=>{if(s.result=a,this.Hi)return this.ns(e,t,o,a.size)})}).next(()=>s.result)}ns(e,t,i,r){return i.documentReadCount<this.Ji?(oo()<=ye.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",ao(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),V.resolve()):(oo()<=ye.DEBUG&&q("QueryEngine","Query:",ao(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Yi*r?(oo()<=ye.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",ao(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gi(t))):V.resolve())}Xi(e,t){if(b1(t))return V.resolve(null);let i=gi(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Tp(t,null,"F"),i=gi(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=ge(...s);return this.Zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const c=this.rs(t,a);return this.ss(t,c,o,l.readTime)?this.Xi(e,Tp(t,null,"F")):this.os(e,c,t,l)}))})))}es(e,t,i,r){return b1(t)||r.isEqual(ae.min())?V.resolve(null):this.Zi.getDocuments(e,i).next(s=>{const o=this.rs(t,s);return this.ss(t,o,i,r)?V.resolve(null):(oo()<=ye.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ao(t)),this.os(e,o,t,iO(r,-1)).next(a=>a))})}rs(e,t){let i=new ht(k2(e));return t.forEach((r,s)=>{Md(e,s)&&(i=i.add(s))}),i}ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ts(e,t,i){return oo()<=ye.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",ao(t)),this.Zi.getDocumentsMatchingQuery(e,t,Wr.min(),i)}os(e,t,i,r){return this.Zi.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e,t,i,r){this.persistence=e,this._s=t,this.serializer=r,this.us=new Ke(me),this.cs=new Vs(s=>m_(s),__),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(i)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CN(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}}function FN(n,e,t,i){return new NN(n,e,t,i)}async function J2(n,e){const t=le(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.Ps(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let l=ge();for(const c of r){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Ts:c,removedBatchIds:o,addedBatchIds:a}))})})}function bN(n,e){const t=le(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.hs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const d=c.batch,f=d.keys();let p=V.resolve();return f.forEach(_=>{p=p.next(()=>h.getEntry(l,_)).next(w=>{const T=c.docVersions.get(_);Se(T!==null),w.version.compareTo(T)<0&&(d.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),h.addEntry(w)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let l=ge();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function eC(n){const e=le(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function VN(n,e){const t=le(n),i=e.snapshotVersion;let r=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.hs.newChangeBuffer({trackRemovals:!0});r=t.us;const a=[];e.targetChanges.forEach((h,d)=>{const f=r.get(d);if(!f)return;a.push(t.Gr.removeMatchingKeys(s,h.removedDocuments,d).next(()=>t.Gr.addMatchingKeys(s,h.addedDocuments,d)));let p=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Pt.EMPTY_BYTE_STRING,ae.min()).withLastLimboFreeSnapshotVersion(ae.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,i)),r=r.insert(d,p),function(w,T,v){return w.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,p,h)&&a.push(t.Gr.updateTargetData(s,p))});let l=Yi(),c=ge();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(zN(s,o,e.documentUpdates).next(h=>{l=h.Is,c=h.Es})),!i.isEqual(ae.min())){const h=t.Gr.getLastRemoteSnapshotVersion(s).next(d=>t.Gr.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(h)}return V.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.us=r,s))}function zN(n,e,t){let i=ge(),r=ge();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=Yi();return t.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(ae.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Is:o,Es:r}})}function UN(n,e){const t=le(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function BN(n,e){const t=le(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Gr.getTargetData(i,e).next(s=>s?(r=s,V.resolve(r)):t.Gr.allocateTargetId(i).next(o=>(r=new Rr(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Gr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.us.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.us=t.us.insert(i.targetId,i),t.cs.set(e,i.targetId)),i})}async function Sp(n,e,t){const i=le(n),r=i.us.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!ma(o))throw o;q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.us=i.us.remove(e),i.cs.delete(r.target)}function q1(n,e,t){const i=le(n);let r=ae.min(),s=ge();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=le(l),f=d.cs.get(h);return f!==void 0?V.resolve(d.us.get(f)):d.Gr.getTargetData(c,h)}(i,o,gi(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Gr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i._s.getDocumentsMatchingQuery(o,e,t?r:ae.min(),t?s:ge())).next(a=>(jN(i,AO(e),a),{documents:a,ds:s})))}function jN(n,e,t){let i=n.ls.get(e)||ae.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.ls.set(e,i)}class Y1{constructor(){this.activeTargetIds=OO()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GN{constructor(){this._o=new Y1,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,i){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new Y1,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xc=null;function Jf(){return xc===null?xc=function(){return 268435456+Math.round(2147483648*Math.random())}():xc++,"0x"+xc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ot="WebChannelConnection";class XN extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Fo=i+"://"+t.host,this.Mo=`projects/${r}/databases/${s}`,this.xo=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Oo(t,i,r,s,o){const a=Jf(),l=this.No(t,i.toUriEncodedString());q("RestConnection",`Sending RPC '${t}' ${a}:`,l,r);const c={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(c,s,o),this.Bo(t,l,c,r).then(h=>(q("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw Qo("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",r),h})}ko(t,i,r,s,o,a){return this.Oo(t,i,r,s,o)}Lo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ga}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}No(t,i){const r=$N[t];return`${this.Fo}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,t,i,r){const s=Jf();return new Promise((o,a)=>{const l=new f2;l.setWithCredentials(!0),l.listenOnce(g2.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Uc.NO_ERROR:const h=l.getResponseJson();q(Ot,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Uc.TIMEOUT:q(Ot,`RPC '${e}' ${s} timed out`),a(new Q(z.DEADLINE_EXCEEDED,"Request time out"));break;case Uc.HTTP_ERROR:const d=l.getStatus();if(q(Ot,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const _=function(T){const v=T.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(v)>=0?v:z.UNKNOWN}(p.status);a(new Q(_,p.message))}else a(new Q(z.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Q(z.UNAVAILABLE,"Connection failed."));break;default:oe()}}finally{q(Ot,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(r);q(Ot,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",c,i,15)})}qo(e,t,i){const r=Jf(),s=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=_2(),a=m2(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Lo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const h=s.join("");q(Ot,`Creating RPC '${e}' stream ${r}: ${h}`,l);const d=o.createWebChannel(h,l);let f=!1,p=!1;const _=new KN({Eo:T=>{p?q(Ot,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(f||(q(Ot,`Opening RPC '${e}' stream ${r} transport.`),d.open(),f=!0),q(Ot,`RPC '${e}' stream ${r} sending:`,T),d.send(T))},Ao:()=>d.close()}),w=(T,v,y)=>{T.listen(v,I=>{try{y(I)}catch(S){setTimeout(()=>{throw S},0)}})};return w(d,Qa.EventType.OPEN,()=>{p||(q(Ot,`RPC '${e}' stream ${r} transport opened.`),_.So())}),w(d,Qa.EventType.CLOSE,()=>{p||(p=!0,q(Ot,`RPC '${e}' stream ${r} transport closed`),_.Do())}),w(d,Qa.EventType.ERROR,T=>{p||(p=!0,Qo(Ot,`RPC '${e}' stream ${r} transport errored:`,T),_.Do(new Q(z.UNAVAILABLE,"The operation could not be completed")))}),w(d,Qa.EventType.MESSAGE,T=>{var v;if(!p){const y=T.data[0];Se(!!y);const I=y,S=(I==null?void 0:I.error)||((v=I[0])===null||v===void 0?void 0:v.error);if(S){q(Ot,`RPC '${e}' stream ${r} received error:`,S);const k=S.status;let O=function(R){const P=nt[R];if(P!==void 0)return j2(P)}(k),C=S.message;O===void 0&&(O=z.INTERNAL,C="Unknown error status: "+k+" with message "+S.message),p=!0,_.Do(new Q(O,C)),d.close()}else q(Ot,`RPC '${e}' stream ${r} received:`,y),_.vo(y)}}),w(a,p2.STAT_EVENT,T=>{T.stat===mp.PROXY?q(Ot,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===mp.NOPROXY&&q(Ot,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{_.bo()},0),_}}function eg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(n){return new eN(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e,t,i=1e3,r=1.5,s=6e4){this.li=e,this.timerId=t,this.Qo=i,this.Ko=r,this.$o=s,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const t=Math.floor(this.Uo+this.Ho()),i=Math.max(0,Date.now()-this.Go),r=Math.max(0,t-i);r>0&&q("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,r,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,t,i,r,s,o,a,l){this.li=e,this.Yo=i,this.Zo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new tC(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,t){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===z.RESOURCE_EXHAUSTED?(qi(t.toString()),qi("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(t)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Xo===t&&this.I_(i,r)},i=>{e(()=>{const r=new Q(z.UNKNOWN,"Fetching auth token failed: "+i.message);return this.E_(r)})})}I_(e,t){const i=this.T_(this.Xo);this.stream=this.d_(e,t),this.stream.Ro(()=>{i(()=>this.listener.Ro())}),this.stream.mo(()=>{i(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(r=>{i(()=>this.E_(r))}),this.stream.onMessage(r=>{i(()=>++this.n_==1?this.A_(r):this.onNext(r))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class HN extends nC{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}d_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const t=iN(this.serializer,e),i=function(s){if(!("targetChange"in s))return ae.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ae.min():o.readTime?mi(o.readTime):ae.min()}(e);return this.listener.R_(t,i)}V_(e){const t={};t.database=xp(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=Ep(l)?{documents:oN(s,l)}:{query:aN(s,l).ct},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=$2(s,o.resumeToken);const c=Ip(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ae.min())>0){a.readTime=zh(s,o.snapshotVersion.toTimestamp());const c=Ip(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const i=uN(this.serializer,e);i&&(t.labels=i),this.c_(t)}m_(e){const t={};t.database=xp(this.serializer),t.removeTarget=e,this.c_(t)}}class qN extends nC{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,t){return this.connection.qo("Write",e,t)}A_(e){return Se(!!e.streamToken),this.lastStreamToken=e.streamToken,Se(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const t=sN(e.writeResults,e.commitTime),i=mi(e.commitTime);return this.listener.y_(i,t)}w_(){const e={};e.database=xp(this.serializer),this.c_(e)}g_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>rN(this.serializer,i))};this.c_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.S_=!1}b_(){if(this.S_)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,i,r){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Oo(e,Cp(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Q(z.UNKNOWN,s.toString())})}ko(e,t,i,r,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.ko(e,Cp(t,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(z.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class ZN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(qi(t),this.C_=!1):q("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=s,this.Q_.uo(o=>{i.enqueueAndForget(async()=>{Us(this)&&(q("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=le(l);c.k_.add(4),await Cu(c),c.K_.set("Unknown"),c.k_.delete(4),await Vd(c)}(this))})}),this.K_=new ZN(i,r)}}async function Vd(n){if(Us(n))for(const e of n.q_)await e(!0)}async function Cu(n){for(const e of n.q_)await e(!1)}function iC(n,e){const t=le(n);t.B_.has(e.targetId)||(t.B_.set(e.targetId,e),D_(t)?P_(t):ya(t).s_()&&A_(t,e))}function S_(n,e){const t=le(n),i=ya(t);t.B_.delete(e),i.s_()&&rC(t,e),t.B_.size===0&&(i.s_()?i.a_():Us(t)&&t.K_.set("Unknown"))}function A_(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ae.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ya(n).V_(e)}function rC(n,e){n.U_.xe(e),ya(n).m_(e)}function P_(n){n.U_=new YO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.B_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),ya(n).start(),n.K_.F_()}function D_(n){return Us(n)&&!ya(n).i_()&&n.B_.size>0}function Us(n){return le(n).k_.size===0}function sC(n){n.U_=void 0}async function JN(n){n.K_.set("Online")}async function e6(n){n.B_.forEach((e,t)=>{A_(n,e)})}async function t6(n,e){sC(n),D_(n)?(n.K_.O_(e),P_(n)):n.K_.set("Unknown")}async function n6(n,e,t){if(n.K_.set("Online"),e instanceof W2&&e.state===2&&e.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.B_.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.B_.delete(a),r.U_.removeTarget(a))}(n,e)}catch(i){q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Bh(n,i)}else if(e instanceof Wc?n.U_.$e(e):e instanceof G2?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(ae.min()))try{const i=await eC(n.localStore);t.compareTo(i)>=0&&await function(s,o){const a=s.U_.it(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.B_.get(c);h&&s.B_.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=s.B_.get(l);if(!h)return;s.B_.set(l,h.withResumeToken(Pt.EMPTY_BYTE_STRING,h.snapshotVersion)),rC(s,l);const d=new Rr(h.target,l,c,h.sequenceNumber);A_(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(i){q("RemoteStore","Failed to raise snapshot:",i),await Bh(n,i)}}async function Bh(n,e,t){if(!ma(e))throw e;n.k_.add(1),await Cu(n),n.K_.set("Offline"),t||(t=()=>eC(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{q("RemoteStore","Retrying IndexedDB access"),await t(),n.k_.delete(1),await Vd(n)})}function oC(n,e){return e().catch(t=>Bh(n,t,e))}async function zd(n){const e=le(n),t=Hr(e);let i=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;i6(e);)try{const r=await UN(e.localStore,i);if(r===null){e.L_.length===0&&t.a_();break}i=r.batchId,r6(e,r)}catch(r){await Bh(e,r)}aC(e)&&lC(e)}function i6(n){return Us(n)&&n.L_.length<10}function r6(n,e){n.L_.push(e);const t=Hr(n);t.s_()&&t.f_&&t.g_(e.mutations)}function aC(n){return Us(n)&&!Hr(n).i_()&&n.L_.length>0}function lC(n){Hr(n).start()}async function s6(n){Hr(n).w_()}async function o6(n){const e=Hr(n);for(const t of n.L_)e.g_(t.mutations)}async function a6(n,e,t){const i=n.L_.shift(),r=w_.from(i,e,t);await oC(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await zd(n)}async function l6(n,e){e&&Hr(n).f_&&await async function(i,r){if(function(o){return XO(o)&&o!==z.ABORTED}(r.code)){const s=i.L_.shift();Hr(i).__(),await oC(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),await zd(i)}}(n,e),aC(n)&&lC(n)}async function Q1(n,e){const t=le(n);t.asyncQueue.verifyOperationInProgress(),q("RemoteStore","RemoteStore received new credentials");const i=Us(t);t.k_.add(3),await Cu(t),i&&t.K_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),await Vd(t)}async function u6(n,e){const t=le(n);e?(t.k_.delete(2),await Vd(t)):e||(t.k_.add(2),await Cu(t),t.K_.set("Unknown"))}function ya(n){return n.W_||(n.W_=function(t,i,r){const s=le(t);return s.b_(),new HN(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Ro:JN.bind(null,n),mo:e6.bind(null,n),po:t6.bind(null,n),R_:n6.bind(null,n)}),n.q_.push(async e=>{e?(n.W_.__(),D_(n)?P_(n):n.K_.set("Unknown")):(await n.W_.stop(),sC(n))})),n.W_}function Hr(n){return n.G_||(n.G_=function(t,i,r){const s=le(t);return s.b_(),new qN(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:s6.bind(null,n),po:l6.bind(null,n),p_:o6.bind(null,n),y_:a6.bind(null,n)}),n.q_.push(async e=>{e?(n.G_.__(),await zd(n)):(await n.G_.stop(),n.L_.length>0&&(q("RemoteStore",`Stopping write stream with ${n.L_.length} pending writes`),n.L_=[]))})),n.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new br,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new k_(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function L_(n,e){if(qi("AsyncQueue",`${e}: ${n}`),ma(n))return new Q(z.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{static emptySet(e){return new bo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ne.comparator(t.key,i.key):(t,i)=>ne.comparator(t.key,i.key),this.keyedMap=Ja(),this.sortedSet=new Ke(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof bo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new bo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(){this.z_=new Ke(ne.comparator)}track(e){const t=e.doc.key,i=this.z_.get(t);i?e.type!==0&&i.type===3?this.z_=this.z_.insert(t,e):e.type===3&&i.type!==1?this.z_=this.z_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.z_=this.z_.remove(t):e.type===1&&i.type===2?this.z_=this.z_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):oe():this.z_=this.z_.insert(t,e)}j_(){const e=[];return this.z_.inorderTraversal((t,i)=>{e.push(i)}),e}}class ia{constructor(e,t,i,r,s,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new ia(e,t,bo.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ld(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class h6{constructor(){this.queries=eE(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,i){const r=le(t),s=r.queries;r.queries=eE(),s.forEach((o,a)=>{for(const l of a.J_)l.onError(i)})})(this,new Q(z.ABORTED,"Firestore shutting down"))}}function eE(){return new Vs(n=>D2(n),Ld)}async function uC(n,e){const t=le(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.Y_()&&e.Z_()&&(i=2):(s=new c6,i=e.Z_()?0:1);try{switch(i){case 0:s.H_=await t.onListen(r,!0);break;case 1:s.H_=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=L_(o,`Initialization of query '${ao(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.J_.push(e),e.ea(t.onlineState),s.H_&&e.ta(s.H_)&&M_(t)}async function cC(n,e){const t=le(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.J_.indexOf(e);o>=0&&(s.J_.splice(o,1),s.J_.length===0?r=e.Z_()?0:1:!s.Y_()&&e.Z_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function d6(n,e){const t=le(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.J_)a.ta(r)&&(i=!0);o.H_=r}}i&&M_(t)}function f6(n,e,t){const i=le(n),r=i.queries.get(e);if(r)for(const s of r.J_)s.onError(t);i.queries.delete(e)}function M_(n){n.X_.forEach(e=>{e.next()})}var Ap,tE;(tE=Ap||(Ap={})).na="default",tE.Cache="cache";class hC{constructor(e,t,i){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=i||{}}ta(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new ia(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;const i=t!=="Offline";return(!this.options.ua||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Ap.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.key=e}}class fC{constructor(e){this.key=e}}class g6{constructor(e,t){this.query=e,this.da=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=ge(),this.mutatedKeys=ge(),this.Va=k2(e),this.ma=new bo(this.Va)}get fa(){return this.da}ga(e,t){const i=t?t.pa:new J1,r=t?t.ma:this.ma;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,d)=>{const f=r.get(h),p=Md(this.query,d)?d:null,_=!!f&&this.mutatedKeys.has(f.key),w=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let T=!1;f&&p?f.data.isEqual(p.data)?_!==w&&(i.track({type:3,doc:p}),T=!0):this.ya(f,p)||(i.track({type:2,doc:p}),T=!0,(l&&this.Va(p,l)>0||c&&this.Va(p,c)<0)&&(a=!0)):!f&&p?(i.track({type:0,doc:p}),T=!0):f&&!p&&(i.track({type:1,doc:f}),T=!0,(l||c)&&(a=!0)),T&&(p?(o=o.add(p),s=w?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),i.track({type:1,doc:h})}return{ma:o,pa:i,ss:a,mutatedKeys:s}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((h,d)=>function(p,_){const w=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe()}};return w(p)-w(_)}(h.type,d.type)||this.Va(h.doc,d.doc)),this.wa(i),r=r!=null&&r;const a=t&&!r?this.Sa():[],l=this.Ra.size===0&&this.current&&!r?1:0,c=l!==this.Aa;return this.Aa=l,o.length!==0||c?{snapshot:new ia(this.query,e.ma,s,o,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new J1,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.da=this.da.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.da=this.da.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=ge(),this.ma.forEach(i=>{this.Da(i.key)&&(this.Ra=this.Ra.add(i.key))});const t=[];return e.forEach(i=>{this.Ra.has(i)||t.push(new fC(i))}),this.Ra.forEach(i=>{e.has(i)||t.push(new dC(i))}),t}va(e){this.da=e.ds,this.Ra=ge();const t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return ia.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class p6{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class m6{constructor(e){this.key=e,this.Fa=!1}}class _6{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new Vs(a=>D2(a),Ld),this.Oa=new Map,this.Na=new Set,this.La=new Ke(ne.comparator),this.Ba=new Map,this.ka=new C_,this.qa={},this.Qa=new Map,this.Ka=na.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function y6(n,e,t=!0){const i=vC(n);let r;const s=i.xa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Ca()):r=await gC(i,e,t,!0),r}async function v6(n,e){const t=vC(n);await gC(t,e,!0,!1)}async function gC(n,e,t,i){const r=await BN(n.localStore,gi(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await E6(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&iC(n.remoteStore,r),a}async function E6(n,e,t,i,r){n.Ua=(d,f,p)=>async function(w,T,v,y){let I=T.view.ga(v);I.ss&&(I=await q1(w.localStore,T.query,!1).then(({documents:C})=>T.view.ga(C,I)));const S=y&&y.targetChanges.get(T.targetId),k=y&&y.targetMismatches.get(T.targetId)!=null,O=T.view.applyChanges(I,w.isPrimaryClient,S,k);return iE(w,T.targetId,O.ba),O.snapshot}(n,d,f,p);const s=await q1(n.localStore,e,!0),o=new g6(e,s.ds),a=o.ga(s.documents),l=Iu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),c=o.applyChanges(a,n.isPrimaryClient,l);iE(n,t,c.ba);const h=new p6(e,t,o);return n.xa.set(e,h),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),c.snapshot}async function w6(n,e,t){const i=le(n),r=i.xa.get(e),s=i.Oa.get(r.targetId);if(s.length>1)return i.Oa.set(r.targetId,s.filter(o=>!Ld(o,e))),void i.xa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Sp(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&S_(i.remoteStore,r.targetId),Pp(i,r.targetId)}).catch(pa)):(Pp(i,r.targetId),await Sp(i.localStore,r.targetId,!0))}async function T6(n,e){const t=le(n),i=t.xa.get(e),r=t.Oa.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),S_(t.remoteStore,i.targetId))}async function I6(n,e,t){const i=D6(n);try{const r=await function(o,a){const l=le(o),c=ct.now(),h=a.reduce((p,_)=>p.add(_.key),ge());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let _=Yi(),w=ge();return l.hs.getEntries(p,h).next(T=>{_=T,_.forEach((v,y)=>{y.isValidDocument()||(w=w.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,_)).next(T=>{d=T;const v=[];for(const y of a){const I=jO(y,d.get(y.key).overlayedDocument);I!=null&&v.push(new zs(y.key,I,T2(I.value.mapValue),pi.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,v,a)}).next(T=>{f=T;const v=T.applyToLocalDocumentSet(d,w);return l.documentOverlayCache.saveOverlays(p,T.batchId,v)})}).then(()=>({batchId:f.batchId,changes:M2(d)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,l){let c=o.qa[o.currentUser.toKey()];c||(c=new Ke(me)),c=c.insert(a,l),o.qa[o.currentUser.toKey()]=c}(i,r.batchId,t),await Ru(i,r.changes),await zd(i.remoteStore)}catch(r){const s=L_(r,"Failed to persist write");t.reject(s)}}async function pC(n,e){const t=le(n);try{const i=await VN(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.Ba.get(s);o&&(Se(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Fa=!0:r.modifiedDocuments.size>0?Se(o.Fa):r.removedDocuments.size>0&&(Se(o.Fa),o.Fa=!1))}),await Ru(t,i,e)}catch(i){await pa(i)}}function nE(n,e,t){const i=le(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.xa.forEach((s,o)=>{const a=o.view.ea(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=le(o);l.onlineState=a;let c=!1;l.queries.forEach((h,d)=>{for(const f of d.J_)f.ea(a)&&(c=!0)}),c&&M_(l)}(i.eventManager,e),r.length&&i.Ma.R_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function C6(n,e,t){const i=le(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Ba.get(e),s=r&&r.key;if(s){let o=new Ke(ne.comparator);o=o.insert(s,zt.newNoDocument(s,ae.min()));const a=ge().add(s),l=new Fd(ae.min(),new Map,new Ke(me),o,a);await pC(i,l),i.La=i.La.remove(s),i.Ba.delete(e),O_(i)}else await Sp(i.localStore,e,!1).then(()=>Pp(i,e,t)).catch(pa)}async function R6(n,e){const t=le(n),i=e.batch.batchId;try{const r=await bN(t.localStore,e);_C(t,i,null),mC(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ru(t,r)}catch(r){await pa(r)}}async function x6(n,e,t){const i=le(n);try{const r=await function(o,a){const l=le(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(Se(d!==null),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(i.localStore,e);_C(i,e,t),mC(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ru(i,r)}catch(r){await pa(r)}}function mC(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function _C(n,e,t){const i=le(n);let r=i.qa[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.qa[i.currentUser.toKey()]=r}}function Pp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Oa.get(e))n.xa.delete(i),t&&n.Ma.Wa(i,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(i=>{n.ka.containsKey(i)||yC(n,i)})}function yC(n,e){n.Na.delete(e.path.canonicalString());const t=n.La.get(e);t!==null&&(S_(n.remoteStore,t),n.La=n.La.remove(e),n.Ba.delete(t),O_(n))}function iE(n,e,t){for(const i of t)i instanceof dC?(n.ka.addReference(i.key,e),S6(n,i)):i instanceof fC?(q("SyncEngine","Document no longer in limbo: "+i.key),n.ka.removeReference(i.key,e),n.ka.containsKey(i.key)||yC(n,i.key)):oe()}function S6(n,e){const t=e.key,i=t.path.canonicalString();n.La.get(t)||n.Na.has(i)||(q("SyncEngine","New document in limbo: "+t),n.Na.add(i),O_(n))}function O_(n){for(;n.Na.size>0&&n.La.size<n.maxConcurrentLimboResolutions;){const e=n.Na.values().next().value;n.Na.delete(e);const t=new ne(ze.fromString(e)),i=n.Ka.next();n.Ba.set(i,new m6(t)),n.La=n.La.insert(t,i),iC(n.remoteStore,new Rr(gi(y_(t.path)),i,"TargetPurposeLimboResolution",Pd.oe))}}async function Ru(n,e,t){const i=le(n),r=[],s=[],o=[];i.xa.isEmpty()||(i.xa.forEach((a,l)=>{o.push(i.Ua(l,e,t).then(c=>{var h;if((c||t)&&i.isPrimaryClient){const d=c?!c.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){r.push(c);const d=x_.zi(l.targetId,c);s.push(d)}}))}),await Promise.all(o),i.Ma.R_(r),await async function(l,c){const h=le(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>V.forEach(c,f=>V.forEach(f.Wi,p=>h.persistence.referenceDelegate.addReference(d,f.targetId,p)).next(()=>V.forEach(f.Gi,p=>h.persistence.referenceDelegate.removeReference(d,f.targetId,p)))))}catch(d){if(!ma(d))throw d;q("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const p=h.us.get(f),_=p.snapshotVersion,w=p.withLastLimboFreeSnapshotVersion(_);h.us=h.us.insert(f,w)}}}(i.localStore,s))}async function A6(n,e){const t=le(n);if(!t.currentUser.isEqual(e)){q("SyncEngine","User change. New user:",e.toKey());const i=await J2(t.localStore,e);t.currentUser=e,function(s,o){s.Qa.forEach(a=>{a.forEach(l=>{l.reject(new Q(z.CANCELLED,o))})}),s.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ru(t,i.Ts)}}function P6(n,e){const t=le(n),i=t.Ba.get(e);if(i&&i.Fa)return ge().add(i.key);{let r=ge();const s=t.Oa.get(e);if(!s)return r;for(const o of s){const a=t.xa.get(o);r=r.unionWith(a.view.fa)}return r}}function vC(n){const e=le(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=pC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=P6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=C6.bind(null,e),e.Ma.R_=d6.bind(null,e.eventManager),e.Ma.Wa=f6.bind(null,e.eventManager),e}function D6(n){const e=le(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=R6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=x6.bind(null,e),e}class jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bd(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,t){return null}Ya(e,t){return null}Ha(e){return FN(this.persistence,new ON,e.initialUser,this.serializer)}ja(e){return new Q2(R_.ei,this.serializer)}za(e){return new GN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jh.provider={build:()=>new jh};class k6 extends jh{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){Se(this.persistence.referenceDelegate instanceof Uh);const i=this.persistence.referenceDelegate.garbageCollector;return new vN(i,e.asyncQueue,t)}ja(e){const t=this.cacheSizeBytes!==void 0?qt.withCacheSize(this.cacheSizeBytes):qt.DEFAULT;return new Q2(i=>Uh.ei(i,t),this.serializer)}}class Dp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>nE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=A6.bind(null,this.syncEngine),await u6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new h6}()}createDatastore(e){const t=bd(e.databaseInfo.databaseId),i=function(s){return new XN(s)}(e.databaseInfo);return function(s,o,a,l){return new YN(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,r,s,o,a){return new QN(i,r,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>nE(this.syncEngine,t,0),function(){return Z1.p()?new Z1:new WN}())}createSyncEngine(e,t){return function(r,s,o,a,l,c,h){const d=new _6(r,s,o,a,l,c);return h&&(d.$a=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const s=le(r);q("RemoteStore","RemoteStore shutting down."),s.k_.add(5),await Cu(s),s.Q_.shutdown(),s.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Dp.provider={build:()=>new Dp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):qi("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=bt.UNAUTHENTICATED,this.clientId=v2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async o=>{q("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(q("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new br;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=L_(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function tg(n,e){n.asyncQueue.verifyOperationInProgress(),q("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await J2(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function rE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await M6(n);q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>Q1(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>Q1(e.remoteStore,r)),n._onlineComponents=e}async function M6(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){q("FirestoreClient","Using user provided OfflineComponentProvider");try{await tg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===z.FAILED_PRECONDITION||r.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Qo("Error using user provided cache. Falling back to memory cache: "+t),await tg(n,new jh)}}else q("FirestoreClient","Using default OfflineComponentProvider"),await tg(n,new k6(void 0));return n._offlineComponents}async function wC(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(q("FirestoreClient","Using user provided OnlineComponentProvider"),await rE(n,n._uninitializedComponentsProvider._online)):(q("FirestoreClient","Using default OnlineComponentProvider"),await rE(n,new Dp))),n._onlineComponents}function O6(n){return wC(n).then(e=>e.syncEngine)}async function kp(n){const e=await wC(n),t=e.eventManager;return t.onListen=y6.bind(null,e.syncEngine),t.onUnlisten=w6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=v6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=T6.bind(null,e.syncEngine),t}function N6(n,e,t={}){const i=new br;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const h=new EC({next:f=>{h.eu(),o.enqueueAndForget(()=>cC(s,d)),f.fromCache&&l.source==="server"?c.reject(new Q(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new hC(a,h,{includeMetadataChanges:!0,ua:!0});return uC(s,d)}(await kp(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(n,e,t){if(!t)throw new Q(z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function F6(n,e,t,i){if(e===!0&&i===!0)throw new Q(z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function oE(n){if(!ne.isDocumentKey(n))throw new Q(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function aE(n){if(ne.isDocumentKey(n))throw new Q(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ud(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":oe()}function Vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Q(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ud(n);throw new Q(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new Q(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}F6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TC((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bd{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lE(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new HM;switch(i.type){case"firstParty":return new QM(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Q(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=sE.get(t);i&&(q("ComponentProvider","Removing Datastore"),sE.delete(t),i.terminate())}(this),Promise.resolve()}}function b6(n,e,t,i={}){var r;const s=(n=Vr(n,Bd))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=bt.MOCK_USER;else{a=PL(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Q(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new bt(c)}n._authCredentials=new qM(new y2(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Jr(this.firestore,e,this._query)}}class pn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pn(this.firestore,e,this._key)}}class zr extends Jr{constructor(e,t,i){super(e,t,y_(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pn(this.firestore,null,new ne(e))}withConverter(e){return new zr(this.firestore,e,this._path)}}function N_(n,e,...t){if(n=ks(n),IC("collection","path",e),n instanceof Bd){const i=ze.fromString(e,...t);return aE(i),new zr(n,null,i)}{if(!(n instanceof pn||n instanceof zr))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ze.fromString(e,...t));return aE(i),new zr(n.firestore,null,i)}}function CC(n,e,...t){if(n=ks(n),arguments.length===1&&(e=v2.newId()),IC("doc","path",e),n instanceof Bd){const i=ze.fromString(e,...t);return oE(i),new pn(n,null,new ne(i))}{if(!(n instanceof pn||n instanceof zr))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ze.fromString(e,...t));return oE(i),new pn(n.firestore,n instanceof zr?n.converter:null,new ne(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new tC(this,"async_queue_retry"),this.fu=()=>{const i=eg();i&&q("AsyncQueue","Visibility state changed to "+i.visibilityState),this.r_.Jo()},this.gu=e;const t=eg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const t=eg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const t=new br;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!ma(e))throw e;q("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const t=this.gu.then(()=>(this.Ru=!0,e().catch(i=>{this.Au=i,this.Ru=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw qi("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Ru=!1,i))));return this.gu=t,t}enqueueAfterDelay(e,t,i){this.pu(),this.mu.indexOf(e)>-1&&(t=0);const r=k_.createAndSchedule(this,e,t,i,s=>this.Su(s));return this.du.push(r),r}pu(){this.Au&&oe()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const t of this.du)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.du)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const t=this.du.indexOf(e);this.du.splice(t,1)}}function cE(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}class ra extends Bd{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new uE,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uE(e),this._firestoreClient=void 0,await e}}}function V6(n,e){const t=typeof n=="object"?n:VM(),i=typeof n=="string"?n:"(default)",r=OM(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=SL("firestore");s&&b6(r,...s)}return r}function F_(n){if(n._terminated)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||z6(n),n._firestoreClient}function z6(n){var e,t,i;const r=n._freezeSettings(),s=function(a,l,c,h){return new fO(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,TC(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new L6(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sa(Pt.fromBase64String(e))}catch(t){throw new Q(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new sa(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Q(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Q(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Q(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return me(this._lat,e._lat)||me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=/^__.*__$/;class B6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new zs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Tu(e,this.data,t,this.fieldTransforms)}}function RC(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe()}}class B_{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Fu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new B_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.xu({path:i,Nu:!1});return r.Lu(e),r}Bu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.xu({path:i,Nu:!1});return r.Fu(),r}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Gh(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(RC(this.Mu)&&U6.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class j6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||bd(e)}$u(e,t,i,r=!1){return new B_({Mu:e,methodName:t,Ku:i,path:Ct.emptyPath(),Nu:!1,Qu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xC(n){const e=n._freezeSettings(),t=bd(n._databaseId);return new j6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function G6(n,e,t,i,r,s={}){const o=n.$u(s.merge||s.mergeFields?2:0,e,t,r);PC("Data must be an object, but it was:",o,i);const a=SC(i,o);let l,c;if(s.merge)l=new $n(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const f=$6(e,d,t);if(!o.contains(f))throw new Q(z.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);X6(h,f)||h.push(f)}l=new $n(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new B6(new Rn(a),l,c)}class j_ extends V_{_toFieldTransform(e){return new VO(e.path,new nu)}isEqual(e){return e instanceof j_}}function W6(n,e,t,i=!1){return G_(t,n.$u(i?4:3,e))}function G_(n,e){if(AC(n=ks(n)))return PC("Unsupported field value:",e,n),SC(n,e);if(n instanceof V_)return function(i,r){if(!RC(r.Mu))throw r.qu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.qu(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let l=G_(a,r.ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=ks(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return NO(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=ct.fromDate(i);return{timestampValue:zh(r.serializer,s)}}if(i instanceof ct){const s=new ct(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:zh(r.serializer,s)}}if(i instanceof z_)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof sa)return{bytesValue:$2(r.serializer,i._byteString)};if(i instanceof pn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:I_(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof U_)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.qu("VectorValues must only contain numeric values.");return v_(a.serializer,l)})}}}}}}(i,r);throw r.qu(`Unsupported field value: ${Ud(i)}`)}(n,e)}function SC(n,e){const t={};return E2(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bs(n,(i,r)=>{const s=G_(r,e.Ou(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function AC(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ct||n instanceof z_||n instanceof sa||n instanceof pn||n instanceof V_||n instanceof U_)}function PC(n,e,t){if(!AC(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const i=Ud(t);throw i==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+i)}}function $6(n,e,t){if((e=ks(e))instanceof b_)return e._internalPath;if(typeof e=="string")return DC(n,e);throw Gh("Field path arguments must be of type string or ",n,!1,void 0,t)}const K6=new RegExp("[~\\*/\\[\\]]");function DC(n,e,t){if(e.search(K6)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new b_(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gh(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new Q(z.INVALID_ARGUMENT,a+n+l)}function X6(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new pn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new H6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(W_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class H6 extends kC{data(){return super.data()}}function W_(n,e){return typeof e=="string"?DC(n,e):e instanceof b_?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Q(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $_{}class MC extends $_{}function q6(n,e,...t){let i=[];e instanceof $_&&i.push(e),i=i.concat(t),function(s){const o=s.filter(l=>l instanceof X_).length,a=s.filter(l=>l instanceof K_).length;if(o>1||o>0&&a>0)throw new Q(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class K_ extends MC{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new K_(e,t,i)}_apply(e){const t=this._parse(e);return OC(e._query,t),new Jr(e.firestore,e.converter,wp(e._query,t))}_parse(e){const t=xC(e.firestore);return function(s,o,a,l,c,h,d){let f;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){dE(d,h);const p=[];for(const _ of d)p.push(hE(l,s,_));f={arrayValue:{values:p}}}else f=hE(l,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||dE(d,h),f=W6(a,o,d,h==="in"||h==="not-in");return rt.create(c,h,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class X_ extends $_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new X_(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Zn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)OC(o,l),o=wp(o,l)}(e._query,t),new Jr(e.firestore,e.converter,wp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class H_ extends MC{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new H_(e,t)}_apply(e){const t=function(r,s,o){if(r.startAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tu(s,o)}(e._query,this._field,this._direction);return new Jr(e.firestore,e.converter,function(r,s){const o=r.explicitOrderBy.concat([s]);return new _a(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Y6(n,e="asc"){const t=e,i=W_("orderBy",n);return H_._create(i,t)}function hE(n,e,t){if(typeof(t=ks(t))=="string"){if(t==="")throw new Q(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!P2(e)&&t.indexOf("/")!==-1)throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ze.fromString(t));if(!ne.isDocumentKey(i))throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return k1(n,new ne(i))}if(t instanceof pn)return k1(n,t._key);throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ud(t)}.`)}function dE(n,e){if(!Array.isArray(n)||n.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OC(n,e){const t=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Z6{convertValue(e,t="none"){switch(Xr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Kr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw oe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return bs(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;const s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>Qe(o.doubleValue));return new U_(s)}convertGeoPoint(e){return new z_(Qe(e.latitude),Qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=kd(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Ql(e));default:return null}}convertTimestamp(e){const t=$r(e);return new ct(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ze.fromString(e);Se(Z2(i));const r=new Jl(i.get(1),i.get(3)),s=new ne(i.popFirst(5));return r.isEqual(t)||qi(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q6(n,e,t){let i;return i=n?n.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class NC extends kC{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $c(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(W_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class $c extends NC{data(e={}){return super.data(e)}}class FC{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new tl(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new $c(this._firestore,this._userDataWriter,i.key,i,new tl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Q(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const l=new $c(r._firestore,r._userDataWriter,a.doc.key,a.doc,new tl(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new $c(r._firestore,r._userDataWriter,a.doc.key,a.doc,new tl(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:J6(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function J6(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe()}}class q_ extends Z6{constructor(e){super(),this.firestore=e}convertBytes(e){return new sa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new pn(this.firestore,null,t)}}function e5(n){n=Vr(n,Jr);const e=Vr(n.firestore,ra),t=F_(e),i=new q_(e);return LC(n._query),N6(t,n._query).then(r=>new FC(e,i,n,r))}function t5(n){return bC(Vr(n.firestore,ra),[new E_(n._key,pi.none())])}function n5(n,e){const t=Vr(n.firestore,ra),i=CC(n),r=Q6(n.converter,e);return bC(t,[G6(xC(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,pi.exists(!1))]).then(()=>i)}function i5(n,...e){var t,i,r;n=ks(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||cE(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(cE(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),e[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let l,c,h;if(n instanceof pn)c=Vr(n.firestore,ra),h=y_(n._key.path),l={next:d=>{e[o]&&e[o](r5(c,n,d))},error:e[o+1],complete:e[o+2]};else{const d=Vr(n,Jr);c=Vr(d.firestore,ra),h=d._query;const f=new q_(c);l={next:p=>{e[o]&&e[o](new FC(c,f,d,p))},error:e[o+1],complete:e[o+2]},LC(n._query)}return function(f,p,_,w){const T=new EC(w),v=new hC(p,T,_);return f.asyncQueue.enqueueAndForget(async()=>uC(await kp(f),v)),()=>{T.eu(),f.asyncQueue.enqueueAndForget(async()=>cC(await kp(f),v))}}(F_(c),h,a,l)}function bC(n,e){return function(i,r){const s=new br;return i.asyncQueue.enqueueAndForget(async()=>I6(await O6(i),r,s)),s.promise}(F_(n),e)}function r5(n,e,t){const i=t.docs.get(e._key),r=new q_(n);return new NC(n,r,e._key,i,new tl(t.hasPendingWrites,t.fromCache),e.converter)}function s5(){return new j_("serverTimestamp")}(function(e,t=!0){(function(r){ga=r})(bM),Nh(new ql("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new ra(new YM(i.getProvider("auth-internal")),new eO(i.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Q(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jl(c.options.projectId,h)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Fo(R1,"4.7.5",e),Fo(R1,"4.7.5","esm2017")})();var o5="firebase",a5="11.0.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fo(o5,a5,"app");const l5={apiKey:"AIzaSyB5D6Kp_hPV4IgM-ZpNn3geWYrP5P5BQn4",authDomain:"cadeocircular.firebaseapp.com",projectId:"cadeocircular",storageBucket:"cadeocircular.appspot.com",messagingSenderId:"510663335803",appId:"1:510663335803:web:09808c0ca4dae41f5be7de",measurementId:"G-RT1B1VZQPM"},u5=u2(l5),Wh=V6(u5),c5=async(n,e)=>{try{await n5(N_(Wh,"chat"),{user:n,message:e,timestamp:s5()}),console.log("Mensagem enviada com sucesso!")}catch(t){console.error("Erro ao enviar mensagem:",t)}},h5=n=>{const e=q6(N_(Wh,"chat"),Y6("timestamp","asc"));return i5(e,t=>{const i=[];t.forEach(r=>{i.push({id:r.id,...r.data()})}),n(i)})},d5=async()=>{try{const n=N_(Wh,"chat"),t=(await e5(n)).docs.map(i=>t5(CC(Wh,"chat",i.id)));await Promise.all(t),console.log("Todas as mensagens foram apagadas com sucesso!")}catch(n){console.error("Erro ao apagar mensagens:",n)}},f5=({user:n})=>{const[e,t]=Y.useState(""),i=async r=>{if(r.preventDefault(),!!e.trim())try{await c5(n,e),t("")}catch(s){console.error("Erro ao enviar a mensagem:",s)}};return b.jsxs("form",{onSubmit:i,className:"ChatIpt",children:[b.jsx("input",{type:"text",value:e,onChange:r=>t(r.target.value),placeholder:"Digite sua mensagem..."}),b.jsx("button",{type:"submit",children:"Enviar"})]})},g5=()=>{const[n,e]=Y.useState([]);return Y.useEffect(()=>{const t=h5(i=>{const r=i.map(s=>({id:s.id,message:s.message}));e(r)});return()=>t()},[]),b.jsx("div",{className:"chatLi",children:n.map(t=>b.jsx("div",{className:"message",children:t.message},t.id))})},p5=()=>(Y.useEffect(()=>{const n=setInterval(async()=>{try{await d5(),console.log("Mensagens apagadas automaticamente.")}catch(e){console.error("Erro ao apagar mensagens automaticamente:",e)}},6e4);return()=>clearInterval(n)},[]),null);function m5(){return b.jsxs("div",{className:"Chat",children:[b.jsx(hu,{titulo:"Chat",children:null}),b.jsx("main",{children:b.jsxs("div",{className:"Container",children:[b.jsx(g5,{}),b.jsx(f5,{user:""})]})}),b.jsx(p5,{})]})}function _5(){return b.jsxs("div",{className:"app",children:[b.jsxs(SA,{children:[b.jsx(to,{path:"/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/previsoes",element:b.jsx(VA,{})}),b.jsx(to,{path:"/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/rotas",element:b.jsx(pL,{})}),b.jsx(to,{path:"/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/termosdeuso",element:b.jsx(mL,{})}),b.jsx(to,{path:"/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/chat",element:b.jsx(m5,{})}),b.jsx(to,{path:"/ufjf-dcc207-2024-3-a-trb1-Miguel-Dias-112/",element:b.jsx(_L,{})})]}),b.jsx(LA,{})]})}RT(document.getElementById("root")).render(b.jsx(Y.StrictMode,{children:b.jsx(DA,{children:b.jsx(_5,{})})}));
